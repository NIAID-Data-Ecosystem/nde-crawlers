[{"_id": "SB_Public_Apps_admin/sbg-public-data/alignment-metrics-qc/6", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/admin/sbg-public-data/alignment-metrics-qc/6", "applicationCategory": "Workflow", "version": "sbg:draft-2", "name": "Alignment Metrics QC", "description": "Running this pipeline will provide you with useful statistics to help you judge the quality of your alignment. Provide aligned reads in the BAM format and the reference FASTA to which they were aligned as inputs. This pipeline will generate an easily-digestible table report with quality control information, including the proportion of your reads that could not be aligned and the percentage of reads that passed quality checks.\n\nThis pipeline works with output from genomic or transcriptomic aligners. Run this pipeline as part of your routine bioinformatic quality control or when optimizing alignment for your data by experimenting with aligner settings.", "input": [{"name": "Reference Genome FASTA", "encodingFormat": "application/x-fasta"}, {"name": "BAM_files"}], "original_input": [{"type": ["null", "File"], "label": "Reference Genome FASTA", "sbg:fileTypes": "FASTA", "id": "#Reference_Genome_FASTA", "sbg:x": 256.0000072717668, "sbg:y": 222.00000569224363}, {"type": ["null", {"type": "array", "items": "File"}], "label": "BAM_files", "id": "#input_list", "sbg:x": 67.99997393786867, "sbg:y": 453.988288149063}], "output": [{"name": "Summary Metrics", "encodingFormat": "text/plain"}], "applicationSuite": "SBGToolsversion:1", "codeRepository": ["https://github.com/broadinstitute/picard"], "applicationSubCategory": ["SAM/BAM Processing", "Quality Control"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1453799487, "sbg:revisionNotes": null}, {"sbg:revision": 1, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1471539427, "sbg:revisionNotes": null}, {"sbg:revision": 2, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1485522984, "sbg:revisionNotes": "App update."}, {"sbg:revision": 3, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1496419754, "sbg:revisionNotes": null}, {"sbg:revision": 4, "sbg:modifiedBy": "bix-demo", "sbg:modifiedOn": 1545871864, "sbg:revisionNotes": "Update docker image on SBG Flatten Lists"}, {"sbg:revision": 5, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1545926790, "sbg:revisionNotes": "Update docker image on SBG FlattenLists"}, {"sbg:revision": 6, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1649151252, "sbg:revisionNotes": "update categories"}], "creator": "Seven Bridges", "dateModified": 1649151252, "dateCreated": 1453799487, "contributor": ["bix-demo", "sevenbridges", "admin"], "sdPublisher": "sbg", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_jiewho/bd-public-project/bd-rhapsody-analysis-pipeline/15", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/jiewho/bd-public-project/bd-rhapsody-analysis-pipeline/15", "applicationCategory": "Workflow", "version": "v1.0", "name": "BD Rhapsody\u2122 Targeted Analysis Pipeline", "description": "The BD Rhapsody\u2122 assays are used to create sequencing libraries from single cell transcriptomes.\n\nAfter sequencing, the analysis pipeline takes the FASTQ files and a reference file for gene alignment. The pipeline generates molecular counts per cell, read counts per cell, metrics, and an alignment file.", "input": [{"name": "Exact Cell Count"}, {"name": "Disable Refined Putative Cell Calling"}, {"name": "Reads", "encodingFormat": "text/fastq"}, {"name": "VDJ Species Version"}, {"name": "Putative Cell Calling"}, {"name": "AbSeq Reference"}, {"name": "Reference"}, {"name": "Run Name"}, {"name": "Subsample Reads"}, {"name": "Subsample Seed"}, {"name": "Tag Names"}, {"name": "Sample Tags Version"}], "original_input": [{"id": "Exact_Cell_Count", "type": "int?", "label": "Exact Cell Count", "description": "Set a specific number (>=1) of cells as putative, based on those with the highest error-corrected read count"}, {"id": "Basic_Algo_Only", "type": "boolean?", "label": "Disable Refined Putative Cell Calling", "description": "Determine putative cells using only the basic algorithm (minimum second derivative along the cumulative reads curve).  The refined algorithm attempts to remove false positives and recover false negatives, but may not be ideal for certain complex mixtures of cell types.  Does not apply if Exact Cell Count is set."}, {"id": "Reads", "sbg:fileTypes": "FASTQ.GZ, FQ.GZ", "type": "File[]", "label": "Reads"}, {"id": "VDJ_Version", "type": ["null", {"type": "enum", "symbols": ["Human VDJ - BCR and TCR", "Human VDJ - BCR only", "Human VDJ - TCR only", "Mouse VDJ - BCR and TCR", "Mouse VDJ - BCR only", "Mouse VDJ - TCR only"], "name": "VDJ_Version"}], "label": "VDJ Species Version", "description": "The VDJ species and chain types.  This option should only be set for VDJ experiment."}, {"id": "Putative_Cell_Call", "type": ["null", {"type": "enum", "symbols": ["mRNA", "AbSeq (Experimental)"], "name": "Putative_Cell_Call"}], "label": "Putative Cell Calling", "description": "Specify the data to be used for putative cell calling. mRNA is the default selected option. AbSeq (Experimental) is for troubleshooting only."}, {"id": "AbSeq_Reference", "type": "File[]?", "label": "AbSeq Reference"}, {"id": "Reference", "type": "File[]?", "label": "Reference", "description": "A fasta file containing the mRNA panel amplicon targets used in the experiment"}, {"id": "Run_Name", "type": "string?", "label": "Run Name", "description": "This is a name for output files, for example Experiment1_Metrics_Summary.csv. Default if left empty is to name run based on a library. Any non-alpha numeric characters will be changed to a hyphen."}, {"id": "Subsample", "type": "float?", "label": "Subsample Reads", "description": "Any number of reads >1 or a fraction between 0 < n < 1 to indicate the percentage of reads to subsample.\n"}, {"id": "Subsample_seed", "type": "int?", "label": "Subsample Seed", "description": "For use when replicating a previous subsampling run only. Obtain the seed generated from the log file for the SplitFastQ node.\n"}, {"id": "Tag_Names", "type": "string[]?", "label": "Tag Names", "description": "Specify the Sample Tag number followed by - (hyphen) and a sample name to appear in the output files. For example: 4-Ramos. Should be alpha numeric, with + - and _ allowed. Any special characters: &, (), [], {}, <>, ?, | will be corrected to underscores. \n"}, {"id": "Sample_Tags_Version", "type": ["null", {"type": "enum", "symbols": ["No Multiplexing", "Single-Cell Multiplex Kit - Human", "Single-Cell Multiplex Kit - Mouse"], "name": "Sample_Tags_Version"}], "label": "Sample Tags Version", "description": "The sample multiplexing kit version.  This option should only be set for a multiplexed experiment."}], "output": [{"name": "VDJ"}, {"name": "Bioproduct Statistics"}, {"name": "Cell Label Filter"}, {"name": "Expression Matrix"}, {"name": "Final BAM File"}, {"name": "Final BAM Index"}, {"name": "Metrics Summary"}, {"name": "Data Tables"}, {"name": "Unfiltered Data Tables"}, {"name": "Unfiltered Expression Matrix"}, {"name": "Pipeline Logs"}, {"name": "Putative Cells Origin"}, {"name": "Protein Aggregates (Experimental)"}, {}, {"name": "Immune Cell Classification (Experimental)"}], "schema:softwareRequirements": ["SubworkflowFeatureRequirement", "ScatterFeatureRequirement", "MultipleInputFeatureRequirement", "InlineJavascriptRequirement", "StepInputExpressionRequirement"], "thumbnailUrl": "https://igor.sbgenomics.com/ns/brood/images/jiewho/bd-public-project/bd-rhapsody-analysis-pipeline/15.png", "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "schen", "sbg:modifiedOn": 1507667967, "sbg:revisionNotes": ""}, {"sbg:revision": 1, "sbg:modifiedBy": "schen", "sbg:modifiedOn": 1507668027, "sbg:revisionNotes": "v1.0"}, {"sbg:revision": 2, "sbg:modifiedBy": "jdreux", "sbg:modifiedOn": 1512153196, "sbg:revisionNotes": "v1.02"}, {"sbg:revision": 3, "sbg:modifiedBy": "jeremyadamsfisher", "sbg:modifiedOn": 1533579253, "sbg:revisionNotes": "v1.3rc"}, {"sbg:revision": 4, "sbg:modifiedBy": "jeremyadamsfisher", "sbg:modifiedOn": 1533589079, "sbg:revisionNotes": "v1.3"}, {"sbg:revision": 5, "sbg:modifiedBy": "jeremyadamsfisher", "sbg:modifiedOn": 1534262986, "sbg:revisionNotes": "v1.3rc3"}, {"sbg:revision": 6, "sbg:modifiedBy": "jeremyadamsfisher", "sbg:modifiedOn": 1552594957, "sbg:revisionNotes": "v1.5a"}, {"sbg:revision": 7, "sbg:modifiedBy": "jeremyadamsfisher", "sbg:modifiedOn": 1560203355, "sbg:revisionNotes": "v1.6"}, {"sbg:revision": 8, "sbg:modifiedBy": "jeremyadamsfisher", "sbg:modifiedOn": 1562100802, "sbg:revisionNotes": "v1.6.1"}, {"sbg:revision": 9, "sbg:modifiedBy": "jeremyadamsfisher", "sbg:modifiedOn": 1565291189, "sbg:revisionNotes": "v1.7.1"}, {"sbg:revision": 10, "sbg:modifiedBy": "aberno", "sbg:modifiedOn": 1570733530, "sbg:revisionNotes": "v1.8"}, {"sbg:revision": 11, "sbg:modifiedBy": "aberno", "sbg:modifiedOn": 1596222807, "sbg:revisionNotes": "1.9"}, {"sbg:revision": 12, "sbg:modifiedBy": "aberno", "sbg:modifiedOn": 1602103324, "sbg:revisionNotes": "1.9.1"}, {"sbg:revision": 13, "sbg:modifiedBy": "aberno", "sbg:modifiedOn": 1602194814, "sbg:revisionNotes": "1.9.1 corrected"}, {"sbg:revision": 14, "sbg:modifiedBy": "aberno", "sbg:modifiedOn": 1643138675, "sbg:revisionNotes": "1.10"}, {"sbg:revision": 15, "sbg:modifiedBy": "aberno", "sbg:modifiedOn": 1649980706, "sbg:revisionNotes": "v1.10.1"}], "dateModified": 1649980706, "dateCreated": 1507667967, "contributor": ["jdreux", "schen", "aberno", "jeremyadamsfisher"], "sdPublisher": "BD", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_jiewho/bd-public-project/bd-rhapsody-wta-analysis-pipeline/7", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/jiewho/bd-public-project/bd-rhapsody-wta-analysis-pipeline/7", "applicationCategory": "Workflow", "version": "v1.0", "name": "BD Rhapsody\u2122 WTA Analysis Pipeline", "description": "The BD Rhapsody\u2122 WTA Analysis Pipeline is used to create sequencing libraries from single cell transcriptomes without having to specify a targeted panel.\n\nAfter sequencing, the analysis pipeline takes the FASTQ files, a reference genome file and a transcriptome annotation file for gene alignment. The pipeline generates molecular counts per cell, read counts per cell, metrics, and an alignment file.", "input": [{"name": "Exact Cell Count"}, {"name": "Disable Refined Putative Cell Calling"}, {"name": "Reads", "encodingFormat": "text/fastq"}, {"name": "VDJ Species Version"}, {"name": "Putative Cell Calling"}, {"name": "AbSeq Reference"}, {"name": "Transcriptome Annotation", "encodingFormat": "application/x-gtf"}, {"name": "Reference Genome", "encodingFormat": "application/x-tar"}, {"name": "Supplemental Reference"}, {"name": "Run Name"}, {"name": "Subsample Reads"}, {"name": "Subsample Seed"}, {"name": "Tag Names"}, {"name": "Sample Tags Version"}], "original_input": [{"id": "Exact_Cell_Count", "type": "int?", "label": "Exact Cell Count", "description": "Set a specific number (>=1) of cells as putative, based on those with the highest error-corrected read count"}, {"id": "Basic_Algo_Only", "type": "boolean?", "label": "Disable Refined Putative Cell Calling", "description": "Determine putative cells using only the basic algorithm (minimum second derivative along the cumulative reads curve).  The refined algorithm attempts to remove false positives and recover false negatives, but may not be ideal for certain complex mixtures of cell types.  Does not apply if Exact Cell Count is set."}, {"id": "Reads", "sbg:fileTypes": "FASTQ.GZ, FQ.GZ", "type": "File[]", "label": "Reads"}, {"id": "VDJ_Version", "type": ["null", {"type": "enum", "symbols": ["Human VDJ - BCR and TCR", "Human VDJ - BCR only", "Human VDJ - TCR only", "Mouse VDJ - BCR and TCR", "Mouse VDJ - BCR only", "Mouse VDJ - TCR only"], "name": "VDJ_Version"}], "label": "VDJ Species Version", "description": "The VDJ species and chain types.  This option should only be set for VDJ experiment."}, {"id": "Putative_Cell_Call", "type": ["null", {"type": "enum", "symbols": ["mRNA", "AbSeq (Experimental)"], "name": "Putative_Cell_Call"}], "label": "Putative Cell Calling", "description": "Specify the data to be used for putative cell calling. mRNA is the default selected option. AbSeq (Experimental) is for troubleshooting only."}, {"id": "AbSeq_Reference", "type": "File[]?", "label": "AbSeq Reference"}, {"id": "Transcriptome_Annotation", "sbg:fileTypes": "GTF", "type": "File", "label": "Transcriptome Annotation"}, {"id": "Reference_Genome", "sbg:fileTypes": "TAR.GZ", "type": "File", "label": "Reference Genome"}, {"id": "Supplemental_Reference", "type": "File[]?", "label": "Supplemental Reference", "description": "A fasta file containing additional transgene sequences used in the experiment"}, {"id": "Run_Name", "type": "string?", "label": "Run Name", "description": "This is a name for output files, for example Experiment1_Metrics_Summary.csv. Default if left empty is to name run based on a library. Any non-alpha numeric characters will be changed to a hyphen."}, {"id": "Subsample", "type": "float?", "label": "Subsample Reads", "description": "Any number of reads >1 or a fraction between 0 < n < 1 to indicate the percentage of reads to subsample.\n"}, {"id": "Subsample_seed", "type": "int?", "label": "Subsample Seed", "description": "For use when replicating a previous subsampling run only. Obtain the seed generated from the log file for the SplitFastQ node.\n"}, {"id": "Tag_Names", "type": "string[]?", "label": "Tag Names", "description": "Specify the Sample Tag number followed by - (hyphen) and a sample name to appear in the output files. For example: 4-Ramos. Should be alpha numeric, with + - and _ allowed. Any special characters: &, (), [], {}, <>, ?, | will be corrected to underscores. \n"}, {"id": "Sample_Tags_Version", "type": ["null", {"type": "enum", "symbols": ["No Multiplexing", "Single-Cell Multiplex Kit - Human", "Single-Cell Multiplex Kit - Mouse"], "name": "Sample_Tags_Version"}], "label": "Sample Tags Version", "description": "The sample multiplexing kit version.  This option should only be set for a multiplexed experiment."}], "output": [{"name": "VDJ"}, {"name": "Bioproduct Statistics"}, {"name": "Cell Label Filter"}, {"name": "Expression Matrix"}, {"name": "Final BAM File"}, {"name": "Final BAM Index"}, {"name": "Metrics Summary"}, {"name": "Data Tables"}, {"name": "Unfiltered Data Tables"}, {"name": "Unfiltered Expression Matrix"}, {"name": "Pipeline Logs"}, {"name": "Putative Cells Origin"}, {"name": "Protein Aggregates (Experimental)"}, {}, {"name": "Immune Cell Classification (Experimental)"}], "schema:softwareRequirements": ["SubworkflowFeatureRequirement", "ScatterFeatureRequirement", "MultipleInputFeatureRequirement", "InlineJavascriptRequirement", "StepInputExpressionRequirement"], "thumbnailUrl": "https://igor.sbgenomics.com/ns/brood/images/jiewho/bd-public-project/bd-rhapsody-wta-analysis-pipeline/7.png", "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "aberno", "sbg:modifiedOn": 1565291572, "sbg:revisionNotes": null}, {"sbg:revision": 1, "sbg:modifiedBy": "aberno", "sbg:modifiedOn": 1565291707, "sbg:revisionNotes": "v1.7.1"}, {"sbg:revision": 2, "sbg:modifiedBy": "aberno", "sbg:modifiedOn": 1570731745, "sbg:revisionNotes": "v1.8"}, {"sbg:revision": 3, "sbg:modifiedBy": "aberno", "sbg:modifiedOn": 1596222919, "sbg:revisionNotes": "1.9"}, {"sbg:revision": 4, "sbg:modifiedBy": "aberno", "sbg:modifiedOn": 1602103180, "sbg:revisionNotes": "1.9.1"}, {"sbg:revision": 5, "sbg:modifiedBy": "aberno", "sbg:modifiedOn": 1643139406, "sbg:revisionNotes": "1.10"}, {"sbg:revision": 6, "sbg:modifiedBy": "aberno", "sbg:modifiedOn": 1643142900, "sbg:revisionNotes": "1.10 WTA"}, {"sbg:revision": 7, "sbg:modifiedBy": "aberno", "sbg:modifiedOn": 1649980559, "sbg:revisionNotes": "v1.10.1"}], "dateModified": 1649980559, "dateCreated": 1565291572, "contributor": ["aberno"], "sdPublisher": "BD", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_admin/sbg-public-data/bismark-analysis-0-19-0/28", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/admin/sbg-public-data/bismark-analysis-0-19-0/28", "applicationCategory": "Workflow", "version": "sbg:draft-2", "name": "Bismark Analysis", "description": "**Bismark Analysis 0.19.0** is a workflow for analyzing DNA methylation, a type of epigenetic modification, by processing reads which can be obtained by using two technologies for library preparation and sequencing, Whole Genome Bisulfite Sequencing (WGBS) and Reduced Representation Bisulfite Sequencing (RRBS). It can be used for an input file of any size, but it is optimized for larger files (more than 15 GB).\n\nThe pipeline contains four main parts: a quality control and adapter trimming performed by **Trim Galore!**, alignment of BS-Seq reads performed by the **Bismark**, deduplication performed by **Bismark Deduplicate**, and extraction of methylated cytosines performed by **Bismark Methylation Extractor**.\n\nThe workflow takes the following input files:\n\n* **FASTQ files** - compressed or decompressed BS-seq\u00a0reads\u00a0(FASTQ/FASTQ.GZ) with **Paired-end** and **Sample ID** metadata field set\n* **Reference FASTA** - a reference genome FASTA file\n* **Bisulfite genome reference** - gzipped in-silico bisulfite-treated and indexed reference genome (TAR.GZ), which can be created with **Bismark Genome Preparation** tool (the appropriate alignment algorithm Bowie1/Bowtie2 have to be selected). Suggested file for that input is **ucsc\\_Bisulfite\\_Genome\\_bowtie2.tar.gz**, which is created by **Bismark Genome Preparation** tool with provided reference genome file ucsc.hg19.fasta and selected Bowtie2 option\n\nOutput files are generated within the four abovementioned segments of the workflow:\n\n* In the quality control and adapter trimming segment, graphical interfaces with all necessary information about reads, their quality, and adapter contamination are generated before and after the tool Trim Galore! (**Pre trimming FASTQC Analysis** and **Post trimming FASTQC Analysis**). \n* An alignment BAM file (**Bismark alignment file**) is produced by the **Bismark** in the alignment part of the workflow. This file is sorted by coordinate and has its own index BAI file. For further processing, the direct output of the Bismark is sorted by the name to be acceptable for the tool **Bismark Deduplicate**.\n* A **Sorted deduplicated BAM** is created in the deduplication process and is sorted by coordinate and has its own index BAI file. In **RRBS** mode (no deduplication), this file should be the same as **Bismark alignment file**.\n* In the methylation call segment, **Bismark Methylation Extractor** operates on BAM file and generates **Coverage file** which is applicable to further analysis (differential methylation). \n* Graphical HTML reports generated by the tool **Bismark2Report** contains all information obtained from reports generated by Bismark, Bismark Deduplicate, and Bismark Methylation Extractor.\n\n*A list of all inputs and parameters with corresponding descriptions can be found at the bottom of the page.*\n\n### Common Use Cases\n\nThe workflow is designed to analyze one WGBS or RRBS sample (FASTQ, FASTQ.GZ) with properly set metadata fields.\n\n* The user should provide FASTQ files to input **FASTQ files** and set metadata fields  **Sample ID** for single-end read and **Sample ID** and **Paired-end** for paired-end reads. \n* All workflow settings are optimized for the use of larger input files with sequences (more than 15 GB). For other use cases, please contact Seven Bridges for support.\n* If paired-end reads are provided, the option **Paired** in the tool Trim Galore! should be set. The option **Single end** in Bismark and Bismark Deduplicate should be set No value or False.\n* The option **Bowtie aligner** in Bismark must be selected according to the selected alignment algorithm in the tool Bismark Genome Preparation.\n* The reference genome files which are used for generating the gzipped bisulfite indexed genome reference file should be used in the workflow. \n* After running task of workflow has successfully completed, it creates **Coverage file** which contains methylated cytosines and can be used for further analysis of differential methylation, HTML reports of FASTQ reads before and after trimming, HTML report of complete process of methylation calling (alignment, deduplication and extraction methylation call) and BAM files after alignment and deduplication. BAM file and report generated by Bismark,  Deduplication report and Splitting report can be used for comparison alignment and methylation parameters between samples in the tool **Bismark2Summary**.\n\n### Changes Introduced by Seven Bridges\n\nThe realization of workflow is based on the idea of optimizing the workflow in a better way. \n\nThe technical configuration of workflow is:\n\n* AWS instance c4.8xlarge (36 CPU, 60GB)\n* maximum parallel instances set to 6. \n\nThree parts of the pipeline which contribute to faster task executions are as follows:\n\n* Trim Galore! scattered by split FASTQ files. SBG FASTQ Split splits FASTQ files into 30 parts. Reads can't be divided to the maximum number of CPUs (36), because some tools run in parallel with Trim Galore! and execution time won't be optimized. The number of parts should be divisible by the maximum number of instances which is 6.\n* Scattered Bismark by trimmed FASTQ files which are merged before into 6 parts. This tool runs on six parallel instances (c4.8xlarge).\n* Generated BAM file are split by chromosome name and provided to Bismark Deduplicate and Bismark Methylation Extractor which are scattered by chromosome bam files. \n* Outputs generated by workflow are finally merged.\n\n### Common Issues and Important Notes\n\n* Metadata fields for FASTQ files **Paired-end** and **Sample ID** should be properly set, fields Sample ID for single-end read and Sample ID and Paired-end for paired-end reads.\n* For RRBS library, option **RRBS** should be set in the tool Trim Galore!. Also, author of the Bismark recommends that deduplication process should not be applied to RRBS reads. Option in Bismark Deduplicate **RRBS** should be set to TRUE for bypassing deduplication for RRBS reads.\n* Option **Bowtie Aligner** in the tool Bismark should be specified depending on which Bowtie is used for indexing in Bismark Genome Preparation. The default value is Bowtie2.\n* Options **Memory in MB per job** and **Number of CPUs per job** in Bismark are related to the instance on which this tool is running. Those options should be set to the maximum of memory and number of CPU of specified instance. E.g. AWS instance c4.8xlarge has 36 CPU and 60 GB, **Memory in MB per job** is set to 61440 MB and **Number of CPUs per job** set to 36.\n* The **Multicore** option in Bismark tool represents the number of parallel jobs (multicores) which are run concurrently. It takes value 8 by default and should not be changed in the case of the reads from directional sequencing library and human genome reference (3GB). This value is set so the pipeline can be run on AWS instance c4.8xlarge (36CPUs, 60GB). If reference genome is a bigger size or more references are provided, this parameter should be set to less value (e.g. for the reference of 4.5GB multicore is set to 3 in order to fit on c4.8xlarge).\n* All the above settings are optimized for the case of larger input files with sequences (more than 15 GB). For other cases, please contact SBG support.\n* This workflow might not work with filenames containing some special characters e.g. **#**, **~**.\n\n\n### Performance Benchmarking\n\nAmong all tools in workflow, Bismark has the highest memory demands. Memory and CPU requirements for Bismark strongly correlate with **Sequencing library** (directional or non-directional), a number of multicores (parameter **Multicore**) and the size of the reference file. If reference genome file has the bigger size or there are more reference files provided, the multicore parameter should be set to a lower value. We tested for the human genome (3 GB), multicore was set to 6, it means that 10 GB per one multicore, for three genome reference files (4.5GB in total), multicore was 3, 20 GB per one multicore.\n\nBased on our experience we choose AWS instance c4.8xlarge (36 CPU, 60 GB) which was enough for high memory requirement.\nIn the following table, you can find estimates of Bismark Analysis 0.19.0 running time and cost.\n\n| FASTQ (size) | Genome Reference (size) | Multicore (Bismark) | Instance (AWS) | Duration | Cost |\n| --- | --- | --- | --- | --- | --- |\n| 2 x 700 MB (GZ)| 3 GB | 6 | c4.8xlarge | 1h 9m | $6.78 |\n| 2 x 12 GB (GZ) | 3 GB | 6 | c4.8xlarge | 5h 11m | $26.67 |\n| 2 x 220 GB | 4.5 GB | 3 | c4.8xlarge | 20h 44m | $114.29 |\n\n*Cost can be significantly reduced by using **spot instances**. Visit the [Knowledge Center](https://docs.sevenbridges.com/docs/about-spot-instances) for more details.*\n\n### References\n\n[1] Krueger F. and Andrews S.R. (2011) [Bismark: a flexible aligner and methylation caller for Bisulfite-Seq applications](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3102221/). Bioinformatics. 2011 Jun 1;27(11):1571-2. doi: 10.1093/bioinformatics/btr167. Epub 2011 Apr 14", "input": [{"name": "FASTQ files", "encodingFormat": "text/fastq"}, {"name": "RRBS"}, {"name": "Bisulfite genome reference", "encodingFormat": "application/x-tar"}, {"name": "Single end"}, {"name": "Reference FASTA", "encodingFormat": "application/x-fasta"}, {"name": "Yacht"}, {"name": "Ignore r2"}, {"name": "Ignore 3prime_r2"}, {"name": "Ignore 3prime"}, {"name": "Ignore"}, {"name": "CX Context"}, {"name": "CutOff"}, {"name": "Sequencing library"}, {"name": "Seed mismatches"}, {"name": "Nucleotide coverage"}, {"name": "Multicore"}, {"name": "Memory in MB per job"}, {"name": "Number of CPUs per job"}, {"name": "Bowtie Aligner"}, {"name": "Barcode"}, {"name": "Adapter"}, {"name": "Adapter 2"}, {"name": "5' clip read 1"}, {"name": "5' clip read 2"}, {"name": "3' clip read 1"}, {"name": "3' clip read 2"}, {"name": "Paired"}], "original_input": [{"type": [{"type": "array", "items": "File"}], "label": "FASTQ files", "sbg:fileTypes": "FQ, FASTQ, FQ.GZ, FASTQ.GZ", "id": "#fastq", "sbg:x": -108.33333958519847, "sbg:y": 425.0000065830017}, {"type": ["null", "boolean"], "label": "RRBS", "id": "#rrbs", "sbg:x": 49.99998663531342, "sbg:includeInPorts": true, "sbg:y": 53.33333433998939}, {"type": ["File"], "label": "Bisulfite genome reference", "sbg:fileTypes": "TAR, TAR.GZ", "id": "#bisulfite_genome", "sbg:x": 659.9999612172423, "sbg:y": 301.6666589710441, "sbg:suggestedValue": {"class": "File", "name": "ucsc_Bisulfite_Genome_bowtie2.tar.gz", "path": "5a69b8244f0c6b50c312b3ff"}}, {"type": ["null", "boolean"], "label": "Single end", "id": "#single_end", "sbg:x": 656.6666488912358, "sbg:includeInPorts": true, "sbg:y": 174.99998139010447}, {"type": [{"type": "array", "items": "File"}], "label": "Reference FASTA", "sbg:fileTypes": "FASTA, FA", "id": "#reference", "sbg:includeInPorts": true, "sbg:y": 728.3334639999646, "sbg:x": 523.3334558539964, "sbg:suggestedValue": [{"class": "File", "name": "ucsc.hg19.fasta", "path": "5772b6df507c1752674486ee"}]}, {"type": ["null", "boolean"], "label": "Yacht", "description": "This option (Yet Another Context Hunting Tool) writes out additional information about the read a methylation call belongs to, and its output is meant to be fed into the NOMe_filtering script. This option writes out a single 'any_C_context' file that contains all methylation calls for a read consecutively. Its intended use is single-cell NOMe-Seq data, and thus this option works only in single-end mode (paired-end reads often suffer from chimaera problems) and without generating only mbias report (mbias_only).", "id": "#yacht", "required": false, "sbg:altPrefix": "--yacht", "sbg:category": "Options", "sbg:toolDefaultValue": "Off"}, {"type": ["null", "int"], "label": "Ignore r2", "description": "Ignore the first <int> bp from the 5' end of Read 2 of paired-end sequencing results only.", "id": "#ignore_r2", "required": false, "sbg:altPrefix": "--ignore_r2", "sbg:category": "Options", "sbg:toolDefaultValue": "None"}, {"type": ["null", "int"], "label": "Ignore 3prime_r2", "description": "Ignore the last <int> bp from the 3' end of Read 2 of paired-end sequencing results only. This can remove unwanted biases from the end of reads.", "id": "#ignore_3prime_r2", "required": false, "sbg:altPrefix": "--ignore_3prime_r2", "sbg:category": "Options", "sbg:toolDefaultValue": "None"}, {"type": ["null", "int"], "label": "Ignore 3prime", "description": "Ignore the last <int> bp from the 3' end of Read 1 (or single-end alignment files) when processing the methylation call string. This can remove unwanted biases from the end of reads.", "id": "#ignore_3prime", "required": false, "sbg:category": "Options", "sbg:toolDefaultValue": "None"}, {"type": ["null", "int"], "label": "Ignore", "description": "Ignore the first <int> bp from the 5\u2019 end of Read 1 (or single-end alignment files) when processing the methylation call string.", "id": "#ignore", "required": false, "sbg:category": "Options", "sbg:toolDefaultValue": "None"}, {"type": ["null", "boolean"], "label": "CX Context", "description": "The output file contains information on every single cytosine in the genome irrespective of its context. This applies to both forward and reverse strands.", "id": "#cx_context", "required": false, "sbg:altPrefix": "--CX_context", "sbg:category": "BedGraph Specific Options", "sbg:toolDefaultValue": "Off (CpG context only)"}, {"type": ["null", "int"], "label": "CutOff", "description": "The minimum number of times any methylation state (methylated or unmethylated) has to be seen for a nucleotide before its methylation percentage is reported.", "id": "#cut_off", "required": false, "sbg:category": "BedGraph Specific Options", "sbg:toolDefaultValue": "1"}, {"type": ["null", {"type": "enum", "symbols": ["non_directional", "pbat"], "name": "sequencing_library"}], "label": "Sequencing library", "description": "The sequencing library could be directional, non-directional and pbat (Post-Bisulfite Adapter Tagging). Directional alignments (which is the default) will only run 2  alignment threads to the original top (OT) or bottom (OB) strands in parallel and  report these alignments. Non-directional alignments were constructed in a non strand-specific manner, where it will run 4 alignment threads to OT, OB, CTOT(complementary to original top) and CTOB(complementary to original bottom). PBAT alignment will only launch two alignment threads to the  CTOT and CTOB.", "id": "#sequencing_library", "sbg:category": "Output", "sbg:toolDefaultValue": "directional"}, {"type": ["null", {"type": "enum", "symbols": ["0", "1", "2", "3"], "name": "seed_mismatches"}], "label": "Seed mismatches", "description": "The maximum number of mismatches permitted in the \"seed\", i.e. the first  base pairs of the read. For Bowtie2 can be set to 0 or 1.", "id": "#seed_mismatches", "sbg:altPrefix": "--seedmms", "sbg:category": "Alignment", "sbg:toolDefaultValue": "Bowtie 1 - 1; Bowtie 2 - 0"}, {"type": ["null", "boolean"], "label": "Nucleotide coverage", "description": "Calculates the mono- and di-nucleotide sequence composition of covered positions in the analyzed BAM file and compares it to the genomic average composition table genomic_nucleotide_frequencies.txt, created by Bismark Genome Preparation. This option works only for BAM or CRAM files.", "id": "#nucleotide_coverage", "required": false, "sbg:altPrefix": "--nucleotide_coverage", "sbg:category": "Options", "sbg:toolDefaultValue": "Off"}, {"type": ["null", "int"], "label": "Multicore", "description": "The number of parallel instances of Bismark to be run concurrently. This forks  the Bismark alignment step very early on so that each individual Spawn of Bismark  processes only every n-th sequence (n being set by --multicore). Once all  processes have completed, the individual BAM files, mapping reports, unmapped or  ambiguous FastQ files are merged into single files in very much the same way as  they would have been generated running Bismark conventionally with only a single  instance.", "id": "#multicore", "sbg:altPrefix": "--multicore", "sbg:category": "Alignment", "sbg:toolDefaultValue": "8"}, {"type": ["null", "int"], "label": "Memory in MB per job", "description": "Memory in MB per job.", "id": "#memory_per_job", "sbg:category": "Platform options", "sbg:toolDefaultValue": "61440", "sbg:suggestedValue": 61440}, {"type": ["null", "int"], "label": "Number of CPUs per job", "description": "Number of CPUs per job.", "id": "#cpu_per_job", "sbg:category": "Platform options", "sbg:toolDefaultValue": "32", "sbg:suggestedValue": 36}, {"type": ["null", {"type": "enum", "symbols": ["Bowtie 1", "Bowtie 2"], "name": "bowtie_aligner"}], "label": "Bowtie Aligner", "description": "Specify which Bowtie aligner should be used.", "id": "#bowtie_aligner", "sbg:category": "Alignment", "sbg:toolDefaultValue": "Bowtie 2"}, {"type": ["null", "boolean"], "label": "Barcode", "description": "In addition to chromosome, start position and orientation this will also take a potential barcode into consideration while deduplicating. The barcode needs to be the last element of the read ID and separated by a ':', e.g.: MISEQ:14:000000000-A55D0:1:1101:18024:2858_1:N:0:CTCC.", "id": "#barcode", "inputBinding": {"valueFrom": {"engine": "#cwl-js-engine", "script": "{\n//  if ($job.inputs.rrbs)\n///    return ''\n//  else \n  \tif ($job.inputs.barcode)\n    \treturn '--barcode'\n}", "class": "Expression"}, "sbg:cmdInclude": true, "separate": false}, "sbg:toolDefaultValue": "Off", "sbg:category": "Options", "sbg:altPrefix": "--barcode"}, {"type": ["null", "string"], "label": "Adapter", "description": "Adapter sequence to be trimmed. If not specified explicitly, Trim Galore will try to auto-detect whether the Illumina universal, Nextera transposase or Illumina small RNA adapter sequence was used. Also see '--illumina', '--nextera' and '--small_rna'. If no adapter can be detected within the first 1 million sequences of the first file specified Trim Galore defaults to '--illumina'.", "id": "#adapter", "sbg:altPrefix": "--adapter", "sbg:category": "General options", "inputBinding": {"separate": true, "prefix": "-a", "sbg:cmdInclude": true, "position": 1}}, {"type": ["null", "string"], "label": "Adapter 2", "description": "Optional adapter sequence to be trimmed off read 2 of paired-end files. This option requires paired-end to be selected as well. If the libraries to be trimmed are smallRNA then a2 will be set to the Illumina small RNA 5' adapter automatically (GATCGTCGGACT).", "id": "#adapter2", "sbg:altPrefix": "--adapter2", "sbg:category": "General options", "inputBinding": {"valueFrom": {"script": "{\n  if (($job.inputs.paired) && ($job.inputs.adapter2))\n  \treturn \"-a2 \" + $job.inputs.adapter2\n  else return \"\"\n}", "class": "Expression", "engine": "#cwl-js-engine"}, "separate": true, "sbg:cmdInclude": true, "position": 1}}, {"type": ["null", "int"], "label": "5' clip read 1", "description": "Instructs Trim Galore to remove <int> bp from the 5' end of read 1 (or single-end reads). This may be useful if the qualities were very poor, or if there is some sort of unwanted bias at the 5' end. Default: OFF.", "id": "#five_clip_r1", "sbg:category": "General options", "inputBinding": {"separate": true, "prefix": "--clip_R1", "sbg:cmdInclude": true, "position": 1}, "sbg:toolDefaultValue": "0"}, {"type": ["null", "int"], "label": "5' clip read 2", "description": "Instructs Trim Galore to remove <int> bp from the 5' end of read 2 (paired-end reads only). This may be useful if the qualities were very poor, or if there is some sort of unwanted bias at the 5' end. For paired-end BS-Seq, it is recommended to remove the first few bp because the end-repair reaction may introduce a bias towards low methylation. Please refer to the M-bias plot section in the Bismark User Guide for some examples. Default: OFF.", "id": "#five_clip_r2", "sbg:altPrefix": "--clip_R2", "sbg:category": "General options", "inputBinding": {"valueFrom": {"script": "{\n  if ($job.inputs.five_clip_r2) {\n  \tif ($job.inputs.paired)\n    \treturn '--clip_R2 ' + $job.inputs.five_clip_r2\n  \telse\n    \treturn \"\"\n      }\n}", "class": "Expression", "engine": "#cwl-js-engine"}, "separate": true, "sbg:cmdInclude": true, "position": 1}, "sbg:toolDefaultValue": "0"}, {"type": ["null", "int"], "label": "3' clip read 1", "description": "Instructs Trim Galore to remove <int> bp from the 3' end of read 1 (or single-end reads) AFTER adapter/quality trimming has been performed. This may remove some unwanted bias from the 3' end that is not directly related to adapter sequence or basecall quality. Default: OFF.", "id": "#three_clip_r1", "sbg:category": "General options", "inputBinding": {"separate": true, "prefix": "--three_prime_clip_R1", "sbg:cmdInclude": true, "position": 1}, "sbg:toolDefaultValue": "0"}, {"type": ["null", "int"], "label": "3' clip read 2", "description": "Instructs Trim Galore to remove <int> bp from the 3' end of read 2 AFTER adapter/quality trimming has been performed. This may remove some unwanted bias from the 3' end that is not directly related to adapter sequence or basecall quality. Default: OFF.", "id": "#three_clip_r2", "sbg:altPrefix": "--three_prime_clip_R2", "sbg:category": "General options", "inputBinding": {"valueFrom": {"script": "{\n  if ($job.inputs.three_clip_r2) {\n  \tif ($job.inputs.paired)\n    \treturn '--three_prime_clip_R2 ' + $job.inputs.three_clip_r2\n  \telse\n    \treturn \"\"\n      }\n}", "class": "Expression", "engine": "#cwl-js-engine"}, "separate": true, "sbg:cmdInclude": true, "position": 1}, "sbg:toolDefaultValue": "0"}, {"type": ["null", "boolean"], "label": "Paired", "description": "This option performs length trimming of quality/adapter/RRBS trimmed reads for paired-end files. To pass the validation test, both sequences of a sequence pair are required to have a certain minimum length which is governed by the option --length (see above). If only one read passes this length threshold the other read can be rescued (see option --retain_unpaired). Using this option lets you discard too short read pairs without disturbing the sequence-by-sequence order of FastQ files which is required by many aligners. Trim Galore! expects paired-end files to be supplied in a pairwise fashion, e.g. file1_1.fq file1_2.fq SRR2_1.fq.gz SRR2_2.fq.gz ... .", "id": "#paired", "sbg:category": "Paired-end specific options", "inputBinding": {"separate": false, "prefix": "--paired", "sbg:cmdInclude": true, "position": 3}, "sbg:toolDefaultValue": "Off"}], "output": [{"name": "Splitting report", "encodingFormat": "text/plain"}, {"name": "Nucleotide report", "encodingFormat": "text/plain"}, {"name": "Mbias report", "encodingFormat": "text/plain"}, {"name": "Deduplicate report", "encodingFormat": "text/plain"}, {"name": "Alignment report", "encodingFormat": "text/plain"}, {"name": "Bismark report", "encodingFormat": "text/html"}, {"name": "Sorted deduplicated BAM", "encodingFormat": "application/x-sam"}, {"name": "Yacht file", "encodingFormat": "text/plain"}, {"name": "Coverage file"}, {"name": "BedGraph"}, {"name": "CpG context", "encodingFormat": "text/plain"}, {"name": "CHH context", "encodingFormat": "text/plain"}, {"name": "CHG context", "encodingFormat": "text/plain"}, {"name": "Post trimming FASTQC Analysis", "encodingFormat": "text/html"}, {"name": "Pre trimming FASTQC Analysis", "encodingFormat": "text/html"}, {"name": "Bismark alignment file", "encodingFormat": "application/x-bam"}], "applicationSuite": "Bismarkversion:0.19.0", "applicationSubCategory": ["Methylation", "Alignment", "Methylation Extraction"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1519392251, "sbg:revisionNotes": null}, {"sbg:revision": 1, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1519392252, "sbg:revisionNotes": null}, {"sbg:revision": 2, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1519392252, "sbg:revisionNotes": null}, {"sbg:revision": 3, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1519392252, "sbg:revisionNotes": "Connected Single end input to Bismark Methylation Extractor"}, {"sbg:revision": 4, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1519392252, "sbg:revisionNotes": "Added description of the wf checked by Emile."}, {"sbg:revision": 5, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1519392253, "sbg:revisionNotes": "Added suggested files"}, {"sbg:revision": 6, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1519392253, "sbg:revisionNotes": "Updated Bismark."}, {"sbg:revision": 7, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1519392253, "sbg:revisionNotes": "Removed version from the name of wf. Version added to the toolkit version field."}, {"sbg:revision": 8, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1520523343, "sbg:revisionNotes": "Updated SBG Bismark Linux Cat and SBG FASTA Indicies."}, {"sbg:revision": 9, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1530631147, "sbg:revisionNotes": "Updated: Slice Bismark BAMs, Bismark Deduplicate, Bismarl2Report, SBG FASTQ  Merge, SBG FASTA Indices. One SBG FlattenLists was taken from public wf, changed from demo."}, {"sbg:revision": 10, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1531825967, "sbg:revisionNotes": "Updated SBG Pair FASTQs by Metadata; scattered SBG FASTA Indices by reference"}, {"sbg:revision": 11, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1531825967, "sbg:revisionNotes": "Changed type of input Reference FASTA to array of files"}, {"sbg:revision": 12, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1531825967, "sbg:revisionNotes": "Exposed multicore parameter in Bismark"}, {"sbg:revision": 13, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1537872661, "sbg:revisionNotes": "Updated Trim Galore! and  Bismark2Report - removed html to b64 conversion; SBG Flatten Lists; Replaced FastQC tool with FastQC analysis wf"}, {"sbg:revision": 14, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1545144907, "sbg:revisionNotes": "Added Alibaba Cloude Instance"}, {"sbg:revision": 15, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1545923762, "sbg:revisionNotes": "Updated SBG Fasta Indices, SBG Pair FASTQs by Metadata, Bismark Deduplicate and SBG Bismark Linux Cat"}, {"sbg:revision": 16, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1545923763, "sbg:revisionNotes": "Updated SBG Fasta Indices,  Bismark Deduplicate and SBG Bismark Linux Cat"}, {"sbg:revision": 17, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1545932246, "sbg:revisionNotes": "Update docker images on SBG tools"}, {"sbg:revision": 18, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1545932246, "sbg:revisionNotes": "Update docker image on SBG Linux Cat"}, {"sbg:revision": 19, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1547655417, "sbg:revisionNotes": "Sbg pair fastqs by metadata not updated"}, {"sbg:revision": 20, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1547655418, "sbg:revisionNotes": "updated SBG Pair fastqs by metadata"}, {"sbg:revision": 21, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1548176314, "sbg:revisionNotes": "Updated TrimGalore, changed ids for some outputs"}, {"sbg:revision": 22, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1551887063, "sbg:revisionNotes": "Update trimgalore - fixed inheriting metadata from the input reads"}, {"sbg:revision": 23, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1562835899, "sbg:revisionNotes": ""}, {"sbg:revision": 24, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1562835901, "sbg:revisionNotes": ""}, {"sbg:revision": 25, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1584552648, "sbg:revisionNotes": "Updated description - added warning about # and ~ in filenames"}, {"sbg:revision": 26, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1625734495, "sbg:revisionNotes": "Azure Instance Hint added"}, {"sbg:revision": 27, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1625734497, "sbg:revisionNotes": "Epigenetics, Methylation categories added"}, {"sbg:revision": 28, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648561064, "sbg:revisionNotes": "categories modified"}], "creator": "Seven Bridges Genomics", "dateModified": 1648561064, "dateCreated": 1519392251, "contributor": ["admin"], "sdPublisher": "sbg", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_bristol-myers-squibb-publishin/bms-public-apps/bms-bam-prep/4", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/bristol-myers-squibb-publishin/bms-public-apps/bms-bam-prep/4", "applicationCategory": "Workflow", "version": "sbg:draft-2", "name": "BMS BAM prep", "description": "**BMS BAM prep** is the obligatory first phase that must precede all variant discovery. It involves pre-processing the raw sequence data (provided in FASTQ format) to produce analysis-ready BAM files. This involves alignment to a reference genome, as well as some data cleanup operations to correct for technical biases and make the data suitable for analysis [1].\n\nThis workflow is a part of the project to transfer BMS variant calling procedures from custom bash scripts to the Platform, which started in October 2017. \n\n*A list of **all inputs and parameters** with corresponding descriptions can be found at the bottom of the page.*\n\n### Common Use Cases\n\nThis workflow contains three main steps:\n* **Alignment** of raw reads to the human reference genome with **BWA MEM Bundle** (0.7.17). Besides the standard **BWA MEM** SAM output file, **BWA MEM** package has been extended to support two additional output options: a BAM file obtained by piping through **Sambamba view** while filtering out the secondary alignments, as well as a **Coordinate Sorted BAM** option that additionally pipes the output through **Sambamba sort**, along with an accompanying BAI file produced by **Sambamba sort**. This sorted BAM is the default output of BWA MEM.\n* **Deduplication** with **Picard MarkDuplicates** tool (2.9.2). This second processing step consists of identifying read pairs that are likely to have originated from duplicates of the same original DNA fragments through some artifactual processes [1].\n* **Base recalibration** consists of two tools: **GATK BaseRecalibrator** and **GATK apply BQSR**. The first tool is applying machine learning to detect patterns of systematic errors in the base quality scores, which are confidence scores emitted by the sequencer for each base, while the second one is applying recalibration to the deduplicated BAM file [1].\n\n### Changes Introduced by Seven Bridges\n\n* Outputs are named by sample IDs e.g.: *SampleID.sorted.dedup.realigned.recal.bam*\n* **Picard BEDToIntervalsList** tools are added for conversion of BED files into INTERVALS_LIST.\n* Alignment can be performed in batch mode. Batching is most often performed by sample ID metadata.\n\n### Common Issues and Important Notes\n\n* In order to successfully work, **BWA MEM Bundle** requires a FASTA reference file accompanied with BWA FASTA indices in a TAR file. \n* There is a known issue with **Samblaster** - it does not support processing when the number of sequences in the reference FASTA is larger than 32768. \n* If the reference file is provided in FASTA format instead of a TAR file (which already contains all the necessary indices), the runtime will be significantly increased.\n* Pipeline provides suggested reference files when running it for the first time in a project. These files are aimed for use with BMS kit, and should only be used for testing purposes. If using this pipeline for production, these files should be replaced with references corresponding to the input reads.\n\n\n### Performance Benchmarking\n\nIn the following table you can find estimates of **BMS BAM prep** run times and costs. All samples are aligned against **hg19 human reference**. \n\n*Cost can be significantly reduced by using **spot instances**. Visit the [Knowledge Center](https://docs.sevenbridges.com/docs/about-spot-instances) for more details.*     \n\n| Threads and CPUs        | Memory          | Input size        | WGS/WES           | Duration       | Cost          | Instance (AWS)  |\n| -------------:|:-------------:| -----:|:-------------:| ------------- | ------------- | ------------- |\n|16|30000| 2 X 150 MB     | WES | 10 minutes| $0.13 |    c4.4xlarge |\n|16|30000| 2 X 3.9 GB     | WES | 1 hour and 35 minutes| $1.26 |    c4.4xlarge |\n|16|30000| 2 X 8.3 GB     | WES | 4 hour 15 minute| $3.38 |    c4.4xlarge |\n\n\n### API Python Implementation\n\nThe app's draft task can also be submitted via the **API**. In order to learn how to get your **Authentication token** and **API endpoint** for corresponding platform visit our [documentation](https://github.com/sbg/sevenbridges-python#authentication-and-configuration).\n\n```python\n# Initialize the SBG Python API\nfrom sevenbridges import Api\napi = Api(token=\"enter_your_token\", url=\"enter_api_endpoint\")\n# Get project_id/app_id from your address bar. Example: https://igor.sbgenomics.com/u/your_username/project/app\nproject_id = \"your_username/project\"\napp_id = \"your_username/project/app\"\n# Replace inputs with appropriate values\ninputs = {\n\t\"input_tar_with_reference\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"bait_bed\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"target_bed\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"input_reads\": list(api.files.query(project=project_id, names=[\"enter_filename\", \"enter_filename\"]))}\n# Creates draft task\ntask = api.tasks.create(name=\"BMS BAM prep - API Run\", project=project_id, app=app_id, inputs=inputs, run=False)\n```\n\nInstructions for installing and configuring the API Python client, are provided on [github](https://github.com/sbg/sevenbridges-python#installation). For more information about using the API Python client, consult [the client documentation](http://sevenbridges-python.readthedocs.io/en/latest/). **More examples** are available [here](https://github.com/sbg/okAPI).\n\nAdditionally, [API R](https://github.com/sbg/sevenbridges-r) client is available. To learn more about using this API client please refer to the [API R client documentation](https://sbg.github.io/sevenbridges-r/).\n\n\n### References\n[1 - GATK best practices](https://software.broadinstitute.org/gatk/best-practices/workflow?id=11165)", "input": [{"name": "Reference or TAR with BWA reference indices", "encodingFormat": "application/x-fasta"}, {"name": "Bait BED"}, {"name": "Target BED"}, {"name": "Input reads", "encodingFormat": "text/fastq"}, {"name": "KgSnp Database", "encodingFormat": "application/x-vcf"}, {"name": "MgIndel Database", "encodingFormat": "application/x-vcf"}], "original_input": [{"type": ["File"], "label": "Reference or TAR with BWA reference indices", "description": "Input TAR file containing reference genome with all necessary indexes (AMB, ANN, PAC, BWT, SA) which will be used in BWA MEM tool for alignment. If reference in FASTA format is provided, BWA INDEX tool will construct the FM-index (Full-text index in Minute space) for the reference genome and compress it in TAR archive format.", "sbg:fileTypes": "FASTA, FA, FA.GZ, FASTA.GZ, TAR", "id": "#input_tar_with_reference", "sbg:x": -485.0006805526151, "sbg:y": 1039.9965012866844, "sbg:includeInPorts": true, "sbg:suggestedValue": {"class": "File", "name": "ucsc.hg19.fasta.tar", "path": "5d77c83ee4b0ca728bb37340"}}, {"type": ["File"], "label": "Bait BED", "description": "Bait coverage in BED format for calculating how the wet-lab assay is functioning.", "sbg:fileTypes": "BED", "id": "#bait_bed", "sbg:includeInPorts": true, "sbg:x": -498.333485378165, "sbg:y": 1445.0000167952635, "sbg:suggestedValue": {"class": "File", "name": "SureSelect_XT_Human_All_Exon_V5_annot.bed", "path": "5d77c83ee4b0ca728bb37341"}}, {"type": ["File"], "label": "Target BED", "description": "Target coverage given in BED format for calculating targets that received at least coverage depth = 2.", "sbg:fileTypes": "BED", "id": "#target_bed", "sbg:includeInPorts": true, "sbg:x": -493.3335462146415, "sbg:y": 1295.0004176696295, "sbg:suggestedValue": {"class": "File", "name": "v5_core_targets.refse-ccds-gencode-ucsc.bed", "path": "5d77c83ee4b0ca728bb37349"}}, {"type": [{"type": "array", "items": "File"}], "label": "Input reads", "description": "Paired end FASTQ files from Illumina sequencers. This input can be batched by metadata Sample ID field.", "sbg:fileTypes": "FASTQ, FASTQ.GZ, FQ, FQ.GZ", "id": "#input_reads", "sbg:x": -490.0001823637288, "sbg:y": 733.3338914447575, "sbg:includeInPorts": true}, {"type": ["File"], "label": "KgSnp Database", "description": "1000G SNPs in VCF file format which will be used as known sites for BQSR tool.", "sbg:fileTypes": "VCF", "id": "#kgsnp_database", "sbg:includeInPorts": true, "sbg:x": -491, "sbg:y": 279.4449768066406, "sbg:suggestedValue": {"class": "File", "name": "1000G_phase1.snps.high_confidence.hg19.sites.vcf", "path": "5d77c83ee4b0ca728bb3733e"}}, {"type": ["File"], "label": "MgIndel Database", "description": "Mills and 1000G INDELs in VCF file format which will be used as known sites for BQSR tool.", "sbg:fileTypes": "VCF", "id": "#mgindel_database", "sbg:includeInPorts": true, "sbg:x": -490.00001947085093, "sbg:y": 431.66669425699513, "sbg:suggestedValue": {"class": "File", "name": "Mills_and_1000G_gold_standard.tab.indels.hg19.sites.vcf.gz", "path": "5d77c83ee4b0ca728bb3733f"}}], "output": [{"name": "Dedup Metrics", "encodingFormat": "text/plain"}, {"name": "Recal Table"}, {"name": "Alignment Metrics", "encodingFormat": "text/plain"}, {"name": "Picard HS Metrics", "encodingFormat": "text/plain"}, {"name": "Picard Per Target Coverage", "encodingFormat": "text/plain"}, {"name": "Output BAM", "encodingFormat": "application/x-bam"}], "applicationSuite": "GATKversion:4.0", "applicationSubCategory": ["WES-(WXS)", "SAM/BAM-Processing"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "bristol-myers-squibb-publishin/bms.publish", "sbg:modifiedOn": 1568133331, "sbg:revisionNotes": null}, {"sbg:revision": 1, "sbg:modifiedBy": "bristol-myers-squibb-publishin/bms.publish", "sbg:modifiedOn": 1568133345, "sbg:revisionNotes": "Initial revision"}, {"sbg:revision": 2, "sbg:modifiedBy": "bristol-myers-squibb-publishin/bms.publish", "sbg:modifiedOn": 1581242129, "sbg:revisionNotes": "Fix bug with wrong input file ID, and add to description the part about Sample ID metadata on input FASTQ files"}, {"sbg:revision": 3, "sbg:modifiedBy": "bristol-myers-squibb-publishin/bms.publish", "sbg:modifiedOn": 1643215271, "sbg:revisionNotes": "GATK IndexFeatureFile updated to catch .tbi as a secondary file"}, {"sbg:revision": 4, "sbg:modifiedBy": "bristol-myers-squibb-publishin/bms.publish", "sbg:modifiedOn": 1648557472, "sbg:revisionNotes": "Suggested files added and description updated"}], "creator": "BMS/SBG", "dateModified": 1648557472, "dateCreated": 1568133331, "contributor": ["bristol-myers-squibb-publishin/bms.publish"], "sdPublisher": "BMS", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_bristol-myers-squibb-publishin/bms-public-apps/bms-wes-tumor-normal-pipeline-hg19/2", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/bristol-myers-squibb-publishin/bms-public-apps/bms-wes-tumor-normal-pipeline-hg19/2", "applicationCategory": "Workflow", "version": "sbg:draft-2", "name": "BMS WES Tumor-Normal pipeline hg19", "description": "**BMS WES TN pipeline hg19** is a workflow made around the _Strelka 1.0.15_ somatic variant caller (SNVs and INDELs) and _GATK Mutect 1.1.6_ (SNVs) somatic variant callers, which perform variant calling on matched tumor - normal BAM files.\n\nThis workflow is a part of the project to transfer BMS variant calling procedures from custom bash scripts to the Platform, which started in October 2017. This workflow utilizes human reference genome hg19.\n\n*A list of **all inputs and parameters** with corresponding descriptions can be found at the bottom of the page.*\n\n###Common Use Cases\n\nBAM files are used as inputs. **Tumor BAM file** and **Normal BAM file**, should be sorted and indexed. This can be done by using the **BMS BAM prep** workflow. The **Input tar with reference** input should contain the reference genome with all necessary indexes. For every VCF output that this workflow produces, Variant Calling Metrics are calculated and a MAF file is produced.\n\nThere are tools that performs annotation of output VCF files in this workflow. Annotation is done with: \n* _dbSNP_ \n* _SNPEff database_ \n* _1000G snps_ \n* _1000G indels_\n* _Mills and 1000G indels_ \n* _Cosmic database_\n* _ExAC database_\n\n\n### Changes Introduced by Seven Bridges\n\n* Every output has its own subset which contains only variants that are in BED file regions. These output are prefixed with **intersected**.\n\n* Only primary chromosomes are kept in VCF/MAF files.\n\n* Outputs are named by sample IDs e.g.: TumorID-NormalID.passed.somatic.strelka.snvs.vcf\n\n\n### Common Issues and Important Notes\n\n#### **IMPORTANT LICENSING INFORMATION**\n* MuTect is licensed by the Broad Institute and is made available for free to academic users for non-commercial use only pursuant to the licensing terms below, and to other authorized licensees pursuant to the terms of their respective licenses, in each case for use within this pipeline only. The full text of the academic license for non-commercial use of MuTect is available on [github](https://github.com/broadinstitute/mutect/blob/master/mutect.LICENSE.TXT). \n\n*   For commercial licensing information, please email [Broad institute](softwarelicensing@broadinstitute.org). \n \n*  For more information about Mutect, please visit the [Mutect website](https://software.broadinstitute.org/cancer/cga/mutect).\n  \n#### MuTect documentation resources and support\n\nGeneral MuTect documentation can be found on the [MuTect website](https://software.broadinstitute.org/cancer/cga/mutect). Users of this pipeline are welcome to ask MuTect-related questions and report problems that are not specific to this pipeline in the [MuTect forum](http://gatkforums.broadinstitute.org/categories/mutect).\n\n#### Strelka common issues\n\n- According to the [Strelka FAQ](https://sites.google.com/site/strelkasomaticvariantcaller/home/faq), the following BAM records are incompatible with Strelka (quoted):\n  - Alignments which use the match/mismatch (\"=\"/\"X\") CIGAR notation\n  - Records where the \"=\" character is used in the SEQ field\n  - BAM records with basecall quality values greater than 70 (not supported assuming that this indicates an offset error)\n- Unless input BAM files **Tumor BAM file** and **Normal BAM file** are supplied to Strelka (both sorted and indexed), Strelka will not finish successfully. \n\n###Performance Benchmarking\n\nIn the following table you can find estimates of **Matched TN pipeline hg19** run times and costs. All samples are aligned against **hg19 human reference**. \n\n*Cost can be significantly reduced by using **spot instances**. Visit the [Knowledge Center](https://docs.sevenbridges.com/docs/about-spot-instances) for more details.*     \n\n| Threads and CPUs        | Memory          | Input size        | WGS/WES           | Duration       | Cost          | Instance (AWS)  |\n| -------------:|:-------------:| -----:|:-------------:| ------------- | ------------- | ------------- |\n|36|60000| 5.2 GB + 4.9 GB     | WES | 42 minutes| $1.11 |    c4.8xlarge |\n|36|60000| 6.6 GB + 6.9 GB     | WES | 48 minutes| $1.27 |    c4.8xlarge |\n|36|60000| 14 GB + 14 GB     | WES | 1 hour 21 minutes| $2.14 |    c4.8xlarge |\n\n\n### API Python Implementation\n\nThe app's draft task can also be submitted via the **API**. In order to learn how to get your **Authentication token** and **API endpoint** for corresponding platform visit our [documentation](https://github.com/sbg/sevenbridges-python#authentication-and-configuration).\n\n```python\n# Initialize the SBG Python API\nfrom sevenbridges import Api\napi = Api(token=\"enter_your_token\", url=\"enter_api_endpoint\")\n# Get project_id/app_id from your address bar. Example: https://igor.sbgenomics.com/u/your_username/project/app\nproject_id = \"your_username/project\"\napp_id = \"your_username/project/app\"\n# Replace inputs with appropriate values\ninputs = {\n\t\"target_bed\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"tumor_reads\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"normal_reads\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"kgindel_database\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"mgindel_database\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"snpEff_database\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"cosmic_database\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"cache_file\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"annotation_reference\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"ExAC_database\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"input_tar_with_reference\": api.files.query(project=project_id, names=[\"enter_filename\"])[0]}\n# Creates draft task\ntask = api.tasks.create(name=\"BMS WES TN pipeline hg19 - API Run\", project=project_id, app=app_id, inputs=inputs, run=False)\n```\n\nInstructions for installing and configuring the API Python client, are provided on [github](https://github.com/sbg/sevenbridges-python#installation). For more information about using the API Python client, consult [the client documentation](http://sevenbridges-python.readthedocs.io/en/latest/). **More examples** are available [here](https://github.com/sbg/okAPI).\n\nAdditionally, [API R](https://github.com/sbg/sevenbridges-r) client is available. To learn more about using this API client please refer to the [API R client documentation](https://sbg.github.io/sevenbridges-r/).", "input": [{"name": "Target BED"}, {"name": "Tumor reads", "encodingFormat": "application/x-bam"}, {"name": "Normal reads", "encodingFormat": "application/x-bam"}, {"name": "SnpEff Database", "encodingFormat": "application/zip"}, {"name": "Cache File", "encodingFormat": "application/x-tar"}, {"name": "Input TAR with reference", "encodingFormat": "application/x-fasta"}, {"name": "KgSnp Database", "encodingFormat": "application/x-vcf"}, {"name": "dbSNP", "encodingFormat": "application/x-vcf"}, {"name": "KgIndel Database", "encodingFormat": "application/x-vcf"}, {"name": "MgIndel Database", "encodingFormat": "application/x-vcf"}, {"name": "ExAC Database", "encodingFormat": "application/x-vcf"}, {"name": "Cosmic Database", "encodingFormat": "application/x-vcf"}, {"name": "Annotation Reference", "encodingFormat": "application/x-fasta"}], "original_input": [{"type": ["File"], "label": "Target BED", "description": "Target BED file with regions of interest. This input will be used for keeping only mutations that are in given regions.", "sbg:fileTypes": "BED", "id": "#target_bed", "sbg:x": 73.83560056928872, "sbg:includeInPorts": true, "sbg:y": 712.6595764025585, "sbg:suggestedValue": {"class": "File", "name": "v5_core_targets.refse-ccds-gencode-ucsc.bed", "path": "5d77c83ee4b0ca728bb37349"}}, {"type": ["File"], "label": "Tumor reads", "description": "Tumor read sequence input file in BAM format. Secondary index BAI file should be along with BAM file in project.", "sbg:fileTypes": "BAM", "id": "#tumor_reads", "secondaryFiles": [".bai"], "sbg:x": 81.90491231282554, "sbg:y": 416.95303344726574, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Normal reads", "description": "Normal read sequence input file in BAM format. Secondary index BAI file should be along with BAM file in project.", "sbg:fileTypes": "BAM", "id": "#normal_reads", "secondaryFiles": [".bai"], "sbg:x": 81.66669788625622, "sbg:y": 556.6667091316658, "sbg:includeInPorts": true}, {"type": ["File"], "label": "SnpEff Database", "description": "SNPEff database used for annotation of found somatic mutations.", "sbg:fileTypes": "ZIP", "id": "#snpEff_database", "sbg:x": 81.00001525878909, "sbg:includeInPorts": true, "sbg:y": 1748.6667480468755, "sbg:suggestedValue": {"class": "File", "name": "hg19.zip", "path": "5d77c83ee4b0ca728bb37342"}}, {"type": ["File"], "label": "Cache File", "description": "Cache file used for annotation of found somatic mutations in TAR.GZ file format.", "sbg:fileTypes": "TAR.GZ", "id": "#cache_file", "sbg:x": 81.00021107991539, "sbg:y": 1877.3334554036462, "sbg:includeInPorts": true, "sbg:suggestedValue": {"class": "File", "name": "homo_sapiens_vep_90_GRCh37.tar.gz", "path": "5d77c83ee4b0ca728bb37344"}}, {"type": ["File"], "label": "Input TAR with reference", "description": "Input TAR file containing reference genome with all necessary indexes (AMB, ANN, PAC, BWT, SA). If reference in FASTA format is provided, BWA INDEX tool will construct the FM-index (Full-text index in Minute space) for the reference genome and compress it in TAR archive format.", "sbg:fileTypes": "TAR, FA, FASTA, FA.GZ, FASTA.GZ", "id": "#input_tar_with_reference", "sbg:x": 91.66667938232425, "sbg:y": 137.00004069010419, "sbg:includeInPorts": true, "sbg:suggestedValue": {"class": "File", "name": "ucsc.hg19.fasta.tar", "path": "5d77c83ee4b0ca728bb37340"}}, {"type": ["null", "File"], "label": "KgSnp Database", "description": "1000G SNPs containing germline SNPs mutations in VCF file format.", "sbg:fileTypes": "VCF", "id": "#kgsnp_database", "sbg:x": 73.99997965494795, "sbg:y": 835.0004069010419, "sbg:includeInPorts": true, "sbg:suggestedValue": {"class": "File", "name": "1000G_phase1.snps.high_confidence.hg19.sites.vcf", "path": "5d77c83ee4b0ca728bb3733e"}}, {"type": ["File"], "label": "dbSNP", "description": "dbSNP file containing known SNPs and INDELs germline mutations in VCF file format.", "sbg:fileTypes": "VCF", "id": "#dbSNP", "sbg:includeInPorts": true, "sbg:x": 72.00001525878909, "sbg:y": 968.0001017252607, "sbg:suggestedValue": {"class": "File", "name": "dbsnp_138.hg19.vcf", "path": "5d77c83ee4b0ca728bb37348"}}, {"type": ["File"], "label": "KgIndel Database", "description": "1000G INDELs containing known INDELs mutations in VCF.GZ file format.", "sbg:fileTypes": "VCF.GZ", "id": "#kgindel_database", "sbg:includeInPorts": true, "sbg:x": 73.33335367838544, "sbg:y": 1224.000122070313, "sbg:suggestedValue": {"class": "File", "name": "1000G_phase1.tab.indels.hg19.vcf.gz", "path": "5d77c83ee4b0ca728bb3734a"}}, {"type": ["File"], "label": "MgIndel Database", "description": "Mills and 1000G INDELs containing known INDELs in VCF.GZ file format.", "sbg:fileTypes": "VCF.GZ", "id": "#mgindel_database", "sbg:includeInPorts": true, "sbg:x": 75.99998982747397, "sbg:y": 1349.333374023438, "sbg:suggestedValue": {"class": "File", "name": "Mills_and_1000G_gold_standard.tab.indels.hg19.sites.vcf.gz", "path": "5d77c83ee4b0ca728bb3733f"}}, {"type": ["File"], "label": "ExAC Database", "description": "ExAC database containing known germline mutations with population frequency.", "sbg:fileTypes": "VCF.GZ", "id": "#ExAC_database", "sbg:includeInPorts": true, "sbg:x": 77.33331044514975, "sbg:y": 1476.0001627604172, "sbg:suggestedValue": {"class": "File", "name": "ExAC.r0.3.1.sites.vep.conv.vcf.gz", "path": "5d77c83ee4b0ca728bb37343"}}, {"type": ["File"], "label": "Cosmic Database", "description": "Cosmic database containing known somatic mutations.", "sbg:fileTypes": "VCF.GZ", "id": "#cosmic_database", "sbg:includeInPorts": true, "sbg:x": 80.00001017252607, "sbg:y": 1602.666625976563, "sbg:suggestedValue": {"class": "File", "name": "cosmic_v67_chr_sorted.tab.vcf.gz", "path": "5d77c83ee4b0ca728bb37346"}}, {"type": ["File"], "label": "Annotation Reference", "description": "Annotation reference with all necessary indexes in FA.GZ file format.", "sbg:fileTypes": "FA, FASTA, FA.GZ", "id": "#annotation_reference", "sbg:x": 83.00035603841148, "sbg:includeInPorts": true, "sbg:y": 2004.6673583984382, "sbg:suggestedValue": {"class": "File", "name": "Homo_sapiens.tab.GRCh37.dna.primary_assembly.fa.gz", "path": "5d77c83ee4b0ca728bb37345"}}], "output": [{"name": "Annotated MuTect Variants", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected Annotated MuTect Variants", "encodingFormat": "application/x-vcf"}, {"name": "TMB Output", "encodingFormat": "text/plain"}, {"name": "BED Intersected Annotated Strelka Passed SNVs", "encodingFormat": "application/x-vcf"}, {"name": "Annotated Strelka Passed INDELs", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected Annotated Strelka Passed INDELs", "encodingFormat": "application/x-vcf"}, {"name": "Annotated Strelka Passed SNVs", "encodingFormat": "application/x-vcf"}, {"name": "MuTect MAF"}, {"name": "BED Intersected MuTect Variants", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected MuTect MAF"}, {"name": "MuTect Variants", "encodingFormat": "application/x-vcf"}, {"name": "MuTect VC Summary Metrics"}, {"name": "MuTect Stats"}, {"name": "BED Intersected MuTect VC Summary Metrics"}, {"name": "Strelka Passed Indels VC Summary Metrics"}, {"name": "Strelka Passed SNVs VC Summary Metrics"}, {"name": "Strelka Passed SNVs", "encodingFormat": "application/x-vcf"}, {"name": "Strelka Passed INDELs", "encodingFormat": "application/x-vcf"}, {"name": "Strelka All SNVs", "encodingFormat": "application/x-vcf"}, {"name": "Strelka All INDELs", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected Strelka Passed SNVs", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected Strelka Passed INDELs", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected Strelka All SNVs", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected Strelka All INDELs", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected Strelka Passed INDELs VC Summary Metrics"}, {"name": "BED Intersected Strelka Passed SNVs VC Summary Metrics"}, {"name": "Strelka Passed SNVs MAF"}, {"name": "Strelka Passed INDELs MAF"}, {"name": "BED Intersected Strelka Passed SNVs MAF"}, {"name": "BED Intersected Strelka Passed INDELs MAF"}], "applicationSuite": "BMS pipelinesversion:", "applicationSubCategory": ["Variant-Calling"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "bristol-myers-squibb-publishin/bms.publish", "sbg:modifiedOn": 1568134297, "sbg:revisionNotes": null}, {"sbg:revision": 1, "sbg:modifiedBy": "bristol-myers-squibb-publishin/bms.publish", "sbg:modifiedOn": 1568134316, "sbg:revisionNotes": "Initial revision"}, {"sbg:revision": 2, "sbg:modifiedBy": "bristol-myers-squibb-publishin/bms.publish", "sbg:modifiedOn": 1569422197, "sbg:revisionNotes": "Secondary file requirement fixed"}], "creator": "SBG/BMS", "dateModified": 1569422197, "dateCreated": 1568134297, "contributor": ["bristol-myers-squibb-publishin/bms.publish"], "sdPublisher": "BMS", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_bristol-myers-squibb-publishin/bms-public-apps/bms-wes-tumor-only-pipeline-hg19/2", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/bristol-myers-squibb-publishin/bms-public-apps/bms-wes-tumor-only-pipeline-hg19/2", "applicationCategory": "Workflow", "version": "sbg:draft-2", "name": "BMS WES tumor only pipeline hg19", "description": "BMS WES tumor only pipeline hg19 is a workflow which performs somatic variant calling on a tumor BAM file.\n\nIt is made around the _Strelka 1.0.15_ (SNVs and INDELs) and _GATK Mutect 1.1.6_ (SNVs) somatic variant callers which perform variant calling on a tumor BAM file.\n\nThis workflow is a part of the project to transfer BMS variant calling procedures from custom bash scripts to the Platform, which started in October 2017. The workflow utilizes human reference genome hg19.\n\n*A list of **all inputs and parameters** with corresponding descriptions can be found at the bottom of the page.*\n\n### Common Use Cases\n\nBAM file is used as input. **Tumor BAM file**, should be sorted and indexed. This can be done by using the **BMS BAM prep** workflow. The **Input tar with reference** input should contain the reference genome file with all necessary indexes. For every output that this workflow produces, Variant Calling Metrics are calculated and a MAF file is produced.\n\nThere are also tools that perform annotation of output VCF files in this workflow. Annotation is done with:\n* _dbSNP_ \n* _SNPEff database_ \n* _1000G snps_ \n* _1000G indels_\n* _Mills and 1000G indels_ \n* _Cosmic database_\n* _ExAC database_\n\n\n### Changes Introduced by Seven Bridges\n\n* **Strelka1.0.15** doesn't perform somatic calling in tumor-only mode. We used **NA12878** WES BAM sample aligned against hg19 human reference as  normal sample.\n\n* Every output has its own subset, which contains only variants that are in BED file regions. These outputs are prefixed with **intersected**.\n\n* Only primary chromosomes are kept in VCF/MAF files.\n\n* Outputs are named by sample IDs e.g.: TumorID.passed.somatic.strelka.snvs.vcf\n\n\n### Common Issues and Important Notes\n\n#### **IMPORTANT LICENSING INFORMATION**\n* MuTect is licensed by the Broad Institute and is made available for free to academic users for non-commercial use only pursuant to the licensing terms below, and to other authorized licensees pursuant to the terms of their respective licenses, in each case for use within this pipeline only. The full text of the academic license for non-commercial use of MuTect is available on [github](https://github.com/broadinstitute/mutect/blob/master/mutect.LICENSE.TXT). \n\n*   For commercial licensing information, please email [Broad institute](softwarelicensing@broadinstitute.org). \n \n*  For more information about Mutect, please visit the [Mutect website](https://software.broadinstitute.org/cancer/cga/mutect).\n  \n#### MuTect documentation resources and support\n\nGeneral MuTect documentation can be found on the [MuTect website](https://software.broadinstitute.org/cancer/cga/mutect). Users of this pipeline are welcome to ask MuTect-related questions and report problems that are not specific to this pipeline in the [MuTect forum](http://gatkforums.broadinstitute.org/categories/mutect).\n\n#### Strelka common issues\n\n- According to the [Strelka FAQ](https://sites.google.com/site/strelkasomaticvariantcaller/home/faq) the following BAM records are incompatible with Strelka (quoted):\n  - Alignments which use the match/mismatch (\"=\"/\"X\") CIGAR notation\n  - Records where the \"=\" character is used in the SEQ field\n  - BAM records with basecall quality values greater than 70 (not supported assuming that this indicates an offset error)\n- Unless input BAM files **Tumor BAM file** and **Normal BAM file** are supplied to Strelka (both sorted and indexed), Strelka will not finish successfully.\n\n### Performance Benchmarking\n\nIn the following table you can find estimates of **Tumor only pipeline hg19** run times and costs. All samples are aligned against **hg19 human reference**. \n\n*Cost can be significantly reduced by using **spot instances**. Visit the [Knowledge Center](https://docs.sevenbridges.com/docs/about-spot-instances) for more details.*     \n\n| Threads and CPUs        | Memory          | Input size        | WGS/WES           | Duration       | Cost          | Instance (AWS)  |\n| -------------:|:-------------:| -----:|:-------------:| ------------- | ------------- | ------------- |\n|36|60000| 4.4 GB     | WES | 48 minutes| $1.27 |    c4.8xlarge |\n|36|60000| 5.4 GB     | WES | 50 minutes| $1.32 |    c4.8xlarge |\n|36|60000| 14 GB     | WES | 1 hour 1 minute| $1.62 |    c4.8xlarge |\n\n\n### API Python Implementation\n\nThe app's draft task can also be submitted via the **API**. In order to learn how to get your **Authentication token** and **API endpoint** for corresponding platform visit our [documentation](https://github.com/sbg/sevenbridges-python#authentication-and-configuration).\n\n```python\n# Initialize the SBG Python API\nfrom sevenbridges import Api\napi = Api(token=\"enter_your_token\", url=\"enter_api_endpoint\")\n# Get project_id/app_id from your address bar. Example: https://igor.sbgenomics.com/u/your_username/project/app\nproject_id = \"your_username/project\"\napp_id = \"your_username/project/app\"\n# Replace inputs with appropriate values\ninputs = {\n\t\"cosmic_database\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"annotation_reference\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"input_tar_with_reference\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"target_bed\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"tumor_reads\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"kgindel_database\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"mgindel_database\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"snpEff_database\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"ExAC_database\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"cache_file\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"normal_reads\": api.files.query(project=project_id, names=[\"enter_filename\"])[0]}\n# Creates draft task\ntask = api.tasks.create(name=\"BMS WES tumor only pipeline hg19 - API Run\", project=project_id, app=app_id, inputs=inputs, run=False)\n```\n\nInstructions for installing and configuring the API Python client, are provided on [github](https://github.com/sbg/sevenbridges-python#installation). For more information about using the API Python client, consult [the client documentation](http://sevenbridges-python.readthedocs.io/en/latest/). **More examples** are available [here](https://github.com/sbg/okAPI).\n\nAdditionally, [API R](https://github.com/sbg/sevenbridges-r) client is available. To learn more about using this API client please refer to the [API R client documentation](https://sbg.github.io/sevenbridges-r/).", "input": [{"name": "Annotation Reference", "encodingFormat": "application/x-fasta"}, {"name": "Input TAR with reference", "encodingFormat": "application/x-fasta"}, {"name": "Target BED"}, {"name": "Tumor reads", "encodingFormat": "application/x-bam"}, {"name": "KgSnp Database", "encodingFormat": "application/x-vcf"}, {"name": "dbSNP", "encodingFormat": "application/x-vcf"}, {"name": "SnpEff Database", "encodingFormat": "application/zip"}, {"name": "Cache file", "encodingFormat": "application/x-tar"}, {"name": "Normal reads", "encodingFormat": "application/x-bam"}, {"name": "KgIndel Database", "encodingFormat": "application/x-vcf"}, {"name": "MgIndel Database", "encodingFormat": "application/x-vcf"}, {"name": "Cosmic Database", "encodingFormat": "application/x-vcf"}, {"name": "ExAC Database", "encodingFormat": "application/x-vcf"}], "original_input": [{"type": ["File"], "label": "Annotation Reference", "description": "Annotation reference with all necessary indexes in FA.GZ file format.", "sbg:fileTypes": "FA, FASTA, FA.GZ", "id": "#annotation_reference", "sbg:y": 1829.6669921875005, "sbg:includeInPorts": true, "sbg:x": 80.0001627604167, "sbg:suggestedValue": {"class": "File", "name": "Homo_sapiens.tab.GRCh37.dna.primary_assembly.fa.gz", "path": "5d77c83ee4b0ca728bb37345"}}, {"type": ["File"], "label": "Input TAR with reference", "description": "Input TAR file containing reference genome with all necessary indexes (AMB, ANN, PAC, BWT, SA). If reference in FASTA format is provided, BWA INDEX tool will construct the FM-index (Full-text index in Minute space) for the reference genome and compress it in TAR archive format.", "sbg:fileTypes": "TAR, FA, FASTA, FA.GZ, FASTA.GZ", "id": "#input_tar_with_reference", "sbg:y": -61.999969482421896, "sbg:x": 76.3333435058594, "sbg:includeInPorts": true, "sbg:suggestedValue": {"class": "File", "name": "ucsc.hg19.fasta.tar", "path": "5d77c83ee4b0ca728bb37340"}}, {"type": ["File"], "label": "Target BED", "description": "Target BED file with regions of interest. This input will be used for keeping only mutations that are in given regions.", "sbg:fileTypes": "BED", "id": "#target_bed", "sbg:y": 164.59040832519537, "sbg:includeInPorts": true, "sbg:x": 76.21352640787764, "sbg:suggestedValue": {"class": "File", "name": "v5_core_targets.refse-ccds-gencode-ucsc.bed", "path": "5d77c83ee4b0ca728bb37349"}}, {"type": ["File"], "label": "Tumor reads", "description": "Tumor read sequence input file in BAM format. Secondary index BAI file should be along with BAM file in project.", "sbg:fileTypes": "BAM", "id": "#tumor_reads", "secondaryFiles": [".bai"], "sbg:y": 310.1195576985678, "sbg:includeInPorts": true, "sbg:x": 76.4882024129232}, {"type": ["null", "File"], "label": "KgSnp Database", "description": "1000G SNPs containing germline SNPs mutations in VCF file format.", "sbg:fileTypes": "VCF", "id": "#kgsnp_database", "sbg:y": 616.3333740234377, "sbg:includeInPorts": true, "sbg:x": 76.99996693929037, "sbg:suggestedValue": {"class": "File", "name": "1000G_phase1.snps.high_confidence.hg19.sites.vcf", "path": "5d77c83ee4b0ca728bb3733e"}}, {"type": ["null", "File"], "label": "dbSNP", "description": "dbSNP file containing known SNPs and INDELs germline mutations in VCF file format.", "sbg:fileTypes": "VCF", "id": "#dbSNP", "sbg:y": 804.3334554036461, "sbg:includeInPorts": true, "sbg:x": 78.66662597656253, "sbg:suggestedValue": {"class": "File", "name": "dbsnp_138.hg19.vcf", "path": "5d77c83ee4b0ca728bb37348"}}, {"type": ["File"], "label": "SnpEff Database", "description": "SNPEff database used for annotation of found somatic mutations.", "sbg:fileTypes": "ZIP", "id": "#snpEff_database", "sbg:y": 1696.333374023438, "sbg:includeInPorts": true, "sbg:x": 77.99998982747398, "sbg:suggestedValue": {"class": "File", "name": "hg19.zip", "path": "5d77c83ee4b0ca728bb37342"}}, {"type": ["File"], "label": "Cache file", "description": "Cache file used for annotation of found somatic mutations in TAR.GZ file format.", "sbg:fileTypes": "TAR.GZ", "id": "#cache_file", "sbg:y": 1957.00028483073, "sbg:x": 80.99998219807945, "sbg:includeInPorts": true, "sbg:suggestedValue": {"class": "File", "name": "homo_sapiens_vep_90_GRCh37.tar.gz", "path": "5d77c83ee4b0ca728bb37344"}}, {"type": ["File"], "label": "Normal reads", "description": "Normal read sequence input file in BAM format for Strelka variant caller. Secondary index BAI file should be along with BAM file in project.", "sbg:fileTypes": "BAM", "id": "#normal_reads", "secondaryFiles": [".bai"], "sbg:y": 452.4168701171876, "sbg:includeInPorts": true, "sbg:x": 77.4165954589844, "sbg:suggestedValue": {"class": "File", "name": "NA12878_hg19_TOpipe.sorted.dedup.realigned.recal.bam", "path": "5d77c83ee4b0ca728bb37347"}}, {"type": ["File"], "label": "KgIndel Database", "description": "1000G INDELs containing known INDELs mutations in VCF.GZ file format.", "sbg:fileTypes": "VCF.GZ", "id": "#kgindel_database", "sbg:includeInPorts": true, "sbg:x": 85.33334096272789, "sbg:y": 1054.666666666667, "sbg:suggestedValue": {"class": "File", "name": "1000G_phase1.tab.indels.hg19.vcf.gz", "path": "5d77c83ee4b0ca728bb3734a"}}, {"type": ["File"], "label": "MgIndel Database", "description": "Mills and 1000G INDELs containing known INDELs in VCF.GZ file format.", "sbg:fileTypes": "VCF.GZ", "id": "#mgindel_database", "sbg:includeInPorts": true, "sbg:x": 81.33333079020186, "sbg:y": 1186.6667480468755, "sbg:suggestedValue": {"class": "File", "name": "Mills_and_1000G_gold_standard.tab.indels.hg19.sites.vcf.gz", "path": "5d77c83ee4b0ca728bb3733f"}}, {"type": ["File"], "label": "Cosmic Database", "description": "Cosmic database containing known somatic mutations.", "sbg:fileTypes": "VCF.GZ", "id": "#cosmic_database", "sbg:includeInPorts": true, "sbg:x": 80.00000762939456, "sbg:y": 1327.9999186197922, "sbg:suggestedValue": {"class": "File", "name": "cosmic_v67_chr_sorted.tab.vcf.gz", "path": "5d77c83ee4b0ca728bb37346"}}, {"type": ["File"], "label": "ExAC Database", "description": "ExAC database containing known germline mutations with population frequency.", "sbg:fileTypes": "VCF.GZ", "id": "#ExAC_database_1", "sbg:includeInPorts": true, "sbg:x": 79.99995930989586, "sbg:y": 1477.3332519531255, "sbg:suggestedValue": {"class": "File", "name": "ExAC.r0.3.1.sites.vep.conv.vcf.gz", "path": "5d77c83ee4b0ca728bb37343"}}], "output": [{"name": "Annotated Strelka Passed SNVs", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected Annotated Strelka Passed SNVs", "encodingFormat": "application/x-vcf"}, {"name": "Annotated Strelka Passed INDELs", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected Annotated Strelka Passed INDELs", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected Annotated MuTect Variants", "encodingFormat": "application/x-vcf"}, {"name": "Annotated MuTect Variants", "encodingFormat": "application/x-vcf"}, {"name": "TMB Output", "encodingFormat": "text/plain"}, {"name": "MuTect MAF"}, {"name": "BED Intersected MuTect Variants", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected MuTect MAF"}, {"name": "MuTect Variants", "encodingFormat": "application/x-vcf"}, {"name": "MuTect VC Summary Metrics"}, {"name": "MuTect Stats"}, {"name": "Strelka Passed INDELs VC Summary Metrics"}, {"name": "Strelka Passed SNVs VC Summary Metrics"}, {"name": "Strelka Passed SNVs", "encodingFormat": "application/x-vcf"}, {"name": "Strelka Passed INDELs", "encodingFormat": "application/x-vcf"}, {"name": "Strelka All SNVs", "encodingFormat": "application/x-vcf"}, {"name": "Strelka All INDELs", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected Strelka Passed SNVs", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected Strelka Passed INDELs", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected Strelka All SNVs", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected Strelka All INDELs", "encodingFormat": "application/x-vcf"}, {"name": "BED Intersected Strelka Passed INDELs VC Summary Metrics"}, {"name": "BED Intersected Strelka Passed SNVs VC Summary Metrics"}, {"name": "Strelka Passed SNVs MAF"}, {"name": "Strelka Passed INDELs MAF"}, {"name": "BED Intersected Strelka Passed SNVs MAF"}, {"name": "BED Intersected Strelka Passed INDELs MAF"}, {"name": "BED Intersected MuTect VC Summary Metrics"}], "applicationSuite": "BMS pipelinesversion:", "applicationSubCategory": ["Variant-Calling"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "bristol-myers-squibb-publishin/bms.publish", "sbg:modifiedOn": 1568133459, "sbg:revisionNotes": null}, {"sbg:revision": 1, "sbg:modifiedBy": "bristol-myers-squibb-publishin/bms.publish", "sbg:modifiedOn": 1568133476, "sbg:revisionNotes": "Initial revision"}, {"sbg:revision": 2, "sbg:modifiedBy": "bristol-myers-squibb-publishin/bms.publish", "sbg:modifiedOn": 1569422246, "sbg:revisionNotes": "Secondary file requirement issue fixed"}], "creator": "BMS/SBG", "dateModified": 1569422246, "dateCreated": 1568133459, "contributor": ["bristol-myers-squibb-publishin/bms.publish"], "sdPublisher": "BMS", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_admin/sbg-public-data/broad-best-practices-rna-seq-variant-calling-4-1-0-0/8", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/admin/sbg-public-data/broad-best-practices-rna-seq-variant-calling-4-1-0-0/8", "applicationCategory": "Workflow", "version": "v1.0", "name": "BROAD Best Practices RNA-Seq Variant Calling 4.1.0.0", "description": "This workflow represents the GATK Best Practices for SNP and INDEL calling on RNA-Seq data. \n\nStarting from an unmapped BAM file, it performs alignment to the reference genome, followed by marking duplicates, reassigning mapping qualities, base recalibration, variant calling and variant filtering. On the [GATK website](https://software.broadinstitute.org/gatk/documentation/article.php?id=3891), you can find more detailed information about calling variants in RNA-Seq.\n\n###Common Use Cases\n- If you have raw sequencing reads in FASTQ format, you should convert them to an unmapped BAM file using the **Picard FastqToSam** app before running the workflow.\n- **BaseRecalibrator** uses **Known indels** and **Known SNPs** databases to mask out polymorphic sites when creating a model for adjusting quality scores. Also, the **HaplotypeCaller** uses the **Known SNPs** database to populate the ID column of the VCF output.\n- The **HaplotypeCaller** app uses **Intervals list** to restrict processing to specific genomic intervals. You can set the **Scatter count** value in order to split **Intervals list** into smaller intervals. **HaplotypeCaller** processes these intervals in parallel, which will significantly reduce workflow execution time  in some cases.\n- You can provide a pre-generated **STAR** reference index file or a genome reference file to the **Reference or STAR index** input.\n- **Running a batch task**: Batching is performed by **Sample ID** metadata field on the **Unmapped BAM** input port. For running analyses in batches, it is necessary to set **Sample ID** metadata for each unmapped BAM file.\n\n\n###Changes Introduced by Seven Bridges\nThis workflow represents the GATK Best Practices for SNP and indel calling on RNA-Seq data, and there are no modifications to the original workflow.\n\n\n###Common Issues and Important Notes\n- As the *(--known-sites)* is the required option for GATK BaseRecalibrator tool, it is necessary to provide at least one database file to the **Known INDELs** or **Known SNPs** input port.\n- If you are providing pre-generated STAR reference index make sure it is created using the adequate version of STAR (check the STAR version in the original [WDL file](https://github.com/gatk-workflows/gatk3-4-rnaseq-germline-snps-indels/blob/master/rna-germline-variant-calling.wdl)).\n- When converting FASTQ files to an unmapped BAM file using **Picard FastqToSam**, it is required to set the **Platform** (`PLATFORM=`) parameter.\n- This workflow allows you to process one sample per task execution. If you are planning to process more than one sample, it is required to run multiple task executions in batch mode. More about batch analyses can be found [here](https://docs.sevenbridges.com/docs/about-batch-analyses).\n \n\n###Performance Benchmarking\nThe default memory and CPU requirements for each app in the workflow are the same as in the original [GATK Best Practices WDL](https://github.com/gatk-workflows/gatk3-4-rnaseq-germline-snps-indels/blob/master/rna-germline-variant-calling.wdl). You can change the default runtime requirements for **STAR GenomeGenerate** and **STAR Align** apps. \n\n| Experiment type |  Input size | Paired-end | # of reads | Read length | Duration |  AWS Instance Cost (spot) | AWS Instance Cost (on-demand) | \n|:--------------:|:------------:|:--------:|:-------:|:---------:|:----------:|:------:|:------:|\n|     RNA-Seq     |  1.3 GB |     Yes    |     16M     |     101     |   2h44min   | 0.79$ | 1.79$ | \n|     RNA-Seq     |  3.9 GB |     Yes    |     50M     |     101     |   4h38min   | 1.29$ | 2.71$ | \n|     RNA-Seq     | 6.5 GB |     Yes    |     82M    |     101     |  6h44min  | 1.85$ | 3.84$ | \n|     RNA-Seq     | 12.9 GB |     Yes    |     164M    |     101     |  12h4min  | 3.30$ | 6.99$ |\n\n\n###API Python Implementation\nThe workflow's draft task can also be submitted via the API. To learn how to get your Authentication token and API endpoint for the corresponding platform, visit our [documentation](https://github.com/sbg/sevenbridges-python#authentication-and-configuration).\n```python\nfrom sevenbridges import Api\n\nauthentication_token, api_endpoint = \"enter_your_token\", \"enter_api_endpoint\"\napi = Api(token=authentication_token, url=api_endpoint)\n# Get project_id/workflow_id from your address bar. Example: https://igor.sbgenomics.com/u/your_username/project/workflow\nproject_id = \"your_username/project\"\nworkflow_id = \"your_username/project/workflow\"\n# Get file names from files in your project.\ninputs = {\n        \"input\": api.files.query(project=project_id, names=['Homo_sapiens_assembly19_1000genomes_decoy.whole_genome.interval_list']),\n        \"in_alignments\": api.files.query(project=project_id, names=['G26234.HCC1187_1Mreads.bam'])[0],\n        \"in_reference\": api.files.query(project=project_id, names=['Homo_sapiens_assembly19_1000genomes_decoy.fasta'])[0],\n        \"in_gene_annotation\": api.files.query(project=project_id, names=['star.gencode.v19.transcripts.patched_contigs.gtf'])[0],\n        \"in_reference_or_index\": api.files.query(project=project_id, names=['Homo_sapiens_assembly19_1000genomes_decoy.star.gencode.v19.transcripts.patched_contigs.star-2.5.3a_modified-index-archive.tar'])[0],\n        \"known_indels\": api.files.query(project=project_id, names=['Mills_and_1000G_gold_standard.indels.b37.sites.vcf',\n                                                                   'Homo_sapiens_assembly19_1000genomes_decoy.known_indels.vcf']),\n        \"known_snps\": api.files.query(project=project_id, names=['Homo_sapiens_assembly19_1000genomes_decoy.dbsnp138.vcf']),\n}\n\ntask = api.tasks.create(name='GATK4 RNA-Seq Workflow - API Example', project=project_id, app=workflow_id, inputs=inputs, run=False)\n#For running a batch task\ntask = api.tasks.create(name='GATK4 RNA-Seq Workflow - API Batch Example', project=project_id, app=workflow_id, inputs=inputs, run=False, batch_input='in_alignments', batch_by = { 'type': 'CRITERIA', 'criteria': [ 'metadata.sample_id'] })\n```\n\nInstructions for installing and configuring the API Python client are provided on GitHub. For more information about using the API Python client, consult [sevenbridges-python documentation](http://sevenbridges-python.readthedocs.io/en/latest/). More examples are available [here](https://github.com/sbg/okAPI).\n\nAdditionally, [API R](https://github.com/sbg/sevenbridges-r) and [API Java](https://github.com/sbg/sevenbridges-java) clients are available. To learn more about using these API clients please refer to the [API R client documentation](https://sbg.github.io/sevenbridges-r/), and [API Java client documentation](https://docs.sevenbridges.com/docs/java-library-quickstart).", "input": [{"name": "Unmapped BAM", "encodingFormat": "application/x-sam"}, {"name": "Reference", "encodingFormat": "application/x-fasta"}, {"name": "Known INDELs", "encodingFormat": "application/x-vcf"}, {"name": "Known SNPs", "encodingFormat": "application/x-vcf"}, {"name": "Interval list", "encodingFormat": "application/x-vcf"}, {"name": "Reference or STAR index", "encodingFormat": "application/x-fasta"}, {"name": "Gene annotation", "encodingFormat": "application/x-gtf"}, {"name": "Number of threads"}, {"name": "Memory per job"}, {"name": "Read length"}, {"name": "Number of threads"}, {"name": "Max number of collapsed junctions"}, {"name": "Memory per job"}], "original_input": [{"type": "File", "label": "Unmapped BAM", "sbg:fileTypes": "SAM, BAM, CRAM", "id": "in_alignments", "sbg:x": -1237, "doc": "Unmapped BAM file.", "sbg:y": -463}, {"type": "File", "secondaryFiles": [".fai", "^.dict"], "label": "Reference", "sbg:fileTypes": "FASTA, FA", "id": "in_reference", "sbg:x": -178.14291381835938, "doc": "Genome reference.", "sbg:y": 389.0186462402344}, {"type": "File[]?", "secondaryFiles": [".idx"], "label": "Known INDELs", "sbg:fileTypes": "VCF", "id": "known_indels", "sbg:x": 729.8524169921875, "doc": "Known INDELs.", "sbg:y": -223.1912841796875}, {"type": "File?", "secondaryFiles": [".idx"], "label": "Known SNPs", "sbg:fileTypes": "VCF", "id": "known_snps", "sbg:x": 912.197509765625, "doc": "Known SNPs.", "sbg:y": -490.7837829589844}, {"type": "File[]", "label": "Interval list", "sbg:fileTypes": "VCF, INTERVAL_LIST", "id": "in_intervals", "sbg:x": 1423.5, "doc": "Interval list.", "sbg:y": -626.5}, {"type": "int?", "doc": "Scatter count.", "id": "scatter_count", "sbg:exposed": true}, {"type": "float?", "doc": "Standard minimum confidence threshold for calling.", "id": "standard_min_confidence_threshold_for_calling", "sbg:exposed": true}, {"type": "File", "label": "Reference or STAR index", "sbg:fileTypes": "FASTA, FA, FNA, TAR", "id": "in_reference_or_index", "sbg:x": -1079.9658203125, "doc": "Genome reference or STAR index file.", "sbg:y": 13}, {"type": "File?", "label": "Gene annotation", "sbg:fileTypes": "GTF, GFF, GFF2, GFF3", "id": "in_gene_annotation", "sbg:x": -1069.978271484375, "doc": "Gene annotation used by STAR.", "sbg:y": 136}, {"type": "int?", "label": "Number of threads", "id": "cpu_per_job", "sbg:x": -1066.9813232421875, "doc": "Number of threads.", "sbg:y": 261.99688720703125}, {"type": "int?", "label": "Memory per job", "id": "mem_per_job", "sbg:x": -1062.9844970703125, "doc": "Amount of RAM memory to be used per job.", "sbg:y": 386.9906921386719}, {"type": "int?", "label": "Read length", "id": "read_length", "sbg:x": -1087.95654296875, "doc": "Read length used by STAR.", "sbg:y": -111.00310516357422}, {"type": "int?", "label": "Number of threads", "id": "cpu_per_star_align", "sbg:x": -690, "doc": "Number of threads.", "sbg:y": 33.62785720825195}, {"type": "int?", "label": "Max number of collapsed junctions", "id": "limitOutSJcollapsed", "sbg:x": -795.79296875, "doc": "Max number of collapsed junctions.", "sbg:y": -92.24427032470703}, {"type": "int?", "label": "Memory per job", "id": "mem_per_star_align", "sbg:x": -918.782470703125, "doc": "Amount of RAM memory to be used per job.", "sbg:y": -189.21380615234375}], "output": [{"name": "Output recalibrated BAM/SAM/CRAM", "encodingFormat": "application/x-sam"}, {"name": "Output VCF", "encodingFormat": "application/x-vcf"}, {"name": "Output filtered VCF", "encodingFormat": "application/x-vcf"}], "schema:softwareRequirements": ["ScatterFeatureRequirement"], "thumbnailUrl": "https://igor.sbgenomics.com/ns/brood/images/admin/sbg-public-data/broad-best-practices-rna-seq-variant-calling-4-1-0-0/8.png", "codeRepository": ["https://github.com/broadinstitute/gatk/", "https://github.com/broadinstitute/gatk/releases/download/4.1.0.0/gatk-4.1.0.0.zip"], "applicationSubCategory": ["Transcriptomics", "Variant Calling"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1555083927, "sbg:revisionNotes": null}, {"sbg:revision": 1, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1555083927, "sbg:revisionNotes": ""}, {"sbg:revision": 2, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1555083928, "sbg:revisionNotes": "create image"}, {"sbg:revision": 3, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1555084289, "sbg:revisionNotes": "added CWL1.0 to categories"}, {"sbg:revision": 4, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1555085604, "sbg:revisionNotes": "added descriptions to app settings"}, {"sbg:revision": 5, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1555085604, "sbg:revisionNotes": "added description to Standard minimum confidence"}, {"sbg:revision": 6, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1555085604, "sbg:revisionNotes": "changed id for variant output file"}, {"sbg:revision": 7, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1561655978, "sbg:revisionNotes": "SamToFastq output glob error fix to support single end files"}, {"sbg:revision": 8, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1571417180, "sbg:revisionNotes": "STAR aling back to revision 2 Added input port descriptions Updated BaseRecalibrator to handle empty list Added note for BaseRecalibrator --known-sites options in description Added output descriptions Changed output ids"}], "creator": "Broad Institute", "dateModified": 1571417180, "dateCreated": 1555083927, "contributor": ["admin"], "sdPublisher": "sbg", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_admin/sbg-public-data/broad-best-practices-somatic-cnv-pair-workflow-4-1-0-0/7", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/admin/sbg-public-data/broad-best-practices-somatic-cnv-pair-workflow-4-1-0-0/7", "applicationCategory": "Workflow", "version": "v1.0", "name": "BROAD Best Practices Somatic CNV Pair Workflow 4.1.0.0", "description": "BROAD Best Practices Somatic CNV Pair is used for detecting copy number variants (CNVs) in a single sample.\n\n### Common Use Cases\n\nThe workflow denoises case sample alignment data against a panel of normals (PON), created by **GATK CNV Panel Workflow**, to obtain copy ratios and models segments from the copy ratios and allelic counts. The latter modeling incorporates data from a matched control sample. The same workflow steps apply to targeted exome and whole genome sequencing data [1].\n\nThe basis of copy number variant detection is formed by collecting coverage counts, while the resolution of the analysis is defined by the genomic intervals list. In the case of whole genome data, the reference genome is divided into equally sized intervals or bins, while for exome data, the target regions of the capture kit should be padded. In either case the **PreprocessIntervals** tool is used for preparing the intervals list which is then used for collecting the raw integer counts. For this step,**CollectReadCounts** is utilized, which counts reads that overlap the interval. Read counts are standardized and denoised against the PON with the **DenoiseReadCounts** tool. Standardized and denoised copy ratios are plotted using the **PlotDenoisedCopyRatios** tool [2].\n\nNext step in the workflow is segmentation, performed by the **ModelSegments** tool [3]. In segmentation, contiguous copy ratios are grouped together into segments. The tool performs segmentation for both copy ratios and for allelic copy ratios, given allelic counts. **CollectAllelicCounts** will tabulate counts of the reference allele and counts of the dominant alternate allele for each site in a given genomic intervals list (**Common sites**). Modeled copy ratio and allelic fraction segments are plotted using the **PlotModeledSegments** tool.\n\nThe **CallCopyRatioSegments** tool allows for systematic calling of copy-neutral, amplified and deleted segments. The **Neutral segment copy ratio lower bound** (default 0.9) and **Neutral segment copy ratio upper bound** (default 1.1) parameters together set the copy ratio range for copy-neutral segments [4].\n\nSome of the common input parameters are listed below:\n* **Input reads - tumor** - Tumor BAM/SAM/CRAM file. In case of BAM and CRAM formats BAI and CRAI index files are required.\n* **Input reads - normal** - Matched normal BAM/SAM/CRAM file. In case of BAM and CRAM formats BAI and CRAI index files are required.\n* **Panel of normals** - CNV panel of normals (PON) file in HDF5 format.\n* **Reference** - Reference genome in FASTA format along with FAI and DICT secondary files.\n* **Intervals** - Required for both WGS and WES cases. Accepted formats must be compatible with the GATK `-L` argument. For WGS, the intervals should simply cover the autosomal chromosomes (sex chromosomes may be included, but care should be taken to avoid creating panels of mixed sex, and to denoise case samples only with panels containing only individuals of the same sex as the case samples) [5].\n* **Bin length** - This argument is used by the **PreprocessIntervals** tool and must be set to the same value that was used to create the PON file. If intervals in PON do not exactly match the ones used to collect read counts for case sample, the workflow will produce an error. For WES analysis, this parameter should be set to 0.\n* **Common sites** - Sites at which allelic counts will be collected, used in the **CollectAllelicCounts** tool. The file must be compatible with the GATK -L argument. This is usually a dbsnp VCF or Mills gold standard (SNPs only) VCF file. In case of WES analysis, we advise using subset of this file with variants contained in target intervals. This would reduce execution time of **CollectAllelicCounts** tool and would require less resources (see *Common Issues and Important Notes*).\n\n### Changes Introduced by Seven Bridges\n* Outputs of several tools in the workflow are grouped together using the **SBG Group Outputs** tool. This does not affect the contents of the files nor execution performance, it is introduced with the purpose of keeping output files neatly organized.\n\n### Common Issues and Important Notes\n* For WGS and some cases of WES samples **CollectAllelicCounts** will require more memory than the default 13000 MB. If the entire set of variants from dbsnp is used as input for this tool, we advise allocating at least 100000 MB (100GB) of memory through the **Memory per job** parameter.\n* For WGS analysis, **ModelSegments** may require more memory than the default 13000 MB. We advise allocating at least 32000 MB (32GB) of memory through the **Memory per job** parameter.\n* This workflow is set to run on two instances in parallel to reduce execution time. This is achieved through the `sbg:maxNumberOfParallelInstances` instance hint. \n\n### Performance Benchmarking\n| Input Size | Experimental Strategy | Coverage | Duration | Cost (on demand) |\n| --- | --- | --- | --- | --- | --- |\n| 2 x 45GB | WGS | 8x | 1h 34min | $3.27 | \n| 2 x 120GB | WGS | 25x | 3h 23min | $7.08 |\n| 2 x 210GB | WGS | 40x | 4h 57min | $10.56 |\n| 2 x 420GB | WGS | 80x | 8h 58min | $19.96 |\n\n\n### API Python Implementation\nThe app's draft task can also be submitted via the **API**. In order to learn how to get your **Authentication token** and **API endpoint** for corresponding platform visit our [documentation](https://github.com/sbg/sevenbridges-python#authentication-and-configuration).\n\n```python\n# Initialize the SBG Python API\nfrom sevenbridges import Api\napi = Api(token=\"enter_your_token\", url=\"enter_api_endpoint\")\n# Get project_id/app_id from your address bar. Example: https://igor.sbgenomics.com/u/your_username/project/app\nproject_id = \"your_username/project\"\napp_id = \"your_username/project/app\"\n# Replace inputs with appropriate values\ninputs = {\n\t\"intervals\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"reference\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"sequence_dictionary\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"input_alignments_tumor\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"common_sites\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"count_panel_of_normals\": api.files.query(project=project_id, names=[\"enter_filename\"])[0]}\n# Creates draft task\ntask = api.tasks.create(name=\"GATK CNV Somatic Pair Workflow - API Run\", project=project_id, app=app_id, inputs=inputs, run=False)\n```\n\nInstructions for installing and configuring the API Python client, are provided on [github](https://github.com/sbg/sevenbridges-python#installation). For more information about using the API Python client, consult [the client documentation](http://sevenbridges-python.readthedocs.io/en/latest/). **More examples** are available [here](https://github.com/sbg/okAPI).\n\nAdditionally, [API R](https://github.com/sbg/sevenbridges-r) and [API Java](https://github.com/sbg/sevenbridges-java) clients are available. To learn more about using these API clients please refer to the [API R client documentation](https://sbg.github.io/sevenbridges-r/), and [API Java client documentation](https://docs.sevenbridges.com/docs/java-library-quickstart).\n\n\n### References\n* [1] [https://github.com/gatk-workflows/gatk4-somatic-cnvs/blob/master/cnv_somatic_pair_workflow.wdl](https://github.com/gatk-workflows/gatk4-somatic-cnvs/blob/master/cnv_somatic_pair_workflow.wdl)\n* [2] [https://gatkforums.broadinstitute.org/dsde/discussion/11682](https://gatkforums.broadinstitute.org/dsde/discussion/11682)\n* [3] [https://gatkforums.broadinstitute.org/dsde/discussion/11683#6](https://gatkforums.broadinstitute.org/dsde/discussion/11683#6)\n* [4] [https://gatkforums.broadinstitute.org/dsde/discussion/11683#6](https://gatkforums.broadinstitute.org/dsde/discussion/11683#6)\n* [5] [https://gatkforums.broadinstitute.org/gatk/discussion/11009/intervals-and-interval-lists](https://gatkforums.broadinstitute.org/gatk/discussion/11009/intervals-and-interval-lists)", "input": [{"name": "Sequence dictionary"}, {"name": "Intervals", "encodingFormat": "application/x-vcf"}, {"name": "Reference", "encodingFormat": "application/x-fasta"}, {"name": "Blacklisted intervals", "encodingFormat": "application/x-vcf"}, {"name": "Input reads - tumor", "encodingFormat": "application/x-sam"}, {"name": "Collect counts format"}, {"name": "Input reads - normal", "encodingFormat": "application/x-sam"}, {"name": "Common sites", "encodingFormat": "application/x-vcf"}, {"name": "Memory CollectAllelicCounts"}, {"name": "Minimum base quality"}, {"name": "Number of eigensamples"}, {"name": "Panel of normals"}, {"name": "Window size"}, {"name": "Smoothing credible interval threshold copy ratio"}, {"name": "Smoothing credible interval threshold allele fraction"}, {"name": "Number of smoothing iterations per fit"}, {"name": "Number of samples copy ratio"}, {"name": "Number of samples allele fraction"}, {"name": "Number of changepoints penalty factor"}, {"name": "Number of burn in samples copy ratio"}, {"name": "Number of burn in samples allele fraction"}, {"name": "Minor allele fraction prior alpha"}, {"name": "Minimum total allele count normal"}, {"name": "Minimum total allele count case"}, {"name": "Memory ModelSegments"}, {"name": "Maximum number of smoothing iterations"}, {"name": "Maximum number of segments per chromosome"}, {"name": "Kernel variance copy ratio"}, {"name": "Kernel variance allele fraction"}, {"name": "Kernel scaling allele fraction"}, {"name": "Kernel approximation dimension"}, {"name": "Genotyping homozygous log ratio threshold"}, {"name": "Genotyping base error rate"}, {"name": "Outlier neutral segment copy ratio Z score threshold"}, {"name": "Neutral segment copy ratio upper bound"}, {"name": "Neutral segment copy ratio lower bound"}, {"name": "Calling copy ratio Z score threshold"}, {"name": "Minimum contig length"}, {"name": "Run Oncotator"}], "original_input": [{"id": "bin_length", "type": "int?", "sbg:exposed": true}, {"id": "padding", "type": "int?", "sbg:exposed": true}, {"id": "sequence_dictionary", "sbg:fileTypes": "DICT", "type": "File", "label": "Sequence dictionary", "doc": "Use the given sequence dictionary as the master/canonical sequence dictionary. Must be a .dict file.", "sbg:x": -534, "sbg:y": -223}, {"id": "intervals", "sbg:fileTypes": "INTERVALS, INTERVAL_LIST, BED, VCF, LIST", "type": "File", "label": "Intervals", "doc": "Genomic intervals over which to operate.", "sbg:suggestedValue": {"class": "File", "path": "5caf44e4c80cb0e410007adf", "name": "Homo_sapiens_assembly19_1000genomes_decoy.whole_genome.interval_list"}, "sbg:x": -536, "sbg:y": -79}, {"id": "in_reference", "sbg:fileTypes": "FASTA, FA", "type": "File", "label": "Reference", "doc": "Reference sequence file.", "sbg:suggestedValue": {"class": "File", "path": "5772b6c1507c1752674486c9", "name": "HG19_Broad_variant.fasta"}, "sbg:x": -534.4248046875, "sbg:y": 65.5}, {"id": "exclude_intervals", "sbg:fileTypes": "INTERVALS, INTERVAL_LIST, BED, VCF, LIST", "type": "File?", "label": "Blacklisted intervals", "doc": "One or more genomic intervals to exclude from processing.", "sbg:x": -534, "sbg:y": 213}, {"id": "in_alignments_tumor", "sbg:fileTypes": "BAM, SAM, CRAM", "type": "File", "label": "Input reads - tumor", "doc": "BAM/SAM/CRAM file containing reads This argument must be specified at least once.", "sbg:x": -235.84771728515625, "sbg:y": -554}, {"id": "collect_counts_format", "type": ["null", {"type": "enum", "symbols": ["TSV", "HDF5"], "name": "collect_counts_format"}], "label": "Collect counts format", "doc": "Output read counts file format.", "sbg:x": -237.84771728515625, "sbg:y": -302.3857727050781}, {"id": "in_alignments_normal", "sbg:fileTypes": "BAM, SAM, CRAM", "type": "File?", "label": "Input reads - normal", "doc": "BAM/SAM/CRAM file containing reads This argument must be specified at least once.", "sbg:x": -235.3096466064453, "sbg:y": -425.3857727050781}, {"id": "common_sites", "sbg:fileTypes": "VCF, BED, INTERVALS, INTERVAL_LIST", "type": "File", "label": "Common sites", "doc": "One or more genomic intervals over which to operate.", "sbg:suggestedValue": {"class": "File", "path": "5cb055a0c80cb0e46f143621", "name": "Homo_sapiens_assembly19_1000genomes_decoy.dbsnp138.vcf"}, "sbg:x": -247.34295654296875, "sbg:y": 403.34295654296875}, {"id": "memory_per_job_alleliccounts", "type": "int?", "label": "Memory CollectAllelicCounts", "doc": "Memory which will be allocated for execution. [Default: 13000]", "sbg:x": -244.07614135742188, "sbg:y": 272.5380554199219}, {"id": "minimum_base_quality", "type": "int?", "label": "Minimum base quality", "doc": "Base calls with lower quality will be filtered out of pileups.", "sbg:x": -243.53807067871094, "sbg:y": 148.46192932128906}, {"id": "number_of_eigensamples", "type": "int?", "label": "Number of eigensamples", "doc": "Number of eigensamples to use for denoising. If not specified or if the number of eigensamples available in the panel of normals is smaller than this, all eigensamples will be used.", "sbg:x": 188.82086181640625, "sbg:y": -687.2835693359375}, {"id": "count_panel_of_normals", "sbg:fileTypes": "HDF5", "type": "File", "label": "Panel of normals", "doc": "Input HDF5 file containing the panel of normals (produced by GATK CNV Somatic Panel Workflow).", "sbg:x": 190.77610778808594, "sbg:y": -812.2924194335938}, {"id": "window_size", "type": "int[]?", "label": "Window size", "doc": "Window sizes to use for calculating local changepoint costs. For each window size, the cost for each data point to be a changepoint will be calculated assuming that the point demarcates two adjacent segments of that size. Including small (large) window sizes will increase sensitivity to small (large) events. Duplicate values will be ignored.", "sbg:x": 735.3157958984375, "sbg:y": -133.5263214111328}, {"id": "smoothing_credible_interval_threshold_copy_ratio", "type": "float?", "label": "Smoothing credible interval threshold copy ratio", "doc": "Number of 10% equal-tailed credible-interval widths to use for copy-ratio segmentation smoothing. Default value: 2.0.", "sbg:x": 660.6398315429688, "sbg:y": -49.63985824584961}, {"id": "smoothing_credible_interval_threshold_allele_fraction", "type": "float?", "label": "Smoothing credible interval threshold allele fraction", "doc": "Number of 10% equal-tailed credible-interval widths to use for allele-fraction segmentation smoothing. Default value: 2.0.", "sbg:x": 604.26318359375, "sbg:y": 19.64912223815918}, {"id": "number_of_smoothing_iterations_per_fit", "type": "int?", "label": "Number of smoothing iterations per fit", "doc": "Number of segmentation-smoothing iterations per mcmc model refit. (increasing this will decrease runtime, but the final number of segments may be higher. Setting this to 0 will completely disable model refitting between iterations.).", "sbg:x": 548, "sbg:y": 104.22807312011719}, {"id": "number_of_samples_copy_ratio", "type": "int?", "label": "Number of samples copy ratio", "doc": "Total number of mcmc samples for copy-ratio model.", "sbg:x": 496.91229248046875, "sbg:y": 191.0877227783203}, {"id": "number_of_samples_allele_fraction", "type": "int?", "label": "Number of samples allele fraction", "doc": "Total number of mcmc samples for allele-fraction model.", "sbg:x": 442.4561462402344, "sbg:y": 284.6842346191406}, {"id": "number_of_changepoints_penalty_factor", "type": "float?", "label": "Number of changepoints penalty factor", "doc": "Factor A for the penalty on the number of changepoints per chromosome for segmentation. Adds a penalty of the form A * C * [1 + log (N / C)], where C is the number of changepoints in the chromosome, to the cost function for each chromosome. Must be non-negative.  Default value: 1.0.", "sbg:x": 388.1754455566406, "sbg:y": 387.91229248046875}, {"id": "number_of_burn_in_samples_copy_ratio", "type": "int?", "label": "Number of burn in samples copy ratio", "doc": "Number of burn-in samples to discard for copy-ratio model.", "sbg:x": 856.9122924804688, "sbg:y": -100.52631378173828}, {"id": "number_of_burn_in_samples_allele_fraction", "type": "int?", "label": "Number of burn in samples allele fraction", "doc": "Number of burn-in samples to discard for allele-fraction model.", "sbg:x": 796.4736938476562, "sbg:y": -18.912281036376953}, {"id": "minor_allele_fraction_prior_alpha", "type": "float?", "label": "Minor allele fraction prior alpha", "doc": "Alpha hyperparameter for the 4-parameter beta-distribution prior on segment minor-allele fraction. The prior for the minor-allele fraction f in each segment is assumed to be beta(alpha, 1, 0, 1/2). Increasing this hyperparameter will reduce the effect of reference bias at the expense of sensitivity. 0.", "sbg:x": 731.5087890625, "sbg:y": 73.98245239257812}, {"id": "minimum_total_allele_count_normal", "type": "int?", "label": "Minimum total allele count normal", "doc": "Minimum total count for filtering allelic counts in matched-normal sample, if available.", "sbg:x": 660.56787109375, "sbg:y": 174}, {"id": "minimum_total_allele_count_case", "type": "int?", "label": "Minimum total allele count case", "doc": "Minimum total count for filtering allelic counts in the case sample, if available. The default value of zero is appropriate for matched-normal mode; increase to an appropriate value for case-only mode. Default value: 0.", "sbg:x": 607.8271484375, "sbg:y": 261.91357421875}, {"id": "memory_per_job_modelsegments", "type": "int?", "label": "Memory ModelSegments", "doc": "Memory which will be allocated for execution. [Default: 13000].", "sbg:x": 555.1052856445312, "sbg:y": 339.2631530761719}, {"id": "maximum_number_of_smoothing_iterations", "type": "int?", "label": "Maximum number of smoothing iterations", "doc": "Maximum number of iterations allowed for segmentation smoothing.", "sbg:x": 507.631591796875, "sbg:y": 437.28070068359375}, {"id": "maximum_number_of_segments_per_chromosome", "type": "int?", "label": "Maximum number of segments per chromosome", "doc": "Maximum number of segments allowed per chromosome.", "sbg:x": 982.4736938476562, "sbg:y": -59.614036560058594}, {"id": "kernel_variance_copy_ratio", "type": "float?", "label": "Kernel variance copy ratio", "doc": "Variance of gaussian kernel for copy-ratio segmentation, if performed. If zero, a linear kernel will be used. 0.", "sbg:x": 930.5263061523438, "sbg:y": 28.807018280029297}, {"id": "kernel_variance_allele_fraction", "type": "float?", "label": "Kernel variance allele fraction", "doc": "Variance of gaussian kernel for allele-fraction segmentation, if performed. If zero, a linear kernel will be used. 025.", "sbg:x": 863.1754150390625, "sbg:y": 116.42105102539062}, {"id": "kernel_scaling_allele_fraction", "type": "float?", "label": "Kernel scaling allele fraction", "doc": "Relative scaling s of the kernel k_af for allele-fraction segmentation to the kernel k_cr for copy-ratio segmentation. If multidimensional segmentation is performed, the total kernel used will be k_cr.", "sbg:x": 800, "sbg:y": 205.5263214111328}, {"id": "kernel_approximation_dimension", "type": "int?", "label": "Kernel approximation dimension", "doc": "Dimension of the kernel approximation. A subsample containing this number of data points will be used to construct the approximation for each chromosome. If the total number of data points in a chromosome is greater than this number, then all data points in the chromosome will be used. Time complexity scales quadratically and space complexity scales linearly with this parameter.", "sbg:x": 740.9122924804688, "sbg:y": 292.96490478515625}, {"id": "genotyping_homozygous_log_ratio_threshold", "type": "float?", "label": "Genotyping homozygous log ratio threshold", "doc": "Log-ratio threshold for genotyping and filtering homozygous allelic counts, if available. Increasing this value will increase the number of sites assumed to be heterozygous for modeling. 0.", "sbg:x": 679.5789184570312, "sbg:y": 377.2280578613281}, {"id": "genotyping_base_error_rate", "type": "float?", "label": "Genotyping base error rate", "doc": "Maximum base-error rate for genotyping and filtering homozygous allelic counts, if available. The likelihood for an allelic count to be generated from a homozygous site will be integrated from zero base-error rate up to this value. Decreasing this value will increase the number of sites assumed to be heterozygous for modeling. 05.", "sbg:x": 620, "sbg:y": 475.9824523925781}, {"id": "outlier_neutral_segment_copy_ratio_z_score_threshold", "type": "float?", "label": "Outlier neutral segment copy ratio Z score threshold", "doc": "Threshold on z-score of non-log2 copy ratio used for determining outlier copy-neutral segments. If non-log2 copy ratio z-score is above this threshold for a copy-neutral segment, it is considered an outlier and not used in the calculation of the length-weighted mean and standard deviation used for calling.", "sbg:x": 2019.867919921875, "sbg:y": 88.93710327148438}, {"id": "neutral_segment_copy_ratio_upper_bound", "type": "float?", "label": "Neutral segment copy ratio upper bound", "doc": "Upper bound on non-log2 copy ratio used for determining copy-neutral segments. 1.1", "sbg:x": 2015.00634765625, "sbg:y": 214.50942993164062}, {"id": "neutral_segment_copy_ratio_lower_bound", "type": "float?", "label": "Neutral segment copy ratio lower bound", "doc": "Lower bound on non-log2 copy ratio used for determining copy-neutral segments. 0.9.", "sbg:x": 2018.7232666015625, "sbg:y": 333.2201232910156}, {"id": "calling_copy_ratio_z_score_threshold", "type": "float?", "label": "Calling copy ratio Z score threshold", "doc": "Threshold on z-score of non-log2 copy ratio used for calling segments.", "sbg:x": 2020.1510009765625, "sbg:y": 453.7924499511719}, {"id": "minimum_contig_length", "type": "int?", "label": "Minimum contig length", "doc": "Threshold length (in bp) for contigs to be plotted. Contigs with lengths less than this threshold will not be plotted. This can be used to filter out mitochondrial contigs, unlocalized contigs, etc.", "sbg:x": 756.6570434570312, "sbg:y": -859.0432739257812}, {"id": "additional_args", "type": "string?", "sbg:exposed": true}, {"id": "run_oncotator", "type": "boolean?", "label": "Run Oncotator", "doc": "Choose whether to annotate segments with Oncotator.", "sbg:x": 2471.34814453125, "sbg:y": -194.93515014648438}], "output": [{"name": "Tumor outputs", "encodingFormat": "text/plain"}, {"name": "Normal outputs", "encodingFormat": "text/plain"}, {"name": "Oncotator outputs", "encodingFormat": "text/plain"}, {"name": "Preprocessed Intervals"}, {"name": "Entity ID tumor"}, {"name": "Entity ID normal"}], "schema:softwareRequirements": ["MultipleInputFeatureRequirement", "InlineJavascriptRequirement", "StepInputExpressionRequirement"], "applicationSubCategory": ["Copy Number Analysis"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1555085893, "sbg:revisionNotes": null}, {"sbg:revision": 1, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1555085893, "sbg:revisionNotes": "initial revision"}, {"sbg:revision": 2, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563374871, "sbg:revisionNotes": ""}, {"sbg:revision": 3, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563374871, "sbg:revisionNotes": ""}, {"sbg:revision": 4, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1589906999, "sbg:revisionNotes": "Add secondary files to WF inputs"}, {"sbg:revision": 5, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1589906999, "sbg:revisionNotes": "Validated with cwltool"}, {"sbg:revision": 6, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1589906999, "sbg:revisionNotes": "Suggested files added."}, {"sbg:revision": 7, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1649156263, "sbg:revisionNotes": "update categories"}], "dateModified": 1649156263, "dateCreated": 1555085893, "contributor": ["admin"], "sdPublisher": "sbg", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_admin/sbg-public-data/broad-best-practices-somatic-cnv-panel-workflow-4-1-0-0/14", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/admin/sbg-public-data/broad-best-practices-somatic-cnv-panel-workflow-4-1-0-0/14", "applicationCategory": "Workflow", "version": "v1.0", "name": "BROAD Best Practices Somatic CNV Panel Workflow 4.1.0.0", "description": "BROAD Best Practices Somatic CNV Panel is used for creating a panel of normals (PON) given a set of normal samples.\n\n### Common Use Cases\n\nFor CNV discovery, the PON is created by running the initial coverage collection tools individually on a set of normal samples and combining the resulting copy ratio data using a dedicated PON creation tool [1]. This produces a binary file that can be used as a PON. It is very important to use normal samples that are as technically similar as possible to the tumor samples (same exome or genome preparation methods, sequencing technology etc.) [2].\n \nThe basis of copy number variant detection is formed by collecting coverage counts, while the resolution of the analysis is defined by the genomic intervals list. In the case of whole genome data, the reference genome is divided into equally sized intervals or bins, while for exome data, the target regions of the capture kit should be padded. In either case, the **PreprocessIntervals** tool is used for preparing the intervals list which is then used for collecting raw integer counts. For this step **CollectReadCounts** is utilized, which counts reads that overlap the interval. Finally a CNV panel of normals is generated using the **CreateReadCountPanelOfNormals** tool. \n\nIn creating a PON, **CreateReadCountPanelOfNormals** abstracts the counts data for the samples and the intervals using Singular Value Decomposition (SVD), a type of Principal Component Analysis. The normal samples in the PON should match the sequencing approach of the case sample under scrutiny. This applies especially to targeted exome data because the capture step introduces target-specific noise [3].\n\nSome of the common input parameters are listed below:\n*  **Input reads** (`--input`) - BAM/SAM/CRAM file containing reads. In the case of BAM and CRAM files, secondary BAI and CRAI index files are required.\n* **Intervals** (`--intervals`) - required for both WGS and WES cases. Formats must be compatible with the GATK `-L` argument. For WGS, the intervals should simply cover the autosomal chromosomes (sex chromosomes may be included, but care should be taken to avoid creating panels of mixed sex, and to denoise case samples only with panels containing only individuals of the same sex as the case samples)[4].\n* **Bin length** (`--bin-length`). This parameter is passed to the **PreprocessIntervals** tool. Read counts will be collected per bin and final PON file will contain information on read counts per bin. Thus, when calling CNVs in Tumor samples, **Bin length** parameter has to be set to the same value used when creating the PON file.\n* **Padding** (`--padding`). Also used in the **PreprocessIntervals** tool, defines number of base pairs to pad each bin on each side.\n* **Reference** (`--reference`) - Reference sequence file along with FAI and DICT files.\n* **Blacklisted Intervals** (`--exclude_intervals`) will be excluded from coverage collection and all downstream steps.\n* **Do Explicit GC Correction** - Annotate intervals with GC content using the **AnnotateIntervals** tool.\n\n### Changes Introduced by Seven Bridges\n*The workflow in its entirety is per [best practice](https://github.com/gatk-workflows/gatk4-somatic-cnvs/blob/master/cnv_somatic_panel_workflow.wdl) specification.* \n\n### Performance Benchmarking\n\n| Input Size | Experimental Strategy | Coverage | Duration | Cost (on demand) | AWS Instance Type |\n| --- | --- | --- | --- | --- | --- | --- |\n| 2 x 45GB | WGS | 8x | 33min | $0.59 | c4.4xlarge 2TB EBS |\n| 2 x 120GB | WGS | 25x | 1h 22min | $1.47 | c4.4xlarge 2TB EBS |\n| 2 x 210GB | WGS | 40x | 2h 19min | $2.48 | c4.4xlarge 2TB EBS |\n| 2 x 420GB | WGS | 80x | 4h 15min | $4.54 | c4.4xlarge 2TB EBS |\n\n### API Python Implementation\nThe app's draft task can also be submitted via the **API**. In order to learn how to get your **Authentication token** and **API endpoint** for corresponding platform visit our [documentation](https://github.com/sbg/sevenbridges-python#authentication-and-configuration).\n\n```python\n# Initialize the SBG Python API\nfrom sevenbridges import Api\napi = Api(token=\"enter_your_token\", url=\"enter_api_endpoint\")\n# Get project_id/app_id from your address bar. Example: https://igor.sbgenomics.com/u/your_username/project/app\nproject_id = \"your_username/project\"\napp_id = \"your_username/project/app\"\n# Replace inputs with appropriate values\ninputs = {\n\t\"sequence_dictionary\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"intervals\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"in_alignments\": list(api.files.query(project=project_id, names=[\"enter_filename\", \"enter_filename\"])), \n\t\"in_reference\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"output_prefix\": \"sevenbridges\"}\n# Creates draft task\ntask = api.tasks.create(name=\"GATK CNV Somatic Panel Workflow - API Run\", project=project_id, app=app_id, inputs=inputs, run=False)\n```\n\nInstructions for installing and configuring the API Python client, are provided on [github](https://github.com/sbg/sevenbridges-python#installation). For more information about using the API Python client, consult [the client documentation](http://sevenbridges-python.readthedocs.io/en/latest/). **More examples** are available [here](https://github.com/sbg/okAPI).\n\nAdditionally, [API R](https://github.com/sbg/sevenbridges-r) and [API Java](https://github.com/sbg/sevenbridges-java) clients are available. To learn more about using these API clients please refer to the [API R client documentation](https://sbg.github.io/sevenbridges-r/), and [API Java client documentation](https://docs.sevenbridges.com/docs/java-library-quickstart).\n\n### References\n* [1] [https://github.com/gatk-workflows/gatk4-somatic-cnvs](https://github.com/gatk-workflows/gatk4-somatic-cnvs)\n* [2] [https://gatkforums.broadinstitute.org/gatk/discussion/11053/panel-of-normals-pon](https://gatkforums.broadinstitute.org/gatk/discussion/11053/panel-of-normals-pon)\n* [3] [https://gatkforums.broadinstitute.org/dsde/discussion/11682](https://gatkforums.broadinstitute.org/dsde/discussion/11682)\n* [4] [https://gatkforums.broadinstitute.org/gatk/discussion/11009/intervals-and-interval-lists](https://gatkforums.broadinstitute.org/gatk/discussion/11009/intervals-and-interval-lists)", "input": [{"name": "Sequence dictionary"}, {"name": "Intervals", "encodingFormat": "application/x-vcf"}, {"name": "Reference", "encodingFormat": "application/x-fasta"}, {"name": "Blacklisted intervals", "encodingFormat": "application/x-vcf"}, {"name": "Mappability track"}, {"name": "Segmental duplication track"}, {"name": "Input reads", "encodingFormat": "application/x-sam"}, {"name": "PON entity id"}, {"name": "Do explicit GC correction"}], "original_input": [{"id": "bin_length", "type": "int?", "sbg:exposed": true}, {"id": "padding", "type": "int?", "sbg:exposed": true}, {"id": "sequence_dictionary", "sbg:fileTypes": "DICT", "type": "File", "label": "Sequence dictionary", "doc": "Use the given sequence dictionary as the master/canonical sequence dictionary. Must be a .dict file.", "sbg:x": -407.64971923828125, "sbg:y": -190}, {"id": "intervals", "sbg:fileTypes": "INTERVALS, INTERVAL_LIST, BED, VCF, LIST", "type": "File", "label": "Intervals", "doc": "Genomic intervals over which to operate.", "sbg:suggestedValue": {"class": "File", "path": "5caf44e4c80cb0e410007adf", "name": "Homo_sapiens_assembly19_1000genomes_decoy.whole_genome.interval_list"}, "sbg:x": -410.2372741699219, "sbg:y": -56.824859619140625}, {"id": "in_reference", "sbg:fileTypes": "FASTA, FA", "type": "File", "label": "Reference", "doc": "Reference sequence file.", "secondaryFiles": [".fai", "^.dict"], "sbg:suggestedValue": {"class": "File", "path": "5772b6c1507c1752674486c9", "name": "HG19_Broad_variant.fasta"}, "sbg:x": -410.7547607421875, "sbg:y": 77.04084777832031}, {"id": "exclude_intervals", "sbg:fileTypes": "INTERVALS, INTERVAL_LIST, BED, VCF, LIST", "type": "File?", "label": "Blacklisted intervals", "doc": "Genomic intervals to exclude from processing.", "sbg:x": -411.5247497558594, "sbg:y": 216.38613891601562}, {"id": "feature_query_lookahead", "type": "int?", "sbg:exposed": true}, {"id": "mappability_track", "sbg:fileTypes": "BED, BED.GZ", "type": "File?", "label": "Mappability track", "doc": "Umap single-read mappability track in .bed or .bed.gz format (see https://bismap.hoffmanlab.org/).", "secondaryFiles": [".idx"], "sbg:x": -116.23728942871094, "sbg:y": -284.6949157714844}, {"id": "segmental_duplication_track", "sbg:fileTypes": "BED, BED.GZ", "type": "File?", "label": "Segmental duplication track", "doc": "Segmental-duplication track in .bed or .bed.gz format", "secondaryFiles": [".idx"], "sbg:x": -116.97435760498047, "sbg:y": -412.5128173828125}, {"id": "in_alignments", "sbg:fileTypes": "BAM, SAM, CRAM", "type": "File[]", "label": "Input reads", "doc": "BAM/SAM/CRAM file containing reads This argument must be specified at least once.", "secondaryFiles": ["${ \n    return [self.basename+\".bai\", self.nameroot + \".bai\", self.basename+\".crai\", self.nameroot + \".crai\"]\n}"], "sbg:x": -118.76271057128906, "sbg:y": 218.88136291503906}, {"id": "output_format", "type": ["null", {"type": "enum", "symbols": ["TSV", "HDF5"], "name": "output_format"}], "sbg:exposed": true}, {"id": "do_impute_zeros", "type": ["null", {"type": "enum", "symbols": ["true", "false"], "name": "do_impute_zeros"}], "sbg:exposed": true}, {"id": "extreme_outlier_truncation_percentile", "type": "float?", "sbg:exposed": true}, {"id": "extreme_sample_median_percentile", "type": "float?", "sbg:exposed": true}, {"id": "maximum_chunk_size", "type": "int?", "sbg:exposed": true}, {"id": "maximum_zeros_in_interval_percentage", "type": "float?", "sbg:exposed": true}, {"id": "maximum_zeros_in_sample_percentage", "type": "float?", "sbg:exposed": true}, {"id": "minimum_interval_median_percentile", "type": "float?", "sbg:exposed": true}, {"id": "number_of_eigensamples", "type": "int?", "sbg:exposed": true}, {"id": "pon_entity_id", "type": "string", "label": "PON entity id", "doc": "PON entity id (output prefix) for the panel of normals.", "sbg:x": 219, "sbg:y": 349.2994384765625}, {"id": "do_explicit_gc_correction", "type": "boolean?", "label": "Do explicit GC correction", "doc": "Choose whether to annotate intervals with GC content.", "sbg:x": -114, "sbg:y": -146.5162353515625}], "output": [{"name": "Preprocessed Intervals"}, {"name": "Read counts"}, {"name": "Entity ID"}, {"name": "Panel of normals"}], "schema:softwareRequirements": ["ScatterFeatureRequirement", "InlineJavascriptRequirement", "StepInputExpressionRequirement"], "applicationSubCategory": ["Copy Number Analysis"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1555085892, "sbg:revisionNotes": null}, {"sbg:revision": 1, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1555085892, "sbg:revisionNotes": "initial revision"}, {"sbg:revision": 2, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1555085892, "sbg:revisionNotes": "add aws instance hint: c4.4xlarge;ebs-gp2;2000"}, {"sbg:revision": 3, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563374870, "sbg:revisionNotes": ""}, {"sbg:revision": 4, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563374870, "sbg:revisionNotes": "Add sbg:GoogleInstanceType=n1-standard-16;pd-ssd;2000 hint"}, {"sbg:revision": 5, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1589906997, "sbg:revisionNotes": "Add secondary files to WF inputs"}, {"sbg:revision": 6, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1589906998, "sbg:revisionNotes": "CWL Validation 1"}, {"sbg:revision": 7, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1589906998, "sbg:revisionNotes": "CWL Validation 2"}, {"sbg:revision": 8, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1589906999, "sbg:revisionNotes": "CWL Validation 3"}, {"sbg:revision": 9, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1589906999, "sbg:revisionNotes": "CWL Validated"}, {"sbg:revision": 10, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1589906999, "sbg:revisionNotes": "InlineJavascriptRequirement add"}, {"sbg:revision": 11, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1589906999, "sbg:revisionNotes": "Running - Value from added into steps"}, {"sbg:revision": 12, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1589906999, "sbg:revisionNotes": "Scatter method none for GATK PreprocessIntervals"}, {"sbg:revision": 13, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1589906999, "sbg:revisionNotes": "Suggested files added."}, {"sbg:revision": 14, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1649156262, "sbg:revisionNotes": "update categories"}], "dateModified": 1649156262, "dateCreated": 1555085892, "contributor": ["admin"], "sdPublisher": "sbg", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_lizhang/adk-resources/bwa-mem-multi-lane/9", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/lizhang/adk-resources/bwa-mem-multi-lane/9", "applicationCategory": "Workflow", "version": "sbg:draft-2", "name": "BWA MEM Multi-Lane", "description": "[Beta] BWA MEM workflow aligning and merging multiple pairs of FASTq files into single BAM output.\n\nThis workflow is used as part of the \"Sample QC\" automation example available on [GitHub](https://github.com/sbg/adk-examples/tree/master/examples/sample-qc). It takes multi-lane FASTQ files as input, uses BWA MEM to align reads to given reference genome, and then merges all per-lane BAM files into a single BAM file using \"Sambamba Merge\". Please note this workflow is still under development and not yet recommended for use in production pipelines.", "input": [{"name": "#FASTQ", "encodingFormat": "text/fastq"}, {"name": "Reference or TAR with BWA reference indices", "encodingFormat": "application/x-fasta"}], "original_input": [{"type": [{"type": "array", "items": "File"}], "label": "#FASTQ", "sbg:fileTypes": "FASTQ, FASTQ.GZ, FQ, FQ.GZ", "id": "#FASTQ", "sbg:includeInPorts": true, "sbg:x": 91.56859020002386, "sbg:y": 400.0001990000482}, {"type": ["File"], "label": "Reference or TAR with BWA reference indices", "sbg:fileTypes": "FASTA, FA, FA.GZ, FASTA.GZ, TAR", "id": "#Input_reference", "sbg:includeInPorts": true, "sbg:x": 312.12815479946755, "sbg:y": 102.33345933755729, "sbg:suggestedValue": {"class": "File", "name": "human_g1k_v37_decoy.fasta.tar", "path": "5772b6d9507c1752674486e7"}}], "output": [{"name": "merged_bam", "encodingFormat": "application/x-bam"}, {"name": "aligned_reads", "encodingFormat": "application/x-sam"}], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "lizhang", "sbg:modifiedOn": 1554149671, "sbg:revisionNotes": null}, {"sbg:revision": 1, "sbg:modifiedBy": "lizhang", "sbg:modifiedOn": 1554149700, "sbg:revisionNotes": "BWA MEM Multi-Lane workflow"}, {"sbg:revision": 2, "sbg:modifiedBy": "lizhang", "sbg:modifiedOn": 1554149842, "sbg:revisionNotes": "BWA MEM Multi-Lane v1.0"}, {"sbg:revision": 3, "sbg:modifiedBy": "lizhang", "sbg:modifiedOn": 1554150065, "sbg:revisionNotes": null}, {"sbg:revision": 4, "sbg:modifiedBy": "lizhang", "sbg:modifiedOn": 1554150230, "sbg:revisionNotes": null}, {"sbg:revision": 5, "sbg:modifiedBy": "lizhang", "sbg:modifiedOn": 1554151367, "sbg:revisionNotes": null}, {"sbg:revision": 6, "sbg:modifiedBy": "lizhang", "sbg:modifiedOn": 1554151749, "sbg:revisionNotes": null}, {"sbg:revision": 7, "sbg:modifiedBy": "lizhang", "sbg:modifiedOn": 1554152084, "sbg:revisionNotes": "BWA MEM Multi-Lane workflow"}, {"sbg:revision": 8, "sbg:modifiedBy": "lizhang", "sbg:modifiedOn": 1554227516, "sbg:revisionNotes": "Updated workflow with updated public apps components"}, {"sbg:revision": 9, "sbg:modifiedBy": "christian_frech", "sbg:modifiedOn": 1597679589, "sbg:revisionNotes": "changed instance type to c5.4xlarge"}], "creator": "Seven Bridges", "dateModified": 1597679589, "dateCreated": 1554149671, "contributor": ["christian_frech", "lizhang"], "sdPublisher": "ADKDEMO", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_admin/sbg-public-data/chip-seq-bwa-alignment-and-peak-calling-macs2/21", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/admin/sbg-public-data/chip-seq-bwa-alignment-and-peak-calling-macs2/21", "applicationCategory": "Workflow", "version": "sbg:draft-2", "name": "ChIP-seq BWA Alignment and Peak Calling MACS2 2.1.1", "description": "ChIP-seq (Chromatin immunoprecipitation followed by high-throughput sequencing technology) allows researchers to study the landscape of chromatin modifications or the binding patterns of transcription factors and other chromatin-associated proteins like RNA-polymerases.\n\nThis pipeline takes you all the way from unaligned raw sequencing reads (FASTQ) to ChIP-seq peak detection.\n\nSequenced reads are aligned with the BWA-backtrack (preferably for short reads). After alignment, BAM files are filtered (to remove low quality and unpaired reads) and de-duplicated. A number of QC metrics that evaluate the library complexity and signal enrichment are calculated. Peak calling is performed on the processed BAM files using MACS2 peak caller.\n\nRequired inputs:\n\n* Treatment FASTQ files (ID: treatment_files) - one FASTQ file for single-end data, or two files for paired-end data. NOTE: For paired-end reads, it is crucial to set the metadata **Paired-end** field as 1 for one input file and as 2 for the other input file.\n\n* Reference/Index files (ID: reference_index_tar) - TAR bundle of already generated BWA index files.\n\nOptional inputs:\n\n* Control FASTQ files (ID: control_files) - one FASTQ file for single-end data, or two files per for paired-end data. NOTE: For paired-end reads, it is crucial to set the metadata **Paired-end** field as 1 for one input file and as 2 for the other input file.\n\n* Blacklist file (ID: blacklist_file) - BED file containing genomic regions that have anomalous, unstructured, high signal/read counts in next-generation sequencing experiments. It could be used by BEDTools intersect to increase the accuracy of peak calling and downstream ChIP-seq analysis.\n\n###**Common Use Cases**\nBefore executing the workflow you should choose between narrow and broad peak analysis by setting the **Analysis type** parameter and organism to calculate effective genome size by setting **Organism** parameter within MACS2 app in Define App Settings. \n \nBlacklisting:\n\nWhen provided with adequate blacklist BED file, BEDTools intersect within this pipeline, will remove blacklisted regions from MACS2 *narrowPeak/broadPeak* output file. The exclusion of these regions, called blacklist regions, aims to remove sources of artifact signal caused by biases from chromatin accessibility and ambiguous alignment to increase the accuracy of both peak calling and downstream ChIP-seq analysis.\n\n###**Changes Introduced by Seven Bridges**\n\n* MACS2 **Analysis type** parameter is used for choosing between narrow and broad peak analysis. If narrow peak is selected, **QVALUE** (`--qvalue`) parameter will be set to 0.01. If broad peak is selected, **BROAD** (`--broad`) parameter will be set to True and **QVALUE** (`--qvalue`) parameter to 0.05. \n\n* MACS2 uses the estimated fragment length to extend reads in 5'->3' direction to fix-sized fragments. By default, the fragment length is estimated by MACS2 during the model building step. However, for this specific workflow (following ENCODE pipeline), the predominant fragment length is estimated in a previous step (*JSON output; from 'SBG ChIP-seq filter and QC') and used as an input via the parameter **EXTSIZE** (`--extsize`). The parameter **NOMODEL** (`--nomodel`) is also set to force MACS2 to bypass the building of the shifting model.\n\n* **KEEP_DUPS** (`--keep-dup`) parameter is set to 'all' to prevent MACS2 from searching for duplicated reads because we expect the input BAM files to be de-duplicated. If this is not the case, this parameter should be set to the default option '1' which is to keep one tag at the same location.\n\n* **spmr** (`--SPMR`) and **BDG** (`--bdg`) parameters are set to True to perform normalization per million reads for fragment pileup and save extended fragment pileup, and local lambda tracks into a bedGraph file.\n\n###**Common Issues and Important Notes**\n\n* **When providing treatment and control files to the input, a \"Case ID\" and \"Sample ID\" metadata should be properly set for each file. PE files should have the same \"Sample ID\" and \"Case ID\". Treatment FASTQ files (PE or SE) should have the same \"Case ID\" as corresponding control FASTQ files.**\n\n* In some situations read trimming is necessary, for instance, if read ends display poor quality values (most generally the right end) or if treatment and control FASTQ files have inconsistent read lengths. In these cases, read-trimming should be applied.\n\n*  Preferred values for library complexity are NRF > 0.9, PBC1 \u2265 0.9, and PBC2 \u2265 10.\n\n* Preferred values for NSC and RSC metric when analysing sharp histone marks are: NSC > 1.05 and RSC > 0.8 (Even if ChIP-seq data does not meet these guidelines, there could still be significant biological information. The users should evaluate the profiles of the cross-correlation plot to further assess the quality of their data).\n\n* Input (control) and negative control samples should have low NSC and RSC scores.\n\n* SBG ChIP-seq Set Metadata tool adds values 'control' and 'sample' to the metadata field **chip-seq** of the input files.\n\n* Along with suggested input files for Human genome, Mus musculus Reference/index TAR file and Blacklist file could be obtained from Public Reference Files.\n\n* If the total size of input FASTQ files in a single task exceeds 20GB a larger AWS instance should be allocated due to memory requirements.\n\n* In cases when analysing two biological replicates, outputs between replicates should be compared using IDR app. IDR is publicly available app which could be used to combine outputs of ChIP-seq pipeline to perform the comparative analysis between biological replicates in the separate task.\n\n* This workflow might not work with filenames containing some special characters e.g. **#**, **~**.\n\n###**Performance Benchmarking**\n\nThe  run time and cost strongly depend on the input file sizes and available resources. Based on our testing, BWA Aligment and Filtering tool has increasing demand for RAM memory with the increase of sequencing reads within FASTQ input files. We set c4.4xlarge AWS instance with 30GB of RAM as a default instance but in some cases where more memory is requred our suggestion is using c4.8xlarge AWS instance. Here are some examples of run times and costs for tasks running on AWS spot instances:\n\n|Input FASTQ file size|AWS Instance| Duration | Cost |\n| --- | --- | --- | --- |\n| 3.4 GB (SE, fastq.gz, treatment)  | c4.4xlarge | 1h27m | $0.49 |\n| 3.4 GB + 410.4 MB (SE, fastq.gz, treatment + control) | c4.4xlarge | 1h36m | $0.54 |\n| 6 GB + 6.4 GB (PE, fastq.gz, treatment) | c4.4xlarge | 6h50m | $2.31 |\n| 6 GB + 6.4 GB + 3.4 GB + 3.7 GB  (PE, fastq.gz, treatment + control) | c4.4xlarge | 9h51m | $3.33 |\n| 3.4 GB (SE, fastq.gz, treatment)  | c4.8xlarge | 1h24m | $0.83 |\n| 3.4 GB + 410.4 MB (SE, fastq.gz, treatment + control) | c4.8xlarge | 1h23m | $0.83 |\n| 6 GB + 6.4 GB (PE, fastq.gz, treatment) | c4.8xlarge | 6h15m | $3.73 |\n| 6 GB + 6.4 GB + 3.4 GB + 3.7 GB  (PE, fastq.gz, treatment + control) | c4.8xlarge | 6h41m | $3.98 |\n\n###**API Python Implementation**\n\nThe workflow's draft task can also be submitted via the API. To learn how to get your Authentication token and API endpoint for corresponding platform visit our [documentation](https://github.com/sbg/sevenbridges-python#authentication-and-configuration).\n```python\nfrom sevenbridges import Api\n\nauthentication_token, api_endpoint = \"enter_your_token\", \"enter_api_endpoint\"\napi = Api(token=authentication_token, url=api_endpoint)\n# Get project_id/workflow_id from your address bar. Example: https://igor.sbgenomics.com/u/your_username/project/workflow\nproject_id, workflow_id = \"your_username/project\", \"your_username/project/workflow\"\n# Get file names from files in your project.\ninputs = {\n    'reference_index_tar': api.files.query(project=project_id, names=reference_index_tar_file)[0],\n    'treatment_files': list(api.files.query(project=project_id, names=treatment_files)),\n    'control_files': list(api.files.query(project=project_id, names=control_files)),\n    'blacklist_file': api.files.query(project=project_id, names=blacklist_file)[0],\n    'analysis_type' : \"narrow peaks\",\n    'Organism' : \"hs\" \n    }\ntask = api.tasks.create(name='ChIP-seq BWA Alignment and Peak Calling MACS2 - API Example', project=project_id, app=workflow_id, inputs=inputs, run=False)\n\n#For running a batch task\ntask = api.tasks.create(name='ChIP-seq BWA Alignment and Peak Calling MACS2 - API Example', project=project_id, app=workflow_id, inputs=inputs, run=False, batch_input='treatment_files', batch_by = { 'type': 'CRITERIA', 'criteria': [ 'metadata.sample_id'] })\n```\nwhere `reference_index_tar`, `treatment_files`, `control_files` and `blacklist_file` are list objects containing the input files. \n\nInstructions for installing and configuring the API Python client, are provided on GitHub. For more information about using the API Python client, consult [sevenbridges-python documentation](http://sevenbridges-python.readthedocs.io/en/latest/). More examples are available [here](https://github.com/sbg/okAPI).\n\nAdditionally, [API R](https://github.com/sbg/sevenbridges-r) and [API Java](https://github.com/sbg/sevenbridges-java) clients are available. To learn more about using these API clients please refer to the [API R client documentation](https://sbg.github.io/sevenbridges-r/), and [API Java client documentation](https://docs.sevenbridges.com/docs/java-library-quickstart).\n\n**Running a batch task:**\nBatching is performed by **Sample ID** metadata on the treatment_files port. For running analysis in batches it is necessary to set **Sample ID** metadata for each file and for paired-end data both files must have the same **Sample ID**.", "input": [{"name": "control_files"}, {"name": "reference_index_tar", "encodingFormat": "application/x-tar"}, {"name": "blacklist_file", "encodingFormat": "application/x-bam"}, {"name": "treatment_files", "encodingFormat": "text/fastq"}, {"name": "If True, MACS will save signal per million  reads for fragment pileup profiles"}, {"name": "Buffer size"}, {"name": "Band width for picking regions to compute fragment size"}, {"name": "Analysis type"}, {"name": "When set, scale the small sample up to the bigger sample"}, {"name": "Tag Size"}, {"name": "The small nearby region in basepairs to calculate dynamic lambda"}, {"name": "(NOT the legacy --shiftsize option!) The arbitrary shift in bp"}, {"name": "Set the random seed while down sampling data"}, {"name": "When set, use a custom scaling ratio of ChIP/control (e.g. calculated using NCIS) for linear scaling"}, {"name": "Minimum FDR (q-value) cutoff for peak detection"}, {"name": "Pvalue cutoff for peak detection"}, {"name": "Name of organism to calculate effective genome size. 'hs' for human (2.7e9), 'mm' for mouse   (1.87e9), 'ce' for C. elegans (9e7) and 'dm' for fruitfly (1.2e8)"}, {"name": "If True, MACS will use fixed background lambda as local lambda for every peak region"}, {"name": "Whether or not to build the shifting model"}, {"name": "Select the regions within MFOLD range of high-confidence enrichment ratio against background to build model"}, {"name": "The large nearby region in basepairs to calculate dynamic lambda"}, {"name": "Keep duplicates"}, {"name": "Whether turn on the auto pair model process"}, {"name": "When set, the value will be used to filter out peaks with low fold-enrichment"}, {"name": "Experiment name which will be used to name the output files"}, {"name": "When set, random sampling method will scale down the bigger sample"}, {"name": "While set, MACS2 will analyze number or total length of peaks that can be called by different p-value cutoff then output a summary table to help user decide a better cutoff"}, {"name": "If set, MACS will use a more sophisticated signal processing approach to find subpeak summits in each enriched peak region"}, {"name": "Cutoff for broad region"}, {"name": "If set, MACS will try to call broad peaks by linking nearby highly enriched regions"}, {"name": "Save extended fragment pileup, and local lambda tracks into a bedgraph file."}, {"name": "Number of threads"}], "original_input": [{"type": ["null", {"type": "array", "items": "File"}], "label": "control_files", "id": "#control_files", "sbg:x": -53.60525096543294, "sbg:y": 398.44748447792267}, {"type": ["File"], "label": "reference_index_tar", "sbg:fileTypes": "TAR, TAR.GZ", "id": "#reference_index_tar", "sbg:x": 423.00003463692207, "sbg:includeInPorts": true, "sbg:y": 112.50002894136739, "sbg:suggestedValue": {"class": "File", "name": "GRCh38_primary_assembly_plus_ebv.fasta.tar", "path": "5b6ace6f7550b4c330563859"}}, {"type": ["null", "File"], "label": "blacklist_file", "sbg:fileTypes": "BAM, BED, GFF, VCF, BED.GZ, broadPeak, narrowPeak.gz, narrowPeak", "id": "#input_files_b_1", "sbg:x": 1900.8336794045442, "sbg:y": 541.6668613133772, "sbg:suggestedValue": {"class": "File", "name": "hg38.blacklist.bed.gz", "path": "59676f24507c174f55abe074"}}, {"type": ["null", {"type": "array", "items": "File"}], "label": "treatment_files", "sbg:fileTypes": "FQ, FQ.GZ, FASTQ, FASTQ.GZ", "id": "#treatment_files", "sbg:x": -54.82455662189147, "sbg:y": 249.2807615179786, "sbg:includeInPorts": true, "batchType": ["metadata.sample_id"]}, {"type": ["null", "boolean"], "label": "If True, MACS will save signal per million  reads for fragment pileup profiles", "description": "If True, MACS will save signal per million  reads for fragment pileup profiles. Require -B to be set.", "id": "#spmr", "inputBinding": {"separate": true, "prefix": "--SPMR", "sbg:cmdInclude": true, "position": 10}, "sbg:suggestedValue": true}, {"type": ["null", "int"], "label": "Buffer size", "description": "Buffer size for incrementally increasing internal array size to store reads alignment information. In most cases, you don't have to change this parameter. However, if there are large number of chromosomes/contigs/scaffolds in your alignment, it's recommended to specify a smaller buffer size in order to decrease memory usage (but it will take longer time to read alignment files). Minimum memory requested for reading an alignment file is about # of CHROMOSOME *  BUFFER_SIZE * 2 Bytes. DEFAULT: 100000.", "id": "#buffer_size", "inputBinding": {"separate": true, "prefix": "--buffer-size", "sbg:cmdInclude": true, "position": 5}, "sbg:toolDefaultValue": "100000"}, {"type": ["null", "int"], "label": "Band width for picking regions to compute fragment size", "description": "Band width for picking regions to compute fragment size. This value is only used while building the shifting model.", "id": "#band_width", "inputBinding": {"separate": true, "prefix": "--bw", "sbg:cmdInclude": true, "position": 11}}, {"type": [{"type": "enum", "symbols": ["narrow peaks", "broad peaks"], "name": "analysis_type"}], "label": "Analysis type", "description": "If 'narrow peaks' is selected, MACS2 will try to call narrow peaks and q-value parameter will be set to default value of 0.01. If 'broad peaks' is selected, MACS2 will try to call broad peaks and q-value parameter will be set to default value of 0.05.", "id": "#analysis_type"}, {"type": ["null", "boolean"], "label": "When set, scale the small sample up to the bigger sample", "description": "When set, scale the small sample up to the bigger sample. By default, the bigger dataset will be scaled down towards the smaller dataset, which will lead to smaller p/qvalues and more specific results. Keep in mind that scaling down will bring down background noise more. DEFAULT: False.", "id": "#TO_LARGE", "inputBinding": {"separate": true, "prefix": "--to-large", "sbg:cmdInclude": true, "position": 17}}, {"type": ["null", "int"], "label": "Tag Size", "description": "Tag size. This will override the auto detected tag size. DEFAULT: Not set.", "id": "#TAG_SIZE", "sbg:altPrefix": "--tsize", "inputBinding": {"separate": true, "prefix": "-s", "sbg:cmdInclude": true, "position": 31}}, {"type": ["null", "int"], "label": "The small nearby region in basepairs to calculate dynamic lambda", "description": "The small nearby region in basepairs to calculate dynamic lambda. This is used to capture the bias near the peak summit region. Invalid if there is no control data. If you set this to 0, MACS will skip slocal lambda calculation. *Note* that MACS will always perform a d-size local lambda calculation. The final local bias should be the maximum of the lambda value from d, slocal, and llocal size windows. DEFAULT: 1000.", "id": "#S_LOCAL", "sbg:stageInput": null, "inputBinding": {"separate": true, "prefix": "--slocal", "sbg:cmdInclude": true, "position": 22}}, {"type": ["null", "int"], "label": "(NOT the legacy --shiftsize option!) The arbitrary shift in bp", "description": "(NOT the legacy --shiftsize option!) The arbitrary shift in bp. Use discretion while setting it other than default value. When NOMODEL is set, MACS will use this value to move cutting ends (5') towards 5'->3' direction then apply EXTSIZE to extend them to  fragments. When this value is negative, ends will be moved toward 3'->5' direction. Recommended to keep it as default 0 for ChIP-Seq datasets, or -1 * half of EXTSIZE together with EXTSIZE option for detecting enriched cutting loci such as certain DNAseI-Seq datasets. Note, you can't set values other than 0 if format is BAMPE or BEDPE for paired-end data. DEFAULT: 0.", "id": "#SHIFT", "inputBinding": {"separate": true, "prefix": "--shift", "sbg:cmdInclude": true, "position": 29}}, {"type": ["null", "int"], "label": "Set the random seed while down sampling data", "description": "Set the random seed while down sampling data. Must be a non-negative integer in order to be effective. DEFAULT: not set.", "id": "#SEED", "inputBinding": {"separate": true, "prefix": "--seed", "sbg:cmdInclude": true, "position": 19}}, {"type": ["null", "float"], "label": "When set, use a custom scaling ratio of ChIP/control (e.g. calculated using NCIS) for linear scaling", "description": "When set, use a custom scaling ratio of ChIP/control (e.g. calculated using NCIS) for linear scaling. DEFAULT: ingore.", "id": "#RATIO", "inputBinding": {"separate": true, "prefix": "--ratio", "sbg:cmdInclude": true, "position": 18}}, {"type": ["null", "string"], "label": "Minimum FDR (q-value) cutoff for peak detection", "description": "Minimum FDR (q-value) cutoff for peak detection. DEFAULT: 0.05. -q, and -p are mutually exclusive.", "id": "#QVALUE", "sbg:altPrefix": "--qvalue", "inputBinding": {"valueFrom": {"script": "{\n\t//return $job.inputs.QVALUE\n    //return $job.inputs.analysis_type == 'narrow peaks'\n  \n  if ($job.inputs.QVALUE && !$job.inputs.PVALUE ){\n  \treturn $job.inputs.QVALUE\n  }\n  else {\n    if ($job.inputs.analysis_type == 'narrow peaks' && !$job.inputs.PVALUE){\n      return 0.01\n    }\n    else if ($job.inputs.analysis_type == 'broad peaks' && !$job.inputs.PVALUE){\n      return 0.05\n    }\n  }\n}", "class": "Expression", "engine": "#cwl-js-engine"}, "separate": true, "prefix": "-q", "position": 30, "sbg:cmdInclude": true}}, {"type": ["null", "string"], "label": "Pvalue cutoff for peak detection", "description": "Pvalue cutoff for peak detection. DEFAULT: not set. -q, and -p are mutually exclusive. If pvalue cutoff is set, qvalue will not be calculated and reported as -1 in the final .xls file.", "id": "#PVALUE", "sbg:altPrefix": "--pvalue", "inputBinding": {"separate": true, "prefix": "-p", "sbg:cmdInclude": true, "position": 16}}, {"type": [{"type": "enum", "symbols": ["hs", "mm", "ce", "dm"], "name": "Organism"}], "label": "Name of organism to calculate effective genome size. 'hs' for human (2.7e9), 'mm' for mouse   (1.87e9), 'ce' for C. elegans (9e7) and 'dm' for fruitfly (1.2e8)", "description": "Effective genome size. It can be 1.0e+9 or 1000000000, or shortcuts:'hs' for human (2.7e9), 'mm' for mouse  (1.87e9), 'ce' for C. elegans (9e7) and 'dm' for fruitfly (1.2e8).", "id": "#Organism", "inputBinding": {"valueFrom": {"script": "{\n  \nif ($job.inputs.Organism == \"hs\"){\n  \treturn 2.7e9;\n}\n  else if ($job.inputs.Organism == \"mm\"){\n    return 1.87e9;\n    \n  }else if ($job.inputs.Organism == \"ce\"){\n    return 9e7;\n  }\n   else if ($job.inputs.Organism == \"dm\")\n     return 1.2e8;\n\n}", "class": "Expression", "engine": "#cwl-js-engine"}, "separate": true, "prefix": "-g", "position": 4, "sbg:cmdInclude": true}, "sbg:suggestedValue": "hs"}, {"type": ["null", "boolean"], "label": "If True, MACS will use fixed background lambda as local lambda for every peak region", "description": "If True, MACS will use fixed background lambda as local lambda for every peak region. Normally, MACS  calculates a dynamic local lambda to reflect the local bias due to potential chromatin structure.", "id": "#NO_LAMBDA", "sbg:stageInput": null, "inputBinding": {"separate": true, "prefix": "--nolambda", "sbg:cmdInclude": true, "position": 21}}, {"type": ["null", "boolean"], "label": "Whether or not to build the shifting model", "description": "If True: do not to build the shifting model. If True, MACS will not build model. by default it means shifting size = 100, try to set extsize to change it. DEFAULT: False.", "id": "#NOMODEL", "inputBinding": {"separate": true, "prefix": "--nomodel", "sbg:cmdInclude": true, "position": 14}, "sbg:suggestedValue": true}, {"type": ["null", "string"], "label": "Select the regions within MFOLD range of high-confidence enrichment ratio against background to build model", "description": "Select the regions within MFOLD range of high-confidence enrichment ratio against background to build model. Fold-enrichment in regions must be lower than upper limit, and higher than the lower limit. Use as \"-m 10 30\". DEFAULT:5 50.", "id": "#MFOLD", "inputBinding": {"separate": true, "prefix": "-m", "sbg:cmdInclude": true, "position": 12}}, {"type": ["null", "int"], "label": "The large nearby region in basepairs to calculate dynamic lambda", "description": "The large nearby region in basepairs to calculate dynamic lambda. This is used to capture the surround bias. If you set this to 0, MACS will skip llocal lambda calculation. *Note* that MACS will always perform a d-size local lambda calculation. The final local bias should be the maximum of the lambda value from d, slocal, and llocal size windows. DEFAULT: 10000.", "id": "#L_LOCAL", "sbg:stageInput": null, "inputBinding": {"separate": true, "prefix": "--llocal", "sbg:cmdInclude": true, "position": 23}}, {"type": ["null", "string"], "label": "Keep duplicates", "description": "It controls the MACS behavior towards duplicate tags at the exact same location -- the same coordination and the same strand. The 'auto' option makes MACS calculate the maximum tags at the exact same location based on binomial distribution using 1e-5 as pvalue cutoff; and the 'all' option keeps every tags. If an integer is given, at most this number of tags will be kept at the same location. Note, if you've used  samtools or picard to flag reads as 'PCR/Optical duplicate' in bit 1024, MACS2 will still read them although the reads may be decided by MACS2 as duplicate later. The default is to keep one tag at the same location.", "id": "#KEEP_DUPS", "inputBinding": {"valueFrom": {"script": "{\n  if ($job.inputs.KEEP_DUPS){\n    return $job.inputs.KEEP_DUPS;\n  }\n}", "class": "Expression", "engine": "#cwl-js-engine"}, "separate": true, "prefix": "--keep-dup", "position": 6, "sbg:cmdInclude": true}, "sbg:toolDefaultValue": "1", "sbg:suggestedValue": "all"}, {"type": ["null", "boolean"], "label": "Whether turn on the auto pair model process", "description": "Whether turn on the auto pair model process. If set, when MACS failed to build paired model, it will use the nomodel settings, the --exsize parameter to extend each tags towards 3' direction. Not to use this  automate fixation is a default behavior now. DEFAULT: False.", "id": "#FIX_BIMODAL", "inputBinding": {"separate": true, "prefix": "--fix-bimodal", "sbg:cmdInclude": true, "position": 13}}, {"type": ["null", "float"], "label": "When set, the value will be used to filter out peaks with low fold-enrichment", "description": "When set, the value will be used to filter out peaks with low fold-enrichment. Note, MACS2 use 1.0 as pseudocount while calculating fold-enrichment. DEFAULT: 1.0.", "id": "#FECUTOFF", "inputBinding": {"separate": true, "prefix": "--fe-cutoff", "sbg:cmdInclude": true, "position": 28}}, {"type": ["null", "string"], "label": "Experiment name which will be used to name the output files", "description": "Experiment name, which will be used to generate output ile names. DEFAULT: \"NA\".", "id": "#EXP_NAME", "inputBinding": {"valueFrom": {"script": "{   \n    treatment_bam = [].concat($job.inputs.treatment_bam)\n    control_bam = ''\n    \n    //conditin if EXP_NAME is set\n    if($job.inputs.EXP_NAME){\n        return $job.inputs.EXP_NAME\n    }\n\n    if($job.inputs.control_bam){\n        control_bam = [].concat($job.inputs.control_bam)\n    \n        //condition if treatment and control files have Sample ID\n        if(treatment_bam[0].metadata && treatment_bam[0].metadata.sample_id\n                && control_bam[0].metadata && control_bam[0].metadata.sample_id){\n            return treatment_bam[0].metadata.sample_id + '_' + control_bam[0].metadata.sample_id\n        }\n    \n        //condition if treatment and control files don't have Sample ID\n        else {\n            treatment_pref = treatment_bam[0].path.split('/').pop().split('.').slice(0,-1).join('.')\n            control_pref = control_bam[0].path.split('/').pop().split('.').slice(0,-1).join('.')\n            return treatment_pref + '_' + control_pref\n        }\n    } \n    else { \n        return treatment_bam[0].path.split('/').pop().split('.').slice(0,-1).join('.')\n    }\n}", "class": "Expression", "engine": "#cwl-js-engine"}, "separate": true, "prefix": "-n", "position": 7, "sbg:cmdInclude": true}}, {"type": ["null", "boolean"], "label": "When set, random sampling method will scale down the bigger sample", "description": "When set, random sampling method will scale down the bigger sample. By default, MACS uses linear scaling. Warning: This option will make your result unstable and irreproducible since each time, random reads would  be selected. Consider to use 'randsample' script instead. <not implmented>If used together with --SPMR, 1 million unique reads will be randomly picked.</not implemented> Caution: due to the implementation, the final number of selected reads may not be as you expected! DEFAULT: False.", "id": "#DOWN_SAMPLE", "inputBinding": {"separate": true, "prefix": "--down-sample", "sbg:cmdInclude": true, "position": 19}}, {"type": ["null", "boolean"], "label": "While set, MACS2 will analyze number or total length of peaks that can be called by different p-value cutoff then output a summary table to help user decide a better cutoff", "description": "While set, MACS2 will analyze number or total length of peaks that can be called by different p-value cutoff then output a summary table to help user decide a better cutoff. The table will be saved in NAME_cutoff_analysis.txt file. Note, minlen and maxgap may affect the results. WARNING: May take ~30 folds longer time to finish. DEFAULT: False.", "id": "#CUTOFF_ANALYSIS", "inputBinding": {"separate": true, "prefix": "--cutoff-analysis", "sbg:cmdInclude": true, "position": 26}}, {"type": ["null", "boolean"], "label": "If set, MACS will use a more sophisticated signal processing approach to find subpeak summits in each enriched peak region", "description": "If set, MACS will use a more sophisticated signal processing approach to find subpeak summits in each enriched peak region. DEFAULT: False.", "id": "#CALL_SUMMITS", "inputBinding": {"separate": true, "prefix": "--call-summits", "sbg:cmdInclude": true, "position": 27}}, {"type": ["null", "float"], "label": "Cutoff for broad region", "description": "Cutoff for broad region. This option is not available unless --broad is set. If -p is set, this is a pvalue cutoff, otherwise, it's a qvalue cutoff. DEFAULT: 0.1.", "id": "#BROAD_CUTOFF", "inputBinding": {"separate": true, "prefix": "--broad-cutoff", "sbg:cmdInclude": true, "position": 25}}, {"type": ["null", "boolean"], "label": "If set, MACS will try to call broad peaks by linking nearby highly enriched regions", "description": "If set, MACS will try to call broad peaks by linking nearby highly enriched regions. The linking region is controlled by another cutoff through --linking-cutoff. The maximum linking region length is 4 times of d from MACS. DEFAULT: False.", "id": "#BROAD", "inputBinding": {"valueFrom": {"script": "{\n  if ($job.inputs.analysis_type == 'broad peaks'){\n    return true\n  }\n  else if($job.inputs.BROAD){\n    return $job.inputs.BROAD\n  }\n}", "class": "Expression", "engine": "#cwl-js-engine"}, "separate": true, "prefix": "--broad", "position": 24, "sbg:cmdInclude": true}}, {"type": ["null", "boolean"], "label": "Save extended fragment pileup, and local lambda tracks into a bedgraph file.", "description": "Whether or not to save extended fragment pileup, and local lambda tracks (two files) at every bp into a bedGraph file.", "id": "#BDG", "sbg:altPrefix": "--bdg", "sbg:stageInput": null, "inputBinding": {"separate": true, "prefix": "-B", "sbg:cmdInclude": true, "position": 8}, "sbg:suggestedValue": true}, {"type": ["null", "int"], "label": "Number of threads", "description": "Number of threads for BWA aln.", "id": "#threads", "sbg:category": "CPU", "inputBinding": {"valueFrom": {"script": "{\n  if($job.inputs.threads)\n\treturn $job.inputs.threads\n  return 8\n}", "class": "Expression", "engine": "#cwl-js-engine"}, "sbg:cmdInclude": true, "position": 4, "separate": true}, "sbg:toolDefaultValue": "8"}], "output": [{"name": "BROAD_PEAK"}, {"name": "NARROW_PEAK"}, {"name": "Rmodel"}, {"name": "EXCEL_FILE"}, {"name": "BAM index"}, {"name": "report_zip", "encodingFormat": "application/zip"}, {"name": "filtered BAM", "encodingFormat": "application/x-bam"}, {"name": "output_json"}, {"name": "final_output", "encodingFormat": "application/x-bam"}, {"name": "SUMMIT_BED_FILE"}, {"name": "SAMPLE_BDG"}, {"name": "CONTROL_BDG"}, {"name": "output_html", "encodingFormat": "text/html"}], "applicationSubCategory": ["Epigenetics", "ChIP-Seq"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1500041064, "sbg:revisionNotes": null}, {"sbg:revision": 1, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1500041064, "sbg:revisionNotes": "all apps added from demo projects"}, {"sbg:revision": 2, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1500041064, "sbg:revisionNotes": "added suggested files to reference_tsv_tar and blacklist_file input nodes, changed description, batching by sampleID enabled on sample_files input node."}, {"sbg:revision": 3, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1500041064, "sbg:revisionNotes": "added toolkit version to the Label"}, {"sbg:revision": 4, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1506422449, "sbg:revisionNotes": "fixed p-value parameter for MACS2"}, {"sbg:revision": 5, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1526909292, "sbg:revisionNotes": "- edited description\n- changed sample_files input ID to treatment files\n- updated MACS2\n- created bdg and summit BED outputs"}, {"sbg:revision": 6, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1526909292, "sbg:revisionNotes": "- wf batched by treatment files input port"}, {"sbg:revision": 7, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1526909292, "sbg:revisionNotes": "updated MACS2 and SBG Merge ChIP-seq QC metrics. Added ChIP-seq Separate BAMs"}, {"sbg:revision": 8, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1526909292, "sbg:revisionNotes": "allocated AWSInstanceType c4.8xlarge"}, {"sbg:revision": 9, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1528989451, "sbg:revisionNotes": "Instance hint for TGP added."}, {"sbg:revision": 10, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1529401968, "sbg:revisionNotes": "New format of instance hint for TGP added."}, {"sbg:revision": 11, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1533309594, "sbg:revisionNotes": "updated:\n- ChIP-seq Cross Correlation\n- ChIP-seq Separate BAM\n\nBWA Alignment and Filtering downgraded to revision1"}, {"sbg:revision": 12, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1537360829, "sbg:revisionNotes": "Updated ChIP-seq Cross Correlation app"}, {"sbg:revision": 13, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1537360830, "sbg:revisionNotes": "changed suggested reference_index_tar"}, {"sbg:revision": 14, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1545923302, "sbg:revisionNotes": "updated ChIP-seq FastQC to v0.11.7"}, {"sbg:revision": 15, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1545923303, "sbg:revisionNotes": "updated SBG ChIP-seq Select by Metadata"}, {"sbg:revision": 16, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1547565983, "sbg:revisionNotes": "changed naming of .sai file in bwa_aln.py script\" [BWA Alignment and Filtering]"}, {"sbg:revision": 17, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563377229, "sbg:revisionNotes": "added sbg:GoogleInstanceType n1-standard-32;pd-ssd;4096"}, {"sbg:revision": 18, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1584552381, "sbg:revisionNotes": "Updated description - added warning about # and ~ in filenames"}, {"sbg:revision": 19, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648035171, "sbg:revisionNotes": "added azure instance hint"}, {"sbg:revision": 20, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648035172, "sbg:revisionNotes": "added public categories"}, {"sbg:revision": 21, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1649155967, "sbg:revisionNotes": "update categories"}], "creator": "Milos Jordanski, Seven Bridges", "dateModified": 1649155967, "dateCreated": 1500041064, "contributor": ["admin"], "sdPublisher": "sbg", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_admin/sbg-public-data/chip-seq-bwa-alignment-and-peak-calling-spp-1-14/10", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/admin/sbg-public-data/chip-seq-bwa-alignment-and-peak-calling-spp-1-14/10", "applicationCategory": "Workflow", "version": "sbg:draft-2", "name": "ChIP-seq BWA Alignment and Peak Calling SPP 1.14", "description": "**Description:**\n\nChIP-seq (Chromatin immunoprecipitation followed by high-throughput sequencing technology) allows researchers to study the landscape of chromatin modifications or the binding patterns of transcription factors (TF) and other chromatin-associated proteins like RNA-polymerases or chromatin modulators.\n\nThis pipeline takes you all the way from unaligned raw sequencing reads (FASTQ) to ChIP-seq peaks detection.\n\nSequenced reads are aligned with the BWA-backtrack tool (specific for read size < 100bp). After alignment, BAM files are filtered (to remove low quality and unpaired reads) and de-duplicated. A number of QC metrics that evaluate the library complexity and signal enrichment are calculated. Peak calling is performed on the processed BAM files using SPP which is suggested peak caller for analysing binding patterns of TF.\n\n**Blacklisting**\n\nPrior to further ChIP-seq analysis, genomic regions that are associated with artifact signal may be removed. The exclusion of these regions, called blacklist regions, aims to remove sources of artifact signal caused by biases from chromatin accessibility and ambiguous alignment in order to increase the accuracy of both peak calling and comparative ChIP analysis. BEDTools intersect tool within this pipeline, when provided with adequate blacklist file, will remove blacklisted regions from peak SPP output file. \n\n**Required inputs:**\n\n* Input FASTQ reads (ID: Sample FASTQ) - one fastq file per sample for single-end data, or two files per sample for paired-end data. NOTE: For paired-end reads, it is crucial to set the metadata 'paired-end' field as 1 for one input file, as 2 for the other input file.\n\n* Reference/Index files (ID: Reference index) - TAR bundle of already generated index files.\n\n**Optional input:**\n\n* Control FASTQ reads (ID: Control FASTQ) - one fastq file per sample for single-end data, or two files per sample for paired-end data. NOTE: For paired-end reads, it is crucial to set the metadata 'paired-end' field as 1 for one input file, as 2 for the other input file.\n\n* Blacklist file (ID: Blacklist file) - BED file containing genomic regions that have anomalous, unstructured, high signal/ read counts in next-generation sequencing experiments. It could be used by BEDTools intersect in order to increase the accuracy of peak calling and comparative ChIP analysis.\n\n**Outputs:**\n\n* Sample_FASTQ.qc.b64html: B64HTML file with a table of all QC metrics.\n\n* Sample_FASTQ_deduped.filter.srt.bam: BAM files that are filtered (to remove low quality and unpaired reads) and de-duplicated. Could be used independently in other analyses for peak calling with different peak-callers.\n\n* Control_FASTQ_deduped.filter.srt.bam: BAM files that are filtered (to remove low quality and unpaired reads) and de-duplicated. Could be used independently in other analyses for peak calling with different peak-callers.\n\n* Sample_FASTQ_deduped.filter.srt.bam.bai: BAI index files for processed BAM files. Could be used independently in other analyses for peak calling with different peak-callers.\n\n* Control_FASTQ_deduped.filter.srt.bam.bai: BAI index files for processed BAM files. Could be used independently in other analyses for peak calling with different peak-callers.\n\n* Sample_FASTQ_SPPpeaks.narrowPeak: a BED6+4 format file which contains the peak locations together with pvalue and qvalue. This output contains fixed width peaks.\n\n* Sample_FASTQ_SPPpeaks.regionPeak: a BED6+4 format file which contains the peak locations together with pvalue and qvalue.  This output contains variable width peaks with regions of enrichment around peak summits.\n\n* Sample_FASTQ_SPPmodel.Rdata: Rdata object which you can use to access the model and output results produced by SPP. \n\n* Sample_FASTQ_SPPxcorplot.pdf: The cross-correlation of stranded read density profiles plot saved in a PDF file.\n\n* Sample_FASTQ_SPPpeaks.blacklisted.narrowPeak: Sample FASTQ_SPPpeaks.narrowPeak file without blacklist regions.(This file is not created if Blacklist file is not provided on input).\n\n**Important notes:**\n\n* **When providing sample and control files to the input, a \"Case ID\" and \"Sample ID\" metadata should be properly set for each file. PE files should have the same \"Sample ID\" and \"Case ID\". Sample files (PE or SE) should have the same \"Case ID\" as corresponding control files.**\n\n* In some situations read trimming is necessary, for instance, if read ends display poor quality values (most generally the right end) or if control and ChIP-seq samples have inconsistent read lengths. In these cases, read-trimming should be applied.\n\n* Preferred values for library complexity are NRF>0.9, PBC1 \u2265 0.9, and PBC2 \u2265 10.\n\n* Preferred values for NSC and RSC metric are: NSC > 1.05 and RSC > 0.8 (Even if ChIP-seq data does not meet these guidelines, there could still be significant biological information. The users should evaluate the profiles of the cross-correlation plot to further assess the quality of their data).\n\n* Input and negative control samples should have low NSC and RSC scores.\n\n* SBG ChIP-seq Set Metadata tool adds values 'control' and 'sample' to the metadata field 'chip-seq' of the input files.\n\n**Important notes about SPP options:**\n\n* **run_spp_nodups:** In this workflow we set \u2018run_spp_nodups\u2019 because we expect the input BAM files to be de-duplicated (after 'SBG ChIP-seq Filter and QC' workflow). If this is not the case, this parameter should not be set (un-select it).\n\n* **fragLen**: SPP requires the user to provide the fragment-length cross-correlation peak strandshift value to the \u2014speak parameter. In this workflow, this argument is passed to SPP using the fragment length estimated in the previous step (*json output; from 'SBG ChIP-seq filter and QC').\n\n* **npeak**: The threshold on a number of peaks to call is set to 300,000 to allow for 'relaxed' peak calling. Peak sets thresholded in this way are not meant to be interpreted as definitive binding events, but are rather intended to be used as input for subsequent statistical comparison of replicates. Please use the fdr parameter and leave the npeak option in blank if a more stringent analysis is needed.\n\n* **call_narrowPeaks**: Select this option for \u2018narrowPeak\u2019 output if you require that fixed width peaks are outputted.\n\n* **call_regionPeaks**: Select this option for \u2018regionPeak\u2019 output if you require that variable width peaks with regions of enrichment around peak summits outputted (recommended).\n\n**Common issues and limitations of the workflow:**\n\n* If the total size of the input files in a single task exceeds 20GB perhaps a larger instance should be allocated due to memory requirements.\n\n* In cases when analysing two biological replicates, outputs between replicates should be compared using IDR app. IDR is publicly available app which could be used to combine outputs of chip-seq pipeline in order to perform the comparative analysis between biological replicates in the separate task.\n\n* This workflow might not work with filenames containing some special characters e.g. **#**, **~**.", "input": [{"name": "control_files"}, {"name": "sample_files", "encodingFormat": "text/fastq"}, {"name": "reference_index_tar", "encodingFormat": "application/x-tar"}, {"name": "blacklist_file", "encodingFormat": "application/x-bam"}, {"name": "spp_nodups"}, {"name": "FDR"}, {"name": "savn"}, {"name": "Number of threads"}], "original_input": [{"type": ["null", {"type": "array", "items": "File"}], "label": "control_files", "id": "#control_files", "sbg:x": -53.60525096543294, "sbg:y": 398.44748447792267}, {"type": ["null", {"type": "array", "items": "File"}], "label": "sample_files", "sbg:fileTypes": "FQ, FQ.GZ, FASTQ, FASTQ.GZ", "id": "#sample_files", "batchType": ["metadata.sample_id"], "sbg:x": -49.11027005401982, "sbg:y": 250.23313135052808}, {"type": ["File"], "label": "reference_index_tar", "sbg:fileTypes": "TAR, TAR.GZ", "id": "#reference_index_tar", "sbg:includeInPorts": true, "sbg:x": 423.00003463692207, "sbg:y": 112.50002894136739, "sbg:suggestedValue": {"class": "File", "name": "GRCh38_no_alt_analysis_set_GCA_000001405.15.fasta.gz.tar", "path": "5966888f507c173d3c9f81de"}}, {"type": ["null", "File"], "label": "blacklist_file", "sbg:fileTypes": "BAM, BED, GFF, VCF, BED.GZ, broadPeak, narrowPeak.gz, narrowPeak", "id": "#input_files_b_1", "sbg:x": 1937.500237796048, "sbg:y": 543.3334768613228, "sbg:suggestedValue": {"class": "File", "name": "hg38.blacklist.bed.gz", "path": "59676f24507c174f55abe074"}}, {"type": ["boolean"], "label": "spp_nodups", "description": "Should be TRUE if duplicates were already removed from the chip sample.", "id": "#run_spp_nodups", "sbg:category": "Configuration", "sbg:suggestedValue": true}, {"type": ["null", "string"], "label": "FDR", "description": "False discovery rate threshold for peak calling.", "id": "#fdr", "sbg:category": "Configuration", "sbg:suggestedValue": "0.01"}, {"type": ["null", "boolean"], "label": "savn", "description": "Call NarrowPeaks (fixed width peaks).", "id": "#call_narrowPeaks", "sbg:category": "Output files", "sbg:suggestedValue": true}, {"type": ["null", "int"], "label": "Number of threads", "description": "Number of threads for BWA aln.", "id": "#threads", "sbg:category": "CPU", "inputBinding": {"valueFrom": {"script": "{\n  if($job.inputs.threads)\n\treturn $job.inputs.threads\n  return 8\n}", "class": "Expression", "engine": "#cwl-js-engine"}, "sbg:cmdInclude": true, "position": 4, "separate": true}, "sbg:toolDefaultValue": "8"}], "output": [{"name": "BAM index"}, {"name": "filtered BAM", "encodingFormat": "application/x-bam"}, {"name": "output_json"}, {"name": "b64html", "encodingFormat": "text/html"}, {"name": "final_output", "encodingFormat": "application/x-bam"}, {"name": "output_NarrowPeak"}, {"name": "output_Rdata"}, {"name": "out_crosscorr_pdf"}, {"name": "report_zip", "encodingFormat": "application/zip"}], "applicationSubCategory": ["Epigenetics", "ChIP-Seq"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1500041198, "sbg:revisionNotes": null}, {"sbg:revision": 1, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1500041198, "sbg:revisionNotes": "all apps added from demo projects"}, {"sbg:revision": 2, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1500041198, "sbg:revisionNotes": "added suggested files to reference_tsv_tar and blacklist_file input nodes, changed description, batching by sampleID enabled on sample_files input node."}, {"sbg:revision": 3, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1500041198, "sbg:revisionNotes": "removed dash from Label between name and toolkit version"}, {"sbg:revision": 4, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1545923304, "sbg:revisionNotes": "updated SBG ChIP-seq Select by Metadata"}, {"sbg:revision": 5, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1547565982, "sbg:revisionNotes": "changed naming of .sai file in bwa_aln.py script\" [BWA alignment and filtering]\nupdated FastQC"}, {"sbg:revision": 6, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563377231, "sbg:revisionNotes": "added sbg:GoogleInstanceType n1-standard-32;pd-ssd;4096"}, {"sbg:revision": 7, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1584552509, "sbg:revisionNotes": "Updated description - added warning about # and ~ in filenames"}, {"sbg:revision": 8, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648035172, "sbg:revisionNotes": "added azure instance hint"}, {"sbg:revision": 9, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648035172, "sbg:revisionNotes": "added public categories"}, {"sbg:revision": 10, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1649155967, "sbg:revisionNotes": "update categories"}], "creator": "Nemanja Vucic, Seven Bridges", "dateModified": 1649155967, "dateCreated": 1500041198, "contributor": ["admin"], "sdPublisher": "sbg", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_admin/sbg-public-data/clustering-and-gene-marker-identification-with-seurat-3-2-2/3", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/admin/sbg-public-data/clustering-and-gene-marker-identification-with-seurat-3-2-2/3", "applicationCategory": "Workflow", "version": "v1.2", "name": "Clustering and Gene Marker Identification with Seurat 3.2.2", "description": "The workflow performs clustering and gene marker identification analysis starting from gene-cell UMI or read counts.\n\nThe **Clustering and Gene Marker Identification with Seurat 3.2.2** workflow is based on the **Seurat 3.2.2** R package [1] and it can be used to process gene-cell UMI or read counts produced with the following tools available on the Seven Bridges Platform: **Cell Ranger counts**, **Salmon Alevin**, **Kallisto BUStools Workflow**, **zUMIs**, **Single-Cell Smart-seq2 Workflow v3.0.0**, and **STAR** (STARsolo option). \n\n*A list of **all inputs and parameters** with corresponding descriptions can be found at the bottom of this page.*  \n***Please note that any cloud infrastructure costs resulting from app and pipeline executions, including the use of public apps, are the sole responsibility of you as a user. To avoid excessive costs, please read the app description carefully and set the app parameters and execution settings accordingly.***\n\n### Common Use Cases\n\nDepending on the quantification method used, the **Input type** parameter needs to be specified adequately and the **Gene-cell count matrices** input port needs to be provided with one of the following files:\n\n- Cell Ranger counts:  filtered or unfiltered feature_bc_matrix.tar.gz file (from the *Feature-barcode matrices TAR* output port); \n- Salmon Alevin:  alevin_output.tar.gz file (from the *Compressed output directory* output port);\n- Kallisto BUStools Workflow: Rdata file (from the *Counts table* output port);\n- zUMIs: RDS file (from the *Expression files* output port);\n- STAR: filtered or unfiltered .tar.gz file (from the *STARsolo matrix TAR* output port);\n- Single-Cell Smart-seq2 Workflow v3.0.0: gene_expression.results.mtx file (from the *RSEM gene expression matrix* output port).\n\nRemoving low quality cells and unexpressed genes from the data can significantly improve the quality of the clustering analysis. Some of the parameters that can be used for filtering are: **Minimum number of cells**, **Minimum number of genes**, **Minimal number of UMI counts detected per cell**, **Minimal number of genes detected per cell**, **Maximum percentage of mitochondrial genes** etc. For more details and the default values, please read the parameters description. \n\nThe quality of the clustering can be further improved by restricting the variation due to uninteresting (unwanted) sources. By default, the Seurat method `SCTransform` will regress out variation due to number of UMIs (sequencing depth), number of genes, mitochondrial expression, and cell cycle phase (the last mentioned can be avoided by setting the **Cell cycle regression** parameter to **FALSE**). \n\nTo overcome the extensive technical noise in the expression of any single gene for scRNA-seq data, the Seurat assigns cells to clusters based on their PCA scores derived from the expression of the integrated most variable genes. With the Seurat `SCTransform` method, selection of PCs is no longer as important as it used to be. In theory, the more PCs we choose, the more variation is accounted for when performing the clustering, but it takes longer to perform the clustering. The **Number of principal components** parameter defines the number of PCs that will be used for clustering (default = **30**).\n\nThe parameter of particular importance for this analysis is the **Clustering resolutions** parameter specifying which resolution values should be used by the clustering algorithm to determine the number of clusters (higher resolution value will result in higher number of clusters). Multiple values for the parameter can be set and the results will be produced for each provided value (default = **0.5**). \n\nIn addition, a clustering tree, showing how samples move as the number of clusters increases, may help in deciding what resolution to use. The **Clustree resolutions** parameter specifies the resolutions that will be used for making the clustering tree (default = **0.1**, **0.2**, **0.3**, **0.4**, **0.5**, **0.6**, **0.7**, **0.8**, **0.9**, and **1** + resolutions chosen using the **Clustering resolutions** parameter, if not already in the list).\n \n To identify gene markers of a single cluster (compared to all other cells), Seurat performs differential expression. The testing method can be set using the **Differential expression test** parameter (default = **wilcox**, a.k.a. The Mann Whitney U test). Two parameters are important for gene marker selection: the **Minimum percentage of expressed cells** parameter that requires a gene to be detected at a minimum percentage in either of the two groups of cells (default = **0.1**) and the **Minimum log fold change** parameter that requires a gene to be differentially expressed (on average) by certain amount between the two groups (default = **0.25**).\n\nBy default, only positive markers will be considered. If the **Only positive markers** parameter is set to **FALSE**, both positive and negative markers will be included in the analysis.\n\nAs a result, the workflow produces: \n- HTML report, containing quality metric plots, the UMAP plot showing the results of clustering, the clustering tree plot, the table with top 10 markers per cluster, and the heatmap plot showing the expression pattern of marker genes among clusters.\n- TSV table with detected biomarkers (one table for each resolution).\n- PDF report, containing multiple violin and feature plots showing the top 6 marker genes identified in each cluster (one PDF file for each resolution). This output can be omitted by setting the **Biomarker plots** parameter to **FALSE**.\n- Result Seurat object, allowing further exploration of the data and results locally.\n\n### Changes Introduced by Seven Bridges\nThe Clustering tree plot is produced using the **Clustree** R package.\n\n### Common Issues and Important Notes\n- Currently, only human and mouse samples are supported.\n- In most of the cases, it is hard to tell the optimal parameter values for best clustering results in advance. Thus, after analysing all the QC and clustering plots, re-running of the analysis with corrected (optimal) parameter values is recommended.\n- The **Minimum number of genes** parameter is applied before the Seurat object is created, thus removed cells won\u2019t be visible in the QC plots of the html report. Using the **Minimal number of genes detected per cell** and the **Minimal number of UMI counts detected per cell** parameters would then be a safer option for removing low quality cells because the result of filtering using these parameters will be visible.\n- While running the PCA, the total number of PCs to compute and store is 50 by default. Thus, the total number of cells after filtering should be greater than 50, otherwise the task will fail.\n- In some cases, the workflow won't be able to detect mitochondrial counts, thus the percent of mitochondrial counts won't be used as a criterium for filtering. This may happen due to differences in labelling of the mitochondrial genes comparing different model organisms and reference files. Currently, the workflow should be able to detect human and mouse mitochondrial gene ids.\n- If the size of the html or pdf report exceeds 10 MiB, the preview of the file's content will not be supported on the Seven Bridges Platform. In that case, the files can be downloaded and observed locally.\n\n\n### Performance Benchmarking\n\nRuntime and task cost for different number of analysed cells, using the default options:\n\n| # of cells | Quantifier used  | Duration |  Cost | Instance (AWS) | \n|:-------------:|:----------:|:----------:|:----------:|:------------:|\n|       1.2 k     |     Cell Ranger   |   5 min   |   $0.05    |    c4.2xlarge    |\n|       4.6 k     |     Cell Ranger  |   11 min   |   $0.10    |    c4.2xlarge    |\n|       8.7 k     |     Cell Ranger    |   18 min   |   $0.17    |    c4.2xlarge    |\n|       11.7 k     |    Cell Ranger    |   30 min   |   $0.28    |    c4.2xlarge    |\n\n      \n*Cost can be significantly reduced by using **spot instances**. Visit the [Knowledge Center](https://docs.sevenbridges.com/docs/about-spot-instances) for more details.*\n\n\n### API Python Implementation\nThe workflow's draft task can also be submitted via the **API**. In order to learn how to get your **Authentication token** and **API endpoint** for the corresponding platform visit our [documentation](https://github.com/sbg/sevenbridges-python#authentication-and-configuration).\n\n```python\nfrom sevenbridges import Api\n\n# Enter api credentials\nauthentication_token, api_endpoint = \"enter_your_token\", \"enter_api_endpoint\"\napi = Api(token=authentication_token, url=api_endpoint)\n\n# Get project_id/workflow_id from your address bar. Example: https://igor.sbgenomics.com/u/your_username/project/workflow\nproject_id, workflow_id = \"your_username/project\", \"your_username/project/workflow\"\n\n# Get file names from files in your project. File names below are just as an example.\ninputs = {\n        'in_counts': list(api.files.query(project=project_id, names=['sample_kallisto_gene_counts.Rdata'])), \n        'input_type': \"kallisto_bus\"\n        }\n\n# Run the task\ntask = api.tasks.create(name='Seurat 3.2.2 workflow - API Example', project=project_id, app=workflow_id, inputs=inputs, run=True)\n```\nInstructions for installing and configuring the API Python client are provided on [github](https://github.com/sbg/sevenbridges-python#installation). For more information about using the API Python client, consult [sevenbridges-python documentation](http://sevenbridges-python.readthedocs.io/en/latest/). **More examples** are available [here](https://github.com/sbg/okAPI).\n\nAdditionally, [API R](https://github.com/sbg/sevenbridges-r) and [API Java](https://github.com/sbg/sevenbridges-java) clients are available. To learn more about using these API clients please refer to the [API R client documentation](https://sbg.github.io/sevenbridges-r/), and [API Java client documentation](https://docs.sevenbridges.com/docs/java-library-quickstart).\n\n### References\n\n[1] [Seurat documentation](https://satijalab.org/seurat/)", "input": [{"name": "Gene-cell count matrices"}, {"name": "Input Type"}, {"name": "Output name prefix"}, {"name": "Minimum number of cells"}, {"name": "Minimum number of genes"}, {"name": "Project descriptor"}, {"name": "Minimal number of UMI counts detected per cell"}, {"name": "Maximal number of UMI counts detected per cell"}, {"name": "Minimal number of genes detected per cell"}, {"name": "Maximal number of genes detected per cell"}, {"name": "Maximum percentage of mitochondrial genes"}, {"name": "Novelty score (complexity)"}, {"name": "Cell cycle regression"}, {"name": "Number of principal components"}, {"name": "Clustering resolutions"}, {"name": "Minimum percentage of expressed cells"}, {"name": "Minimum log fold change"}, {"name": "Only positive markers"}, {"name": "Gene marker plots"}, {"name": "Differential expression test"}, {"name": "Clustree resolutions"}], "original_input": [{"id": "in_counts", "type": "File", "label": "Gene-cell count matrices", "doc": "Gene-cell count matrices.", "sbg:x": -544, "sbg:y": -46}, {"id": "input_type", "type": {"type": "enum", "symbols": ["alevin", "cellranger", "kallisto_bus", "zumis", "star_solo", "smart_seq2"], "name": "input_type"}, "label": "Input Type", "doc": "Select method used to create raw count matrix.", "sbg:exposed": true}, {"id": "output_name_prefix", "type": "string?", "label": "Output name prefix", "doc": "If this parameter is not specified, sample id from metadata will be used as output name prefix. If sample id metadata field is not specified as well, prefix will not be added to the bare output name (quantification method used + \u201cseurat.rds\u201d, e.g cellranger.seurat.rds).", "sbg:exposed": true}, {"id": "min_cells", "type": "int?", "label": "Minimum number of cells", "doc": "Minimum number of cells expressing a given gene in order to include that gene in the analysis (default = 3).", "sbg:exposed": true}, {"id": "min_features", "type": "int?", "label": "Minimum number of genes", "doc": "Minimum number of genes expressed in a given cell in order to include that cell in the analysis (default = 200).", "sbg:exposed": true}, {"id": "project", "type": "string?", "label": "Project descriptor", "doc": "Project descriptor.", "sbg:exposed": true}, {"id": "min_UMIs", "type": "int?", "label": "Minimal number of UMI counts detected per cell", "doc": "If the number of UMIs detected in the certain cell is below this threshold, that cell will be removed from further analysis (default = 500).", "sbg:exposed": true}, {"id": "max_UMIs", "type": "int?", "label": "Maximal number of UMI counts detected per cell", "doc": "If the number of UMIs detected in the certain cell is above this threshold, that cell will be removed from further analysis (default = Infinity).", "sbg:exposed": true}, {"id": "min_genes", "type": "int?", "label": "Minimal number of genes detected per cell", "doc": "If the number of genes (features) detected in the certain cell is below this threshold, that cell will be removed from further analysis (default = 300).", "sbg:exposed": true}, {"id": "max_genes", "type": "int?", "label": "Maximal number of genes detected per cell", "doc": "If the number of genes (features) detected in the certain cell is above this threshold, that cell will be removed from further analysis (default = Infinity).", "sbg:exposed": true}, {"id": "mt_percent", "type": "float?", "label": "Maximum percentage of mitochondrial genes", "doc": "Cells with a percentage of mitochondrial genes higher than this threshold will be removed from further analysis (default = 20).", "sbg:exposed": true}, {"id": "novelty_score", "type": "float?", "label": "Novelty score (complexity)", "doc": "Contamination with low complexity cell types (like red blood cells) can be detected via this metric. It is calculated as log10GenesPerUMI. By default, this parameter is not active. To activate it just set a value between 0 and 1, and all the cells with complexity scores lower than the chosen value will be removed from further analysis.", "sbg:exposed": true}, {"id": "cellcycleregression", "type": ["null", {"type": "enum", "symbols": ["TRUE", "FALSE"], "name": "cellcycleregression"}], "label": "Cell cycle regression", "doc": "Whether to perform cell cycle regression (default = TRUE).", "sbg:exposed": true}, {"id": "n_PCs", "type": "int?", "label": "Number of principal components", "doc": "Number of principal components to consider in clustering (default = 30). Maximal supported value for this parameter is 50.", "sbg:exposed": true}, {"id": "resolution", "type": "float[]?", "label": "Clustering resolutions", "doc": "This parameter specifies which resolution values should be used by the clustering algorithm to determine the number of clusters. The user can set multiple values for the resolution parameter and the results will be produced for each provided value (default = 0.5).", "sbg:exposed": true}, {"id": "min_pct", "type": "float?", "label": "Minimum percentage of expressed cells", "doc": "Minimum percentage of cells expressing a certain gene to consider that gene a biomarker (default = 0.1).", "sbg:exposed": true}, {"id": "min_logfc", "type": "float?", "label": "Minimum log fold change", "doc": "Minimum effect size (log fold change) to consider a certain gene a biomarker (default = 0.25).", "sbg:exposed": true}, {"id": "only_pos_markers", "type": ["null", {"type": "enum", "symbols": ["FALSE", "TRUE"], "name": "only_pos_markers"}], "label": "Only positive markers", "doc": "Whether to extract only positive markers (default = TRUE).", "sbg:exposed": true}, {"id": "biomarker_plots", "type": ["null", {"type": "enum", "symbols": ["TRUE", "FALSE"], "name": "biomarker_plots"}], "label": "Gene marker plots", "doc": "Whether to output gene marker (violin and feature) plots in pdf format. Plots will be created for top 6 biomarkers for each cluster -  one pdf file per clustering resolution (default = TRUE).", "sbg:exposed": true}, {"id": "test_use", "type": ["null", {"type": "enum", "symbols": ["wilcox", "bimod", "roc", "t", "negbinom", "poisson", "LR", "MAST", "DESeq2"], "name": "test_use"}], "label": "Differential expression test", "doc": "Denotes which test to use:\n\u2022 \"wilcox\" : Identifies differentially expressed genes between two groups of cells using a Wilcoxon Rank Sum test (default).\n\u2022 \"bimod\" : Likelihood-ratio test for single cell gene expression.\n\u2022 \"roc\" : Identifies \u2019markers\u2019 of gene expression using ROC analysis. For\neach gene, evaluates (using AUC) a classifier built on that gene alone, to\nclassify between two groups of cells. An AUC value of 1 means that expression values for this gene alone can perfectly classify the two groupings. An AUC value of 0 also means there is perfect classification, but in the other direction. A value of 0.5 implies that the gene has no predictive\npower to classify the two groups.\n\u2022 \"t\" : Identify differentially expressed genes between two groups of cells using the Student\u2019s t-test.\n\u2022 \"negbinom\" : Identifies differentially expressed genes between two groups\nof cells using a negative binomial generalized linear model. Use only for\nUMI-based datasets.\n\u2022 \"poisson\" : Identifies differentially expressed genes between two groups of\ncells using a poisson generalized linear model. Use only for UMI-based\ndatasets.\n\u2022 \"LR\" : Uses a logistic regression framework to determine differentially\nexpressed genes. Constructs a logistic regression model predicting group\nmembership based on each feature individually and compares this to a null\nmodel with a likelihood ratio test.\n\u2022 \"MAST\" : Identifies differentially expressed genes between two groups of\ncells using a hurdle model tailored to scRNA-seq data. Utilizes the MAST\npackage to run the DE testing.\n\u2022 \"DESeq2\" : This test does not support prefiltering of genes based on average difference (or percent detection rate) between cell groups. However, genes may be pre-filtered based on their minimum detection rate (min.pct) across both cell groups.", "sbg:exposed": true}, {"id": "clustree_resolutions", "type": "float[]?", "label": "Clustree resolutions", "doc": "Resolutions for creating a clustering tree plot. Provide a range of resolutions containing more than two values (default = 0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1).", "sbg:exposed": true}], "output": [{"name": "Output seurat object"}, {"name": "Clustering results table"}, {"name": "Report", "encodingFormat": "text/html"}, {"name": "Biomarker plots"}], "schema:softwareRequirements": ["InlineJavascriptRequirement", "StepInputExpressionRequirement"], "thumbnailUrl": "https://igor.sbgenomics.com/ns/brood/images/admin/sbg-public-data/clustering-and-gene-marker-identification-with-seurat-3-2-2/3.png", "codeRepository": ["https://github.com/satijalab/seurat"], "applicationSubCategory": ["Single Cell"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1612284091, "sbg:revisionNotes": null}, {"sbg:revision": 1, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1612284242, "sbg:revisionNotes": ""}, {"sbg:revision": 2, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1624017822, "sbg:revisionNotes": "update workflow description"}, {"sbg:revision": 3, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648035484, "sbg:revisionNotes": "update app categories field in the description"}], "dateModified": 1648035484, "dateCreated": 1612284091, "contributor": ["admin"], "sdPublisher": "sbg", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_admin/sbg-public-data/cnvkit-pipeline-from-baseline-093/13", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/admin/sbg-public-data/cnvkit-pipeline-from-baseline-093/13", "applicationCategory": "Workflow", "version": "sbg:draft-2", "name": "CNVkit CNV Calling", "description": "CNVkit analyses copy number variants in exome, targeted, amplicon, hybrid and whole-genome DNA sequencing. \n\nThis toolkit takes advantage of both on\u2013 and off-target sequencing reads and applies a series of corrections to improve accuracy in copy number calling.[1]\n\n*A list of **all inputs and parameters** with corresponding descriptions can be found at the bottom of the page.*\n### Common Use Cases\n\n* The **CNVkit CNV Calling** workflow determines copy number alterations and variations.\n\n* **CNVkit Reference** must be run prior to running this workflow. **CNVkit Reference** output files, **Reference coverage file**, **Target** and **Antitarget BED** are the required inputs for this pipeline.\n\n* For proper CNV detection in sex chromosomes,  corresponding inputs must be set in the **Gender** and the **Male reference** parameters (eg. for female sample: **Gender**: *female*, **Male reference**: *False*).\n\n* For a deeper CNV analysis (eg. determining loss of heterozygosity regions), an additional step of calling the germline mutations in a tumor sample should be performed. This pipeline, unlike the **CNVkit CNV Calling with GATK HaplotypeCaller** doesn't have a variant caller implemented. Instead, a VCF created by another caller can be provided to the **SNP VCF** input.\n\n### Changes Introduced by Seven Bridges\n\n* Outputs are named based on the **Tumor BAM Sample ID** metadata field.\n\n### Common Issues and Important Notes\n\n* **CNVkit Reference** must be run prior to running this workflow. **CNVkit Reference** output files, **Reference coverage file**, **Target** and **Antitarget BED** are the required inputs for this pipeline.\n\n* For proper CNV detection in sex chromosomes,  corresponding inputs must be set in the **Gender** and the **Male reference** parameters (eg. for female sample: **Gender**: *female*, **Male reference**: *False*).\n\n### Performance Benchmarking\n\nThe instance set for this workflow is the AWS c4.2xlarge instance with 8vCPUs, 15 GiB of RAM and 256 GB of EBS (disk space).\n\n\n| BAM size (GB) | Type | Duration | Cost  |\n|---------------|------|----------|-------|\n|       12      | WES  | 9m       | $0.06 |\n|      144      | WGS  | 1h 26m       | $0.57 |\n\n*Cost can be significantly reduced by using **spot instances**. Visit the [Knowledge Center](https://docs.sevenbridges.com/docs/about-spot-instances) for more details.*\n\n### API Python Implementation\nThe app's draft task can also be submitted via the **API**. In order to learn how to get your **Authentication token** and **API endpoint** for the corresponding platform, visit our [documentation](https://github.com/sbg/sevenbridges-python#authentication-and-configuration).\n\n```python\n# Initialize the SBG Python API\nfrom sevenbridges import Api\napi = Api(token=\"enter_your_token\", url=\"enter_api_endpoint\")\n# Get project_id/app_id from your address bar. Example: https://igor.sbgenomics.com/u/your_username/project/app\nproject_id = \"your_username/project\"\napp_id = \"your_username/project/app\"\n# Replace inputs with appropriate values\ninputs = {\n\t\"tumor_bam\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"target_bed\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"antitarget_bed\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"reference_coverage_file\": api.files.query(project=project_id, names=[\"enter_filename\"])[0]}\n# Creates draft task\ntask = api.tasks.create(name=\"CNVkit CNV Calling - API Run\", project=project_id, app=app_id, inputs=inputs, run=False)\n```\n\nInstructions for installing and configuring the API Python client are provided on [github](https://github.com/sbg/sevenbridges-python#installation). For more information about using the API Python client, consult [the client documentation](http://sevenbridges-python.readthedocs.io/en/latest/). **More examples** are available [here](https://github.com/sbg/okAPI).\n\nAdditionally, [API R](https://github.com/sbg/sevenbridges-r) and [API Java](https://github.com/sbg/sevenbridges-java) clients are available. To learn more about using these API clients, please refer to the [API R client documentation](https://sbg.github.io/sevenbridges-r/), and [API Java client documentation](https://docs.sevenbridges.com/docs/java-library-quickstart).\n\n###References\n\n[1] [CNVkit: Genome-Wide Copy Number Detection and Visualization from Targeted DNA Sequencing](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4839673/)", "input": [{"name": "Minimal variant depth"}, {"name": "SNP VCF file", "encodingFormat": "application/x-vcf"}, {"name": "Zygosity freq"}, {"name": "Male reference"}, {"name": "Ploidy"}, {"name": "Gender"}, {"name": "Target BED"}, {"name": "Antitarget BED"}, {"name": "Reference coverage file"}, {"name": "Tumor BAM", "encodingFormat": "application/x-bam"}, {"name": "Significance threshold"}, {"name": "Segmentation method"}, {"name": "Drop outliers"}, {"name": "Drop low coverage"}, {"name": "Y axis minimum"}, {"name": "Y axis maximum"}, {"name": "Width of margin"}, {"name": "Draw a trendline"}, {"name": "Segment color"}, {"name": "Gene(s)"}, {"name": "Chromosome"}, {"name": "By bin"}, {"name": "Background marker"}, {"name": "Antitarget marker"}, {"name": "Minimum mapping quality score"}, {"name": "Count read midpoints"}, {"name": "Skip RepeatMasker"}, {"name": "No GC"}, {"name": "No edge"}, {"name": "Hard thresholds for calling each integer copy number"}, {"name": "Purity of cellularity"}, {"name": "Filter"}, {"name": "Center at:"}, {"name": "Center"}, {"name": "Title"}, {"name": "Copy number threshold"}, {"name": "No shift XY"}, {"name": "Minimum number of covered probes"}], "original_input": [{"type": ["null", "int"], "label": "Minimal variant depth", "description": "Minimum read depth for a SNV to be displayed in the b-allele frequency plot. [Default: 20]", "id": "#min_variant_depth", "sbg:y": 226.14848441935703, "sbg:x": 767.6922378088394, "sbg:includeInPorts": true}, {"type": ["null", "File"], "label": "SNP VCF file", "description": "VCF file name containing variants for segmentation by allele frequencies.", "sbg:fileTypes": "VCF", "id": "#snp_vcf_file", "sbg:y": 399.7055095526917, "sbg:x": 770.1945596749365, "sbg:includeInPorts": true}, {"type": ["null", "string"], "label": "Zygosity freq", "description": "Ignore VCF's genotypes (GT field) and instead infer zygosity from allele frequencies. [Default if used without a number: 0.25]", "id": "#zygosity_freq", "sbg:y": 790.764301119198, "sbg:x": 796.9233081467866, "sbg:includeInPorts": true}, {"type": ["null", "boolean"], "label": "Male reference", "description": "Was a male reference used? If so, expect half ploidy on chrX and chrY; otherwise, only chrY has half ploidy. In CNVkit, if a male reference was used, the \"neutral\" copy number (ploidy) of chrX is 1; chrY is haploid for either reference sex.", "id": "#male_reference", "sbg:y": 370.6839926633258, "sbg:x": 933.504714947032, "sbg:includeInPorts": true}, {"type": ["null", "int"], "label": "Ploidy", "description": "Ploidy of the sample cells. [Default: 2]", "id": "#ploidy", "sbg:y": 789.6358447664537, "sbg:x": 652.4956265614985, "sbg:includeInPorts": true}, {"type": ["null", {"type": "enum", "symbols": ["male", "female"], "name": "gender"}], "label": "Gender", "description": "Specify the sample's chromosomal sex as male or female. (Otherwise guessed from X and Y coverage).", "id": "#gender", "sbg:y": 787.6871402049162, "sbg:x": 952.3077886513731, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Target BED", "description": "A BED file of baited regions for use with CNVkit obtained from CNVkit CNV Calling.", "sbg:fileTypes": "BED, LIST", "id": "#target_bed", "sbg:y": 713.000283369665, "sbg:x": 282.9744418386915, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Antitarget BED", "description": "A BED file with off-target/\u201dantitarget\u201d regions obtained from the CNVkit CNV Calling.", "sbg:fileTypes": "BED, LIST", "id": "#antitarget_bed", "sbg:y": 407.9233622875586, "sbg:x": 282.46164563986486, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Reference coverage file", "description": "Reference coverage file obtained from the CNVkit Reference.", "sbg:fileTypes": "CNN", "id": "#reference_coverage_file", "sbg:y": 270.76953453991, "sbg:x": 280.00031437395745, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Tumor BAM", "description": "Tumor BAM", "sbg:fileTypes": "BAM", "id": "#bam_file", "secondaryFiles": [".bai"], "sbg:includeInPorts": true, "sbg:x": 281.53843712101116, "sbg:y": 558.4616355106009}, {"type": ["null", "float"], "label": "Significance threshold", "description": "Significance threshold (p-value or FDR, depending on method) to accept breakpoints during segmentation.", "id": "#significance_threshold", "sbg:category": "Optional arguments", "sbg:altPrefix": "-t", "sbg:stageInput": null}, {"type": ["null", {"type": "enum", "symbols": ["cbs", "haar", "flasso"], "name": "method"}], "label": "Segmentation method", "description": "Segmentation method (CBS, HaarSeg, or Fused Lasso).", "id": "#method", "sbg:category": "Optional arguments", "sbg:altPrefix": "-m", "sbg:stageInput": null, "sbg:toolDefaultValue": "cbs"}, {"type": ["null", "int"], "label": "Drop outliers", "description": "Drop outlier bins more than this many multiples of the 95th quantile away from the average within a rolling window. Set to 0 for no outlier filtering.", "id": "#drop_outliers", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "10"}, {"type": ["null", "boolean"], "label": "Drop low coverage", "description": "Drop very-low-coverage bins before segmentation to avoid false-positive deletions in poor-quality tumor samples.", "id": "#drop_low_coverage", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False"}, {"type": ["null", "float"], "label": "Y axis minimum", "description": "Y-axis lower limit.", "id": "#y_min", "sbg:category": "Plot aesthetics", "sbg:suggestedValue": -5}, {"type": ["null", "float"], "label": "Y axis maximum", "description": "Y-axis upper limit.", "id": "#y_max", "sbg:category": "Plot aesthetics", "sbg:suggestedValue": 5}, {"type": ["null", "int"], "label": "Width of margin", "description": "Width of margin to show around the selected gene or region on the chromosome (use with --gene or --region).", "id": "#width", "sbg:category": "Optional arguments", "sbg:altPrefix": "-w", "sbg:stageInput": null, "sbg:toolDefaultValue": "1000000"}, {"type": ["null", "boolean"], "label": "Draw a trendline", "description": "Draw a smoothed local trendline on the scatter plot.", "id": "#trend", "sbg:category": "Plot aesthetics", "sbg:altPrefix": "-t", "sbg:toolDefaultValue": "False"}, {"type": ["null", "string"], "label": "Segment color", "description": "Plot segment lines in this color. Value can be any string accepted by matplotlib, e.g. 'red' or '#CC0000'.", "id": "#segment_color", "sbg:category": "Plot aesthetics"}, {"type": ["null", {"type": "array", "items": "string"}], "label": "Gene(s)", "description": "Name of gene or genes (comma-separated) to display.", "id": "#genes", "sbg:category": "Optional arguments", "sbg:altPrefix": "-g", "sbg:stageInput": null}, {"type": ["null", "string"], "label": "Chromosome", "description": "Chromosome (e.g. 'chr1') or chromosomal range (e.g. 'chr1:2333000-2444000') to display. If a range is given, all targeted genes in this range will be shown, unless '--gene'/'-g' is already given.", "id": "#chromosome", "sbg:category": "Optional arguments", "sbg:altPrefix": "-c"}, {"type": ["null", "boolean"], "label": "By bin", "description": "Plot data x-coordinates by bin indices instead of genomic coordinates. All bins will be shown with equal width, no blank regions will be shown, and x-axis values indicate bin number (within chromosome) instead of genomic position.", "id": "#by_bin", "sbg:category": "Plot aesthetics", "sbg:stageInput": null, "sbg:toolDefaultValue": "False"}, {"type": ["null", "string"], "label": "Background marker", "description": "Plot antitargets with this symbol, in zoomed/selected regions.", "id": "#background_marker", "sbg:category": "Optional arguments", "sbg:altPrefix": "-b", "sbg:toolDefaultValue": "Same as targets"}, {"type": ["null", "string"], "label": "Antitarget marker", "description": "Plot antitargets using this symbol when plotting in a selected chromosomal region (-g/--gene or -c/--chromosome).", "id": "#antitarget_marker", "sbg:category": "Plot aesthetics", "sbg:altPrefix": "-a", "sbg:toolDefaultValue": "Same as targets"}, {"type": ["null", "int"], "label": "Minimum mapping quality score", "description": "Minimum mapping quality score (phred scale 0-60) to count a read for coverage depth.", "id": "#min_mapq", "sbg:category": "Optional arguments", "sbg:altPrefix": "-q", "sbg:stageInput": null, "sbg:toolDefaultValue": "0", "inputBinding": {"prefix": "--min-mapq", "separate": true, "sbg:cmdInclude": true, "position": 3}}, {"type": ["null", "boolean"], "label": "Count read midpoints", "description": "Get read depths by counting read midpoints within each bin. (An alternative algorithm).", "id": "#count", "sbg:category": "Optional arguments", "sbg:altPrefix": "-c", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"prefix": "--count", "separate": true, "sbg:cmdInclude": true, "position": 2}}, {"type": ["null", "boolean"], "label": "Skip RepeatMasker", "description": "Skip RepeatMasker correction.", "id": "#no_rmask", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"prefix": "--no-rmask", "separate": true, "sbg:cmdInclude": true, "position": 10}}, {"type": ["null", "boolean"], "label": "No GC", "description": "Skip GC correction.", "id": "#no_gc", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"prefix": "--no-gc", "separate": true, "sbg:cmdInclude": true, "position": 3}}, {"type": ["null", "boolean"], "label": "No edge", "description": "Skip edge-effect correction.", "id": "#no_edge", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"prefix": "--no-edge", "separate": true, "sbg:cmdInclude": true, "position": 4}}, {"type": ["null", {"type": "array", "items": "float"}], "label": "Hard thresholds for calling each integer copy number", "description": "Hard thresholds for calling each integer copy number, separated by commas.", "id": "#threshold", "sbg:category": "Optional arguments", "sbg:altPrefix": "-t", "sbg:toolDefaultValue": "-1.1,-0.25,0.2,0.7", "inputBinding": {"position": 3, "itemSeparator": ",", "valueFrom": {"engine": "#cwl-js-engine", "script": "{\n \n  if ($job.inputs.threshold){\n    \n    return '--thresholds=' + $job.inputs.threshold.join(',')\n    \n  } else {\n    \n    return ''\n    \n  }\n  \n}", "class": "Expression"}, "sbg:cmdInclude": true, "separate": false}}, {"type": ["null", "float"], "label": "Purity of cellularity", "description": "Estimated tumor cell fraction, a.k.a. purity or cellularity.", "id": "#purity", "sbg:category": "Optional arguments", "sbg:stageInput": null, "inputBinding": {"prefix": "--purity", "separate": true, "sbg:cmdInclude": true, "position": 5}}, {"type": ["null", {"type": "enum", "symbols": ["ampdel", "cn", "ci", "sem"], "name": "filter"}], "label": "Filter", "description": "Merge segments flagged by the specified filter(s) with the adjacent segment(s).", "id": "#filter", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "None", "inputBinding": {"prefix": "--filter", "separate": true, "sbg:cmdInclude": true, "position": 12}}, {"type": ["null", "float"], "label": "Center at:", "description": "Subtract a constant number from all log2 values. For \"manual\" re-centering, in case the --center option gives unsatisfactory results.)", "id": "#center_at", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "Calculated", "inputBinding": {"prefix": "--center-at", "separate": true, "sbg:cmdInclude": true, "position": 10}}, {"type": ["null", {"type": "enum", "symbols": ["mean", "median", "mode", "biweight"], "name": "center"}], "label": "Center", "description": "Re-center the log2 ratio values using this estimate of the center or average value.", "id": "#center", "sbg:category": "Optional arguments", "sbg:stageInput": null, "inputBinding": {"prefix": "--center", "separate": true, "sbg:cmdInclude": true, "position": 1}}, {"type": ["null", "string"], "label": "Title", "description": "Plot title.", "id": "#title", "sbg:category": "Plot aesthetics", "sbg:toolDefaultValue": "sample ID, from filename or -i", "inputBinding": {"prefix": "--title", "separate": true, "sbg:cmdInclude": true, "position": 20}}, {"type": ["null", "float"], "label": "Copy number threshold", "description": "Copy number change threshold to label genes.", "id": "#threshold_1", "sbg:category": "Optional arguments", "sbg:altPrefix": "-t", "sbg:stageInput": null, "sbg:toolDefaultValue": "0.5", "inputBinding": {"prefix": "--threshold", "separate": true, "sbg:cmdInclude": true, "position": 3}}, {"type": ["null", "boolean"], "label": "No shift XY", "description": "Don't adjust the X and Y chromosomes according to sample sex.", "id": "#no_shift_xy", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"prefix": "--no-shift-xy", "separate": true, "sbg:cmdInclude": true, "position": 30}}, {"type": ["null", "int"], "label": "Minimum number of covered probes", "description": "Minimum number of covered probes to label a gene.", "id": "#min_probes", "sbg:category": "Optional arguments", "sbg:altPrefix": "-m", "sbg:stageInput": null, "sbg:toolDefaultValue": "3", "inputBinding": {"prefix": "--min-probes", "separate": true, "sbg:cmdInclude": true, "position": 4}}], "output": [{"name": "CNV VCF"}, {"name": "CNV Calls"}, {"name": "CNV Scatter plot"}, {"name": "CNV Diagram"}], "applicationSuite": "CNVkitversion:0.9.3", "codeRepository": ["https://github.com/etal/cnvkit"], "applicationSubCategory": ["Copy Number Analysis"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126713, "sbg:revisionNotes": "Copy of milos.nikolic/cnvkit-cnv-calling-wxs/cnvkit-pipeline-from-baseline-093/22"}, {"sbg:revision": 1, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126713, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 2, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126713, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 3, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126713, "sbg:revisionNotes": "Fixed SBG Rename App"}, {"sbg:revision": 4, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126713, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 5, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126714, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 6, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126714, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 7, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1539684810, "sbg:revisionNotes": "Fixed SBG Rename App and added .bai to the Tumor BAM input."}, {"sbg:revision": 8, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1539684810, "sbg:revisionNotes": "Fixed SBG Rename App."}, {"sbg:revision": 9, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1545392586, "sbg:revisionNotes": "Increased hard disk memory to 1024 GB."}, {"sbg:revision": 10, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1545923057, "sbg:revisionNotes": "Update SBG Rename App"}, {"sbg:revision": 11, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563372433, "sbg:revisionNotes": "added Google Instance Hint"}, {"sbg:revision": 12, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648048903, "sbg:revisionNotes": "updated categories"}, {"sbg:revision": 13, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648048903, "sbg:revisionNotes": "added azure hint"}], "creator": "Eric Talevich", "dateModified": 1648048903, "dateCreated": 1535126713, "contributor": ["admin"], "sdPublisher": "sbg", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_admin/sbg-public-data/cnvkit-pipeline-from-baseline-093-hc/14", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/admin/sbg-public-data/cnvkit-pipeline-from-baseline-093-hc/14", "applicationCategory": "Workflow", "version": "sbg:draft-2", "name": "CNVkit CNV Calling with GATK HaplotypeCaller", "description": "CNVkit analyses copy number variants in exome, targeted, amplicon, hybrid and whole-genome DNA sequencing. \n\nThis toolkit takes advantage of both on\u2013 and off-target sequencing reads and applies a series of corrections to improve accuracy in copy number calling.[1]\n\n\n*A list of **all inputs and parameters** with corresponding descriptions can be found at the bottom of the page.*\n### Common Use Cases\n\n* The **CNVkit CNV Calling with GATK HaplotypeCaller** workflow determines copy number alterations and variations.\n\n* For a deeper CNV analysis (eg. determining loss of heterozygosity regions), a VCF containing germline mutations in a tumor must be provided. The germline mutations in a tumor are determined using the two GATK HaplotypeCallers. The first GATK HaplotypeCaller outputs a VCF with germline mutations in a normal sample. The created VCF is an input for the second GATK HaplotypeCaller, based on which the germline mutations are confirmed in a tumor sample.\n\n* **CNVkit Reference** must be run prior to running this workflow. **CNVkit Reference** output files, **Reference coverage file**, **Target** and **Antitarget BED** are the required inputs for this pipeline.\n\n* For a proper CNV detection in sex chromosomes, corresponding inputs must be set in the **Gender** and the **Male reference** parameters (eg. for female sample: **Gender**: *female*, **Male reference**: *False*).\n\n### Changes Introduced by Seven Bridges\n\n* Outputs are named based on the **Tumor BAM** and **Normal BAM Sample ID** metadata field.\n\n### Common Issues and Important Notes\n\n* **CNVkit Reference** must be run prior to running this workflow. **CNVkit Reference** output files, **Reference coverage file**, **Target** and **Antitarget BED** are the required inputs for this pipeline.\n\n* Matched Tumor-Normal BAMs are highly recommended as Tumor BAM and Normal BAM inputs, respectively.\n\n* A db SNP can be provided as an input in order to annotate known SNPs. \n\n* For a proper CNV detection in sex chromosomes, corresponding inputs must be set in the **Gender** and the **Male reference** parameters (eg. for female sample: **Gender**: *female*, **Male reference**: *False*).\n\n* This workflow might not work with filenames containing some special characters e.g. **#**, **~**.\n\n### Performance Benchmarking\n\nThe instances set for this workflow are the AWS c4.2xlarge instance with 8vCPUs, 15 GiB of RAM with 1 TB of EBS (disk) and the c5.9xlarge instance with 36 vCPUs, 72 GiB of RAM with EBS set to 1 TB.\n\n\n| BAM size (GB) | Type | Duration | Cost  |\n|---------------|------|----------|-------|\n|       12      |  WES |    31m   | $0.79 |\n|      144      |  WGS |  8h 26m  | $12.9 |\n\n*Cost can be significantly reduced by using **spot instances**. Visit the [Knowledge Center](https://docs.sevenbridges.com/docs/about-spot-instances) for more details.*\n\n### API Python Implementation\nThe app's draft task can also be submitted via the **API**. In order to learn how to get your **Authentication token** and **API endpoint** for the corresponding platform, visit our [documentation](https://github.com/sbg/sevenbridges-python#authentication-and-configuration).\n\n```python\n# Initialize the SBG Python API\nfrom sevenbridges import Api\napi = Api(token=\"enter_your_token\", url=\"enter_api_endpoint\")\n# Get project_id/app_id from your address bar. Example: https://igor.sbgenomics.com/u/your_username/project/app\nproject_id = \"your_username/project\"\napp_id = \"your_username/project/app\"\n# Replace inputs with appropriate values\ninputs = {\n\t\"tumor_bam\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"target_bed\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"antitarget_bed\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"reference_coverage_file\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"normal_bam\": list(api.files.query(project=project_id, names=[\"enter_filename\", \"enter_filename\"])), \n\t\"reference\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"bed_file\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n# Creates draft task\ntask = api.tasks.create(name=\"CNVkit CNV Calling with GATK HaplotypeCaller - API Run\", project=project_id, app=app_id, inputs=inputs, run=False)\n```\n\nInstructions for installing and configuring the API Python client are provided on [github](https://github.com/sbg/sevenbridges-python#installation). For more information about using the API Python client, consult [the client documentation](http://sevenbridges-python.readthedocs.io/en/latest/). **More examples** are available [here](https://github.com/sbg/okAPI).\n\nAdditionally, [API R](https://github.com/sbg/sevenbridges-r) and [API Java](https://github.com/sbg/sevenbridges-java) clients are available. To learn more about using these API clients, please refer to the [API R client documentation](https://sbg.github.io/sevenbridges-r/), and [API Java client documentation](https://docs.sevenbridges.com/docs/java-library-quickstart).\n\n###References\n\n[1] [CNVkit: Genome-Wide Copy Number Detection and Visualization from Targeted DNA Sequencing](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4839673/)", "input": [{"name": "Minimal variant depth"}, {"name": "Zygosity freq"}, {"name": "Male reference"}, {"name": "Ploidy"}, {"name": "Gender"}, {"name": "Target BED"}, {"name": "Antitarget BED"}, {"name": "Reference coverage file"}, {"name": "Normal BAM", "encodingFormat": "application/x-bam"}, {"name": "Reference", "encodingFormat": "application/x-fasta"}, {"name": "Intervals file"}, {"name": "db SNP", "encodingFormat": "application/x-vcf"}, {"name": "Tumor BAM", "encodingFormat": "application/x-bam"}, {"name": "Significance threshold"}, {"name": "Segmentation method"}, {"name": "Drop outliers"}, {"name": "Drop low coverage"}, {"name": "Y axis minimum"}, {"name": "Y axis maximum"}, {"name": "Width of margin"}, {"name": "Draw a trendline"}, {"name": "Segment color"}, {"name": "Gene(s)"}, {"name": "Chromosome"}, {"name": "By bin"}, {"name": "Background marker"}, {"name": "Antitarget marker"}, {"name": "Skip RepeatMasker"}, {"name": "No GC"}, {"name": "No edge"}, {"name": "Hard thresholds for calling each integer copy number"}, {"name": "Purity of cellularity"}, {"name": "Filter"}, {"name": "Center at:"}, {"name": "Center"}, {"name": "Title"}, {"name": "Copy number threshold"}, {"name": "No shift XY"}, {"name": "Minimum number of covered probes"}, {"name": "Minimum mapping quality score"}, {"name": "Count read midpoints"}], "original_input": [{"type": ["null", "int"], "label": "Minimal variant depth", "description": "Minimum read depth for a SNV to be displayed in the b-allele frequency plot. [Default: 20]", "id": "#min_variant_depth", "sbg:y": 29.48184085482356, "sbg:x": 858.8461642998911, "sbg:includeInPorts": true}, {"type": ["null", "string"], "label": "Zygosity freq", "description": "Ignore VCF's genotypes (GT field) and instead infer zygosity from allele frequencies. [Default if used without a number: 0.25]", "id": "#zygosity_freq", "sbg:y": 886.6616975464426, "sbg:x": 834.7437828015129, "sbg:includeInPorts": true}, {"type": ["null", "boolean"], "label": "Male reference", "description": "Was a male reference used? If so, expect half ploidy on chrX and chrY; otherwise, only chrY has half ploidy. In CNVkit, if a male reference was used, the \"neutral\" copy number (ploidy) of chrX is 1; chrY is haploid for either reference sex.", "id": "#male_reference", "sbg:y": 32.35067248413318, "sbg:x": 993.5048206318006, "sbg:includeInPorts": true}, {"type": ["null", "int"], "label": "Ploidy", "description": "Ploidy of the sample cells. [Default: 2]", "id": "#ploidy", "sbg:y": 883.7384182243239, "sbg:x": 697.3674593515175, "sbg:includeInPorts": true}, {"type": ["null", {"type": "enum", "symbols": ["male", "female"], "name": "gender"}], "label": "Gender", "description": "Specify the sample's chromosomal sex as male or female. (Otherwise guessed from X and Y coverage).", "id": "#gender", "sbg:y": 884.6101457838781, "sbg:x": 983.0769718428439, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Target BED", "description": "A BED file of baited regions for use with CNVkit obtained from CNVkit CNV Calling.", "sbg:fileTypes": "BED, LIST", "id": "#target_bed", "sbg:y": 713.000283369665, "sbg:x": 282.9744418386915, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Antitarget BED", "description": "A BED file with off-target/\u201dantitarget\u201d regions obtained from the CNVkit CNV Calling.", "sbg:fileTypes": "BED, LIST", "id": "#antitarget_bed", "sbg:y": 407.9233317699788, "sbg:x": 284.00007666074663, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Reference coverage file", "description": "Reference coverage file obtained from the CNVkit Reference.", "sbg:fileTypes": "CNN", "id": "#reference_coverage_file", "sbg:y": 270.76953453991, "sbg:x": 280.00031437395745, "sbg:includeInPorts": true}, {"type": [{"type": "array", "items": "File"}], "label": "Normal BAM", "description": "Normal BAM", "sbg:fileTypes": "BAM", "id": "#normal_bam", "secondaryFiles": [".bai"], "sbg:y": 10.769229392327858, "sbg:includeInPorts": true, "sbg:x": 281.5384333345297}, {"type": ["File"], "label": "Reference", "description": "Reference", "sbg:fileTypes": "FASTA, FA, FA.GZ, FASTA.GZ", "id": "#reference", "sbg:y": 841.5384984496076, "sbg:x": 283.0768986594727, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Intervals file", "description": "Interval file", "sbg:fileTypes": "BED", "id": "#bed_file", "sbg:y": -121.5384785465946, "sbg:x": 281.538430902378, "sbg:includeInPorts": true}, {"type": ["null", "File"], "label": "db SNP", "description": "dbSNP", "sbg:fileTypes": "VCF", "id": "#db_snp", "secondaryFiles": [".idx"], "sbg:y": 136.92310114396008, "sbg:includeInPorts": true, "sbg:x": 280.00001112620055}, {"type": ["File"], "label": "Tumor BAM", "description": "Tumor BAM", "sbg:fileTypes": "BAM", "id": "#bam_file", "secondaryFiles": [".bai"], "sbg:includeInPorts": true, "sbg:x": 283.3333141406367, "sbg:y": 568.3333966069771}, {"type": ["null", "float"], "label": "Significance threshold", "description": "Significance threshold (p-value or FDR, depending on method) to accept breakpoints during segmentation.", "id": "#significance_threshold", "sbg:category": "Optional arguments", "sbg:altPrefix": "-t", "sbg:stageInput": null}, {"type": ["null", {"type": "enum", "symbols": ["cbs", "haar", "flasso"], "name": "method"}], "label": "Segmentation method", "description": "Segmentation method (CBS, HaarSeg, or Fused Lasso).", "id": "#method", "sbg:category": "Optional arguments", "sbg:altPrefix": "-m", "sbg:stageInput": null, "sbg:toolDefaultValue": "cbs"}, {"type": ["null", "int"], "label": "Drop outliers", "description": "Drop outlier bins more than this many multiples of the 95th quantile away from the average within a rolling window. Set to 0 for no outlier filtering.", "id": "#drop_outliers", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "10"}, {"type": ["null", "boolean"], "label": "Drop low coverage", "description": "Drop very-low-coverage bins before segmentation to avoid false-positive deletions in poor-quality tumor samples.", "id": "#drop_low_coverage", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False"}, {"type": ["null", "float"], "label": "Y axis minimum", "description": "Y-axis lower limit.", "id": "#y_min", "sbg:category": "Plot aesthetics", "sbg:suggestedValue": -5}, {"type": ["null", "float"], "label": "Y axis maximum", "description": "Y-axis upper limit.", "id": "#y_max", "sbg:category": "Plot aesthetics", "sbg:suggestedValue": 5}, {"type": ["null", "int"], "label": "Width of margin", "description": "Width of margin to show around the selected gene or region on the chromosome (use with --gene or --region).", "id": "#width", "sbg:category": "Optional arguments", "sbg:altPrefix": "-w", "sbg:stageInput": null, "sbg:toolDefaultValue": "1000000"}, {"type": ["null", "boolean"], "label": "Draw a trendline", "description": "Draw a smoothed local trendline on the scatter plot.", "id": "#trend", "sbg:category": "Plot aesthetics", "sbg:altPrefix": "-t", "sbg:toolDefaultValue": "False"}, {"type": ["null", "string"], "label": "Segment color", "description": "Plot segment lines in this color. Value can be any string accepted by matplotlib, e.g. 'red' or '#CC0000'.", "id": "#segment_color", "sbg:category": "Plot aesthetics"}, {"type": ["null", {"type": "array", "items": "string"}], "label": "Gene(s)", "description": "Name of gene or genes (comma-separated) to display.", "id": "#genes", "sbg:category": "Optional arguments", "sbg:altPrefix": "-g", "sbg:stageInput": null}, {"type": ["null", "string"], "label": "Chromosome", "description": "Chromosome (e.g. 'chr1') or chromosomal range (e.g. 'chr1:2333000-2444000') to display. If a range is given, all targeted genes in this range will be shown, unless '--gene'/'-g' is already given.", "id": "#chromosome", "sbg:category": "Optional arguments", "sbg:altPrefix": "-c"}, {"type": ["null", "boolean"], "label": "By bin", "description": "Plot data x-coordinates by bin indices instead of genomic coordinates. All bins will be shown with equal width, no blank regions will be shown, and x-axis values indicate bin number (within chromosome) instead of genomic position.", "id": "#by_bin", "sbg:category": "Plot aesthetics", "sbg:stageInput": null, "sbg:toolDefaultValue": "False"}, {"type": ["null", "string"], "label": "Background marker", "description": "Plot antitargets with this symbol, in zoomed/selected regions.", "id": "#background_marker", "sbg:category": "Optional arguments", "sbg:altPrefix": "-b", "sbg:toolDefaultValue": "Same as targets"}, {"type": ["null", "string"], "label": "Antitarget marker", "description": "Plot antitargets using this symbol when plotting in a selected chromosomal region (-g/--gene or -c/--chromosome).", "id": "#antitarget_marker", "sbg:category": "Plot aesthetics", "sbg:altPrefix": "-a", "sbg:toolDefaultValue": "Same as targets"}, {"type": ["null", "boolean"], "label": "Skip RepeatMasker", "description": "Skip RepeatMasker correction.", "id": "#no_rmask", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"prefix": "--no-rmask", "separate": true, "sbg:cmdInclude": true, "position": 10}}, {"type": ["null", "boolean"], "label": "No GC", "description": "Skip GC correction.", "id": "#no_gc", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"prefix": "--no-gc", "separate": true, "sbg:cmdInclude": true, "position": 3}}, {"type": ["null", "boolean"], "label": "No edge", "description": "Skip edge-effect correction.", "id": "#no_edge", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"prefix": "--no-edge", "separate": true, "sbg:cmdInclude": true, "position": 4}}, {"type": ["null", {"type": "array", "items": "float"}], "label": "Hard thresholds for calling each integer copy number", "description": "Hard thresholds for calling each integer copy number, separated by commas.", "id": "#threshold", "sbg:category": "Optional arguments", "sbg:altPrefix": "-t", "sbg:toolDefaultValue": "-1.1,-0.25,0.2,0.7", "inputBinding": {"position": 3, "itemSeparator": ",", "valueFrom": {"engine": "#cwl-js-engine", "script": "{\n \n  if ($job.inputs.threshold){\n    \n    return '--thresholds=' + $job.inputs.threshold.join(',')\n    \n  } else {\n    \n    return ''\n    \n  }\n  \n}", "class": "Expression"}, "sbg:cmdInclude": true, "separate": false}}, {"type": ["null", "float"], "label": "Purity of cellularity", "description": "Estimated tumor cell fraction, a.k.a. purity or cellularity.", "id": "#purity", "sbg:category": "Optional arguments", "sbg:stageInput": null, "inputBinding": {"prefix": "--purity", "separate": true, "sbg:cmdInclude": true, "position": 5}}, {"type": ["null", {"type": "enum", "symbols": ["ampdel", "cn", "ci", "sem"], "name": "filter"}], "label": "Filter", "description": "Merge segments flagged by the specified filter(s) with the adjacent segment(s).", "id": "#filter", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "None", "inputBinding": {"prefix": "--filter", "separate": true, "sbg:cmdInclude": true, "position": 12}}, {"type": ["null", "float"], "label": "Center at:", "description": "Subtract a constant number from all log2 values. For \"manual\" re-centering, in case the --center option gives unsatisfactory results.)", "id": "#center_at", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "Calculated", "inputBinding": {"prefix": "--center-at", "separate": true, "sbg:cmdInclude": true, "position": 10}}, {"type": ["null", {"type": "enum", "symbols": ["mean", "median", "mode", "biweight"], "name": "center"}], "label": "Center", "description": "Re-center the log2 ratio values using this estimate of the center or average value.", "id": "#center", "sbg:category": "Optional arguments", "sbg:stageInput": null, "inputBinding": {"prefix": "--center", "separate": true, "sbg:cmdInclude": true, "position": 1}}, {"type": ["null", "string"], "label": "Title", "description": "Plot title.", "id": "#title", "sbg:category": "Plot aesthetics", "sbg:toolDefaultValue": "sample ID, from filename or -i", "inputBinding": {"prefix": "--title", "separate": true, "sbg:cmdInclude": true, "position": 20}}, {"type": ["null", "float"], "label": "Copy number threshold", "description": "Copy number change threshold to label genes.", "id": "#threshold_1", "sbg:category": "Optional arguments", "sbg:altPrefix": "-t", "sbg:stageInput": null, "sbg:toolDefaultValue": "0.5", "inputBinding": {"prefix": "--threshold", "separate": true, "sbg:cmdInclude": true, "position": 3}}, {"type": ["null", "boolean"], "label": "No shift XY", "description": "Don't adjust the X and Y chromosomes according to sample sex.", "id": "#no_shift_xy", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"prefix": "--no-shift-xy", "separate": true, "sbg:cmdInclude": true, "position": 30}}, {"type": ["null", "int"], "label": "Minimum number of covered probes", "description": "Minimum number of covered probes to label a gene.", "id": "#min_probes", "sbg:category": "Optional arguments", "sbg:altPrefix": "-m", "sbg:stageInput": null, "sbg:toolDefaultValue": "3", "inputBinding": {"prefix": "--min-probes", "separate": true, "sbg:cmdInclude": true, "position": 4}}, {"type": ["null", "int"], "label": "Minimum mapping quality score", "description": "Minimum mapping quality score (phred scale 0-60) to count a read for coverage depth.", "id": "#min_mapq", "sbg:category": "Optional arguments", "sbg:altPrefix": "-q", "sbg:stageInput": null, "sbg:toolDefaultValue": "0", "inputBinding": {"prefix": "--min-mapq", "separate": true, "sbg:cmdInclude": true, "position": 3}}, {"type": ["null", "boolean"], "label": "Count read midpoints", "description": "Get read depths by counting read midpoints within each bin. (An alternative algorithm).", "id": "#count", "sbg:category": "Optional arguments", "sbg:altPrefix": "-c", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"prefix": "--count", "separate": true, "sbg:cmdInclude": true, "position": 2}}], "output": [{"name": "CNV VCF"}, {"name": "CNV Calls"}, {"name": "CNV Scatter plot"}, {"name": "CNV Diagram"}], "applicationSuite": "CNVkitversion:0.9.3", "codeRepository": ["https://github.com/etal/cnvkit"], "applicationSubCategory": ["Copy Number Analysis"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126714, "sbg:revisionNotes": "Copy of milos.nikolic/cnvkit-cnv-calling-wxs/cnvkit-pipeline-from-baseline-093-hc/11"}, {"sbg:revision": 1, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126714, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 2, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126715, "sbg:revisionNotes": "Fixed SBG Rename App"}, {"sbg:revision": 3, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126715, "sbg:revisionNotes": "Fixed SBG Rename App"}, {"sbg:revision": 4, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126715, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 5, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126715, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 6, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126715, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 7, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126715, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 8, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126716, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 9, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1539684809, "sbg:revisionNotes": "Fixed SBG Rename App and added .bai for the Tumor BAM input."}, {"sbg:revision": 10, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1545923056, "sbg:revisionNotes": "Update SBG Rename App"}, {"sbg:revision": 11, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563372431, "sbg:revisionNotes": "added google instance hint on CNVkit coverage antitarget"}, {"sbg:revision": 12, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1584567061, "sbg:revisionNotes": "Updated description - added warning about # and ~ in filenames"}, {"sbg:revision": 13, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648048901, "sbg:revisionNotes": "updated categories"}, {"sbg:revision": 14, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648048902, "sbg:revisionNotes": "updated azure instance hints"}], "creator": "Eric Talevich", "dateModified": 1648048902, "dateCreated": 1535126714, "contributor": ["admin"], "sdPublisher": "sbg", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_admin/sbg-public-data/cnvkit-reference/13", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/admin/sbg-public-data/cnvkit-reference/13", "applicationCategory": "Workflow", "version": "sbg:draft-2", "name": "CNVkit Reference", "description": "CNVkit analyses copy number variants in exome, targeted, amplicon, hybrid and whole-genome DNA sequencing. \n\nThis toolkit takes advantage of both on\u2013 and off-target sequencing reads and applies a series of corrections to improve accuracy in copy number calling.[1]\n\n*A list of **all inputs and parameters** with corresponding descriptions can be found at the bottom of the page.*\n\n### Common Use Cases\n\n* **CNVkit Reference** creates a **Reference coverage file** from the normal samples. Also, the workflow creates a **Target BED file** of baited regions and an **Antitarget BED file** of regions not included in the Target BED file. All three files are prerequisites for further CNV Calling workflows.\n\n* A **Reference coverage file** should be constructed specifically for each target capture panel, using a BED file that lists the genomic coordinates of the baited regions. Ideally, the control or \u201cnormal\u201d samples that are used to build the reference should match the type of sample (e.g. FFPE-extracted or fresh DNA) and library preparation protocol or kit used for the test (e.g. tumor) samples.[2]\n\n* A **Reference coverage file** needs to be created for both genders in separate runs; one run with only normal female, the other one with only male normal samples. The parameter **Male reference** should be set to *True* or *False* in accordance with the gender of the input samples.\n\n* In order to obtain annotated CNV (name of the genes that are located in the CNV regions), an **Annotation File** input must be provided (eg. hg19 annotation - [refFlat19](http://hgdownload.soe.ucsc.edu/goldenPath/hg19/database/refFlat.txt.gz)).\n\n* If the sequencing type is **Amplicon**, parameter **Split** for the CNVkit-target tool and parameter **No edge** in the CNVkit reference tool  should be set to *True*.\n\n### Changes Introduced by Seven Bridges\n\n* No modifications to the original tool representation have been made, apart from the automation of file naming.\n\n### Common Issues and Important Notes\n\n* The number of samples should be under 40, because exceeding this number would not make any statistical difference.\n\n* The total memory of samples can not exceed 4 TB (important when samples are high-coverage WES or WGS).\n\n\n### Performance Benchmarking\n\nThe instance set for this workflow is the AWS c5.9xlarge instance with 36 vCPUs, 72 GiB of RAM and EBS (disk space) set to 4 TB.\n\n| Number of BAM files  (average size in GB) | Type | Duration | Cost  |\n|-------------------------------------------|------|----------|-------|\n|                  12 (11)                  |  WES |    29m   | $0.73 |\n|                   18 (11)                 |  WES |    38m   | $0.97 |\n|                  36 (11)                  |  WES |  1h 12m  | $1.87 |\n|                  10 (159)                 |  WGS |  5h 15m  | $8 |\n\n*Cost can be significantly reduced by using **spot instances**. Visit the [Knowledge Center](https://docs.sevenbridges.com/docs/about-spot-instances) for more details.*\n\n### API Python Implementation\nThe app's draft task can also be submitted via the **API**. In order to learn how to get your **Authentication token** and **API endpoint** for the corresponding platform, visit our [documentation](https://github.com/sbg/sevenbridges-python#authentication-and-configuration).\n\n```python\n# Initialize the SBG Python API\nfrom sevenbridges import Api\napi = Api(token=\"enter_your_token\", url=\"enter_api_endpoint\")\n# Get project_id/app_id from your address bar. Example: https://igor.sbgenomics.com/u/your_username/project/app\nproject_id = \"your_username/project\"\napp_id = \"your_username/project/app\"\n# Replace inputs with appropriate values\ninputs = {\n    \"fa_fname\": api.files.query(project=project_id, names=[\"enter_filename\"])[0],\n    \"data_type\": \"WXS\",\n    \"bam_files\": list(api.files.query(project=project_id, names=[\"enter_filename\", \"enter_filename\"])),\n    \"targets_file\": api.files.query(project=project_id, names=[\"enter_filename\"])[0]}\n# Creates draft task\ntask = api.tasks.create(name=\"CNVkit Reference - API Run\", project=project_id, app=app_id, inputs=inputs, run=False)\n```\n\nInstructions for installing and configuring the API Python client are provided on [github](https://github.com/sbg/sevenbridges-python#installation). For more information about using the API Python client, consult [the client documentation](http://sevenbridges-python.readthedocs.io/en/latest/). **More examples** are available [here](https://github.com/sbg/okAPI).\n\nAdditionally, [API R](https://github.com/sbg/sevenbridges-r) and [API Java](https://github.com/sbg/sevenbridges-java) clients are available. To learn more about using these API clients, please refer to the [API R client documentation](https://sbg.github.io/sevenbridges-r/), and [API Java client documentation](https://docs.sevenbridges.com/docs/java-library-quickstart).\n\n###References\n\n[1] [CNVkit: Genome-Wide Copy Number Detection and Visualization from Targeted DNA Sequencing](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4839673/)\n\n[2] [CNVkit reference](https://cnvkit.readthedocs.io/en/stable/pipeline.html#reference)", "input": [{"name": "Reference Fasta", "encodingFormat": "application/x-fasta"}, {"name": "Annotation File", "encodingFormat": "text/plain"}, {"name": "Data type"}, {"name": "Count"}, {"name": "Min mapping quality"}, {"name": "Normal BAMs", "encodingFormat": "application/x-bam"}, {"name": "Interval File"}, {"name": "Minimum gap size"}, {"name": "Split"}, {"name": "Average size of split target bins"}, {"name": "Antitarget minimum size"}, {"name": "Target minimum size"}, {"name": "Target maximum size"}, {"name": "BP per bin"}, {"name": "Antitarget minimum size"}, {"name": "Antitarget maximum size"}, {"name": "Male reference"}, {"name": "No GC"}, {"name": "No edge"}, {"name": "No RMask"}], "original_input": [{"type": ["File"], "label": "Reference Fasta", "description": "Reference Fasta", "sbg:fileTypes": "FASTA, FA", "id": "#fa_fname", "sbg:y": 119.88890129422418, "sbg:x": 116.34921521989136, "sbg:includeInPorts": true}, {"type": ["null", "File"], "label": "Annotation File", "description": "Gene annotation databases, e.g. RefSeq or Ensembl, available in \u201cflat\u201d format from UCSC.", "sbg:fileTypes": "TXT, TEXT, BED, INTERVAL", "id": "#annotation_file", "sbg:y": 531.1111115761742, "sbg:x": 121.11111465501179, "sbg:includeInPorts": true}, {"type": [{"type": "enum", "symbols": ["WXS", "Targeted", "WGS", "Hybrid", "Amplicon"], "name": "data_type"}], "label": "Data type", "description": "Data type", "id": "#data_type", "sbg:y": 666.666636531736, "sbg:x": 117.77778302298633, "sbg:includeInPorts": true}, {"type": ["null", "boolean"], "label": "Count", "description": "Get read depths by counting read midpoints within each bin. (An alternative algorithm).", "id": "#count", "sbg:y": 120.51284244683175, "sbg:x": 492.7840611349635, "sbg:includeInPorts": true}, {"type": ["null", "int"], "label": "Min mapping quality", "description": "Minimum mapping quality score (phred scale 0-60) to count a read for coverage depth.", "id": "#min_mapq", "sbg:y": 646.7033022756266, "sbg:x": 484.67049373600685, "sbg:includeInPorts": true}, {"type": [{"type": "array", "items": "File"}], "label": "Normal BAMs", "description": "Normal Sample BAM", "sbg:fileTypes": "BAM", "id": "#bam_files", "sbg:y": 402.2221878310787, "sbg:x": 116.66666103292403, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Interval File", "description": "A BED file of baited regions.", "sbg:fileTypes": "BED, LIST", "id": "#targets_file", "sbg:y": 269.9999928474426, "sbg:x": 116.66666594258055, "sbg:includeInPorts": true}, {"type": ["null", "int"], "label": "Minimum gap size", "description": "Minimum gap size between accessible sequence regions. Regions separated by less than this distance will be joined together.", "id": "#min_gap_size", "sbg:category": "Optional arguments", "sbg:altPrefix": "-s", "sbg:toolDefaultValue": "5000", "sbg:stageInput": null}, {"type": ["null", "boolean"], "label": "Split", "description": "Split large tiled intervals into smaller, consecutive targets.", "id": "#split", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"prefix": "--split", "position": 3, "sbg:cmdInclude": true, "separate": true}}, {"type": ["null", "float"], "label": "Average size of split target bins", "description": "Average size of split target bins (results are approximate). Split flag must be raised for this input to have effect.", "id": "#avg_size", "sbg:category": "Optional arguments", "sbg:altPrefix": "-a", "sbg:toolDefaultValue": "266.666666667", "inputBinding": {"prefix": "--avg-size", "position": 4, "sbg:cmdInclude": true, "separate": true}}, {"type": ["null", "float"], "label": "Antitarget minimum size", "description": "Minimum size of antitarget bins (smaller regions are dropped).", "id": "#min_size", "sbg:category": "Optional arguments", "sbg:altPrefix": "-m", "sbg:toolDefaultValue": "1/16 avg size, calculated", "sbg:stageInput": null, "inputBinding": {"prefix": "--min-size", "position": 3, "sbg:cmdInclude": true, "separate": true}}, {"type": ["null", "float"], "label": "Target minimum size", "description": "Minimum size of target bins.", "id": "#target_min_size", "sbg:category": "Optional arguments", "sbg:toolDefaultValue": "0", "inputBinding": {"prefix": "--target-min-size", "sbg:cmdInclude": true, "position": 20, "separate": true}}, {"type": ["null", "float"], "label": "Target maximum size", "description": "Maximum size of target bins.", "id": "#target_max_size", "sbg:category": "Optional arguments", "sbg:toolDefaultValue": "None", "inputBinding": {"prefix": "--target-max-size", "sbg:cmdInclude": true, "position": 12, "separate": true}}, {"type": ["null", "float"], "label": "BP per bin", "description": "Desired average number of sequencing read bases mapped to each bin.", "id": "#bp_per_bin", "sbg:stageInput": null, "sbg:category": "Optional arguments", "sbg:toolDefaultValue": "100000.0", "inputBinding": {"prefix": "--bp-per-bin", "sbg:cmdInclude": true, "position": 18, "separate": true}}, {"type": ["null", "float"], "label": "Antitarget minimum size", "description": "Minimum size of antitarget bins (smaller regions are dropped).", "id": "#antitarget_min_size", "sbg:category": "Optional arguments", "inputBinding": {"prefix": "--antitarget-min-size", "sbg:cmdInclude": true, "position": 15, "separate": true}}, {"type": ["null", "float"], "label": "Antitarget maximum size", "description": "Maximum size of antitarget bins.", "id": "#antitarget_max_size", "sbg:category": "Optional arguments", "sbg:toolDefaultValue": "None", "inputBinding": {"prefix": "--antitarget-max-size", "sbg:cmdInclude": true, "position": 14, "separate": true}}, {"type": ["null", "boolean"], "label": "Male reference", "description": "Create a male reference: shift female samples' chrX log-coverage by -1, so the reference chrX average is -1. Otherwise, shift male samples' chrX by +1, so the reference chrX average is 0.", "id": "#male_reference", "sbg:stageInput": null, "inputBinding": {"sbg:cmdInclude": true, "prefix": "--male-reference", "separate": true, "position": 4}, "sbg:toolDefaultValue": "False", "sbg:category": "Optional arguments", "sbg:altPrefix": "-y"}, {"type": ["null", "boolean"], "label": "No GC", "description": "Skip GC correction.", "id": "#no_gc", "sbg:stageInput": null, "inputBinding": {"sbg:cmdInclude": true, "prefix": "--no-gc", "separate": true, "position": 5}, "sbg:toolDefaultValue": "False", "sbg:category": "Optional arguments"}, {"type": ["null", "boolean"], "label": "No edge", "description": "Skip edge-effect correction.", "id": "#no_edge", "sbg:stageInput": null, "inputBinding": {"sbg:cmdInclude": true, "prefix": "--no-edge", "separate": true, "position": 6}, "sbg:toolDefaultValue": "False", "sbg:category": "Optional arguments"}, {"type": ["null", "boolean"], "label": "No RMask", "description": "Skip RepeatMasker correction.", "id": "#no_rmask", "sbg:stageInput": null, "inputBinding": {"sbg:cmdInclude": true, "prefix": "--no-rmask", "separate": true, "position": 7}, "sbg:toolDefaultValue": "False", "sbg:category": "Optional arguments"}], "output": [{"name": "Reference coverage file"}, {"name": "Antitarget BED"}, {"name": "Target BED"}], "applicationSuite": "CNVkitversion:0.9.3", "codeRepository": ["https://github.com/etal/cnvkit"], "applicationSubCategory": ["Copy Number Analysis"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126716, "sbg:revisionNotes": "Copy of milos.nikolic/control-freec-11-5/cnvkit-reference/0"}, {"sbg:revision": 1, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126716, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 2, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126716, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 3, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126716, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 4, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126716, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 5, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126716, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 6, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1545923057, "sbg:revisionNotes": "Update docker image on SBG tools"}, {"sbg:revision": 7, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1545932193, "sbg:revisionNotes": "Update FlattenLists tool"}, {"sbg:revision": 8, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563372433, "sbg:revisionNotes": "Updated CNVkit-reference description."}, {"sbg:revision": 9, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563372433, "sbg:revisionNotes": "added google instance hint"}, {"sbg:revision": 10, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563372433, "sbg:revisionNotes": "added google instance hint"}, {"sbg:revision": 11, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648048903, "sbg:revisionNotes": "updated categories"}, {"sbg:revision": 12, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648048903, "sbg:revisionNotes": "updated Azure instance hint"}, {"sbg:revision": 13, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1649765577, "sbg:revisionNotes": "Uploaded using sbpack v2022.03.16. \nSource: Desktop/cnvkit_ref.cwl"}], "creator": "Eric Talevich", "dateModified": 1649765577, "dateCreated": 1535126716, "contributor": ["admin"], "sdPublisher": "sbg", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_admin/sbg-public-data/cnvkit-pipeline-from-baseline-093-hc-to/22", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/admin/sbg-public-data/cnvkit-pipeline-from-baseline-093-hc-to/22", "applicationCategory": "Workflow", "version": "sbg:draft-2", "name": "CNVkit Tumor-Only CNV Calling with GATK HaplotypeCaller", "description": "CNVkit analyses copy number variants in exome, targeted, amplicon, hybrid and whole-genome DNA sequencing. \n\nThis toolkit takes advantage of both on\u2013 and off-target sequencing reads and applies a series of corrections to improve accuracy in copy number calling.[1]\n\n*A list of **all inputs and parameters** with corresponding descriptions can be found at the bottom of the page.*\n### Common Use Cases\n\n* The **CNVkit CNV Calling** workflow determines copy number alterations and variations. \n\n* For a deeper CNV analysis (eg. determining loss of heterozygosity regions), an additional step of calling the germline mutations in a tumor sample must be performed. This pipeline employs **GATK HaplotypeCaller** as germline variant caller.\n\n* This workflow is to be run in the case where no matched normal sample for a tumor sample is available.\n\n* **CNVkit Reference** must be run prior to running this workflow. **CNVkit Reference** output files, **Reference coverage file**, **Target** and **Antitarget BED** are the required inputs for this workflow.\n\n* For proper CNV detection in sex chromosomes, corresponding inputs must be set in the **Gender** and the **Male reference** parameters (eg. for female sample: **Gender**: *female*, **Male reference**: *False*).\n\n### Changes Introduced by Seven Bridges\n\n* Outputs are named based on the **Tumor BAM Sample ID** metadata field.\n\n### Common Issues and Important Notes\n\n* **CNVkit Reference** must be run prior to running this workflow. **CNVkit Reference** output files, **Reference coverage file**, **Target** and **Antitarget BED** are the required inputs for this workflow.\n\n* For proper CNV detection in sex chromosomes, corresponding inputs must be set in the **Gender** and the **Male reference** parameters (eg. for female sample: **Gender**: *female*, **Male reference**: *False*).\n\n* A db SNP file must be provided in order to exclude somatic mutations in a tumor sample.\n\n* This workflow might not work with filenames containing some special characters e.g. **#**, **~**.\n\n\n### Performance Benchmarking\n\nThe instances set for this workflow are the AWS c4.2xlarge instance with 8vCPUs, 15 GiB of RAM with 1 TB of EBS (disk space) and the c5.9xlarge instance with 36 vCPUs, 72 GiB of RAM with EBS set to 1 TB.\n\n\n| BAM size (GB) | Type | Duration | Cost  |\n|---------------|------|----------|-------|\n|       12      | WES  | 21m       | $0.53 |\n|      144      | WGS  | 3h 42m       | $5.66 |\n\n*Cost can be significantly reduced by using **spot instances**. Visit the [Knowledge Center](https://docs.sevenbridges.com/docs/about-spot-instances) for more details.*\n\n### API Python Implementation\nThe app's draft task can also be submitted via the **API**. In order to learn how to get your **Authentication token** and **API endpoint** for the corresponding platform, visit our [documentation](https://github.com/sbg/sevenbridges-python#authentication-and-configuration).\n\n```python\n# Initialize the SBG Python API\nfrom sevenbridges import Api\napi = Api(token=\"enter_your_token\", url=\"enter_api_endpoint\")\n# Get project_id/app_id from your address bar. Example: https://igor.sbgenomics.com/u/your_username/project/app\nproject_id = \"your_username/project\"\napp_id = \"your_username/project/app\"\n# Replace inputs with appropriate values\ninputs = {\n\t\"tumor_bam\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"target_bed\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"antitarget_bed\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"reference_coverage_file\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"reference\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"db_snp\": api.files.query(project=project_id, names=[\"enter_filename\"])[0], \n\t\"bed_file\": api.files.query(project=project_id, names=[\"enter_filename\"])[0]}\n# Creates draft task\ntask = api.tasks.create(name=\"CNVkit Tumor-Only CNV Calling with GATK HaplotypeCaller - API Run\", project=project_id, app=app_id, inputs=inputs, run=False)\n```\n\nInstructions for installing and configuring the API Python client are provided on [github](https://github.com/sbg/sevenbridges-python#installation). For more information about using the API Python client, consult [the client documentation](http://sevenbridges-python.readthedocs.io/en/latest/). **More examples** are available [here](https://github.com/sbg/okAPI).\n\nAdditionally, [API R](https://github.com/sbg/sevenbridges-r) and [API Java](https://github.com/sbg/sevenbridges-java) clients are available. To learn more about using these API clients, please refer to the [API R client documentation](https://sbg.github.io/sevenbridges-r/), and [API Java client documentation](https://docs.sevenbridges.com/docs/java-library-quickstart).\n\n###References\n\n[1] [CNVkit: Genome-Wide Copy Number Detection and Visualization from Targeted DNA Sequencing](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4839673/)", "input": [{"name": "Minimal variant depth"}, {"name": "Zygosity freq"}, {"name": "Male reference"}, {"name": "Ploidy"}, {"name": "Gender"}, {"name": "Target BED"}, {"name": "Antitarget BED"}, {"name": "Reference coverage file"}, {"name": "Reference", "encodingFormat": "application/x-fasta"}, {"name": "dbSNP", "encodingFormat": "application/x-vcf"}, {"name": "Intervals file"}, {"name": "Tumor BAM", "encodingFormat": "application/x-bam"}, {"name": "Significance threshold"}, {"name": "Segmentation method"}, {"name": "Drop outliers"}, {"name": "Drop low coverage"}, {"name": "Y axis minimum"}, {"name": "Y axis maximum"}, {"name": "Width of margin"}, {"name": "Draw a trendline"}, {"name": "Segment color"}, {"name": "Gene(s)"}, {"name": "Chromosome"}, {"name": "By bin"}, {"name": "Background marker"}, {"name": "Antitarget marker"}, {"name": "Skip RepeatMasker"}, {"name": "No GC"}, {"name": "No edge"}, {"name": "Hard thresholds for calling each integer copy number"}, {"name": "Purity of cellularity"}, {"name": "Filter"}, {"name": "Center at:"}, {"name": "Center"}, {"name": "Title"}, {"name": "Copy number threshold"}, {"name": "No shift XY"}, {"name": "Minimum number of covered probes"}, {"name": "Exclude expression"}, {"name": "Minimum mapping quality score"}, {"name": "Count read midpoints"}], "original_input": [{"type": ["null", "int"], "label": "Minimal variant depth", "description": "Minimum read depth for a SNV to be displayed in the b-allele frequency plot. [Default: 20]", "id": "#min_variant_depth", "sbg:y": -90.18483933547492, "sbg:x": 854.0256679068266, "sbg:includeInPorts": true}, {"type": ["null", "string"], "label": "Zygosity freq", "description": "Ignore VCF's genotypes (GT field) and instead infer zygosity from allele frequencies. [Default if used without a number: 0.25]", "id": "#zygosity_freq", "sbg:y": 824.995030879776, "sbg:x": 764.7437828015129, "sbg:includeInPorts": true}, {"type": ["null", "boolean"], "label": "Male reference", "description": "Was a male reference used? If so, expect half ploidy on chrX and chrY; otherwise, only chrY has half ploidy. In CNVkit, if a male reference was used, the \"neutral\" copy number (ploidy) of chrX is 1; chrY is haploid for either reference sex.", "id": "#male_reference", "sbg:y": -95.98266308768574, "sbg:x": 1008.5047990284274, "sbg:includeInPorts": true}, {"type": ["null", "int"], "label": "Ploidy", "description": "Ploidy of the sample cells. [Default: 2]", "id": "#ploidy", "sbg:y": 825.405062691571, "sbg:x": 609.0340796325233, "sbg:includeInPorts": true}, {"type": ["null", {"type": "enum", "symbols": ["male", "female"], "name": "gender"}], "label": "Gender", "description": "Specify the sample's chromosomal sex as male or female. (Otherwise guessed from X and Y coverage).", "id": "#gender", "sbg:y": 831.2768702749484, "sbg:x": 913.0770043960007, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Target BED", "description": "A BED file of baited regions for use with CNVkit obtained from CNVkit CNV Calling.", "sbg:fileTypes": "BED, LIST", "id": "#target_bed", "sbg:y": 713.000283369665, "sbg:x": 282.9744418386915, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Antitarget BED", "description": "A BED file with off-target/\u201dantitarget\u201d regions obtained from the CNVkit CNV Calling.", "sbg:fileTypes": "BED, LIST", "id": "#antitarget_bed", "sbg:y": 407.9233317699788, "sbg:x": 284.00007666074663, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Reference coverage file", "description": "Reference coverage file obtained from the CNVkit Reference.", "sbg:fileTypes": "CNN", "id": "#reference_coverage_file", "sbg:y": 270.76953453991, "sbg:x": 280.00031437395745, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Reference", "description": "Reference", "sbg:fileTypes": "FASTA, FA, FA.GZ, FASTA.GZ", "id": "#reference", "sbg:y": 146.66667175292974, "sbg:x": 276.0000101725261, "sbg:includeInPorts": true}, {"type": ["File"], "label": "dbSNP", "description": "dbSNP", "sbg:fileTypes": "VCF", "id": "#db_snp", "secondaryFiles": [".idx"], "sbg:y": -119.9999923706055, "sbg:x": 272.0000305175782, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Intervals file", "description": "Intervals file", "sbg:fileTypes": "BED", "id": "#bed_file", "sbg:y": 13.333335876464844, "sbg:x": 273.33333841959643, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Tumor BAM", "description": "Tumor BAM", "sbg:fileTypes": "BAM", "id": "#bam_file", "secondaryFiles": [".bai"], "sbg:includeInPorts": true, "sbg:x": 283.3333157036033, "sbg:y": 573.3333355718185}, {"type": ["null", "float"], "label": "Significance threshold", "description": "Significance threshold (p-value or FDR, depending on method) to accept breakpoints during segmentation.", "id": "#significance_threshold", "sbg:category": "Optional arguments", "sbg:altPrefix": "-t", "sbg:stageInput": null}, {"type": ["null", {"type": "enum", "symbols": ["cbs", "haar", "flasso"], "name": "method"}], "label": "Segmentation method", "description": "Segmentation method (CBS, HaarSeg, or Fused Lasso).", "id": "#method", "sbg:category": "Optional arguments", "sbg:altPrefix": "-m", "sbg:stageInput": null, "sbg:toolDefaultValue": "cbs"}, {"type": ["null", "int"], "label": "Drop outliers", "description": "Drop outlier bins more than this many multiples of the 95th quantile away from the average within a rolling window. Set to 0 for no outlier filtering.", "id": "#drop_outliers", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "10"}, {"type": ["null", "boolean"], "label": "Drop low coverage", "description": "Drop very-low-coverage bins before segmentation to avoid false-positive deletions in poor-quality tumor samples.", "id": "#drop_low_coverage", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False"}, {"type": ["null", "float"], "label": "Y axis minimum", "description": "Y-axis lower limit.", "id": "#y_min", "sbg:category": "Plot aesthetics", "sbg:suggestedValue": -5}, {"type": ["null", "float"], "label": "Y axis maximum", "description": "Y-axis upper limit.", "id": "#y_max", "sbg:category": "Plot aesthetics", "sbg:suggestedValue": 5}, {"type": ["null", "int"], "label": "Width of margin", "description": "Width of margin to show around the selected gene or region on the chromosome (use with --gene or --region).", "id": "#width", "sbg:category": "Optional arguments", "sbg:altPrefix": "-w", "sbg:stageInput": null, "sbg:toolDefaultValue": "1000000"}, {"type": ["null", "boolean"], "label": "Draw a trendline", "description": "Draw a smoothed local trendline on the scatter plot.", "id": "#trend", "sbg:category": "Plot aesthetics", "sbg:altPrefix": "-t", "sbg:toolDefaultValue": "False"}, {"type": ["null", "string"], "label": "Segment color", "description": "Plot segment lines in this color. Value can be any string accepted by matplotlib, e.g. 'red' or '#CC0000'.", "id": "#segment_color", "sbg:category": "Plot aesthetics"}, {"type": ["null", {"type": "array", "items": "string"}], "label": "Gene(s)", "description": "Name of gene or genes (comma-separated) to display.", "id": "#genes", "sbg:category": "Optional arguments", "sbg:altPrefix": "-g", "sbg:stageInput": null}, {"type": ["null", "string"], "label": "Chromosome", "description": "Chromosome (e.g. 'chr1') or chromosomal range (e.g. 'chr1:2333000-2444000') to display. If a range is given, all targeted genes in this range will be shown, unless '--gene'/'-g' is already given.", "id": "#chromosome", "sbg:category": "Optional arguments", "sbg:altPrefix": "-c"}, {"type": ["null", "boolean"], "label": "By bin", "description": "Plot data x-coordinates by bin indices instead of genomic coordinates. All bins will be shown with equal width, no blank regions will be shown, and x-axis values indicate bin number (within chromosome) instead of genomic position.", "id": "#by_bin", "sbg:category": "Plot aesthetics", "sbg:stageInput": null, "sbg:toolDefaultValue": "False"}, {"type": ["null", "string"], "label": "Background marker", "description": "Plot antitargets with this symbol, in zoomed/selected regions.", "id": "#background_marker", "sbg:category": "Optional arguments", "sbg:altPrefix": "-b", "sbg:toolDefaultValue": "Same as targets"}, {"type": ["null", "string"], "label": "Antitarget marker", "description": "Plot antitargets using this symbol when plotting in a selected chromosomal region (-g/--gene or -c/--chromosome).", "id": "#antitarget_marker", "sbg:category": "Plot aesthetics", "sbg:altPrefix": "-a", "sbg:toolDefaultValue": "Same as targets"}, {"type": ["null", "boolean"], "label": "Skip RepeatMasker", "description": "Skip RepeatMasker correction.", "id": "#no_rmask", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"prefix": "--no-rmask", "separate": true, "sbg:cmdInclude": true, "position": 10}}, {"type": ["null", "boolean"], "label": "No GC", "description": "Skip GC correction.", "id": "#no_gc", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"prefix": "--no-gc", "separate": true, "sbg:cmdInclude": true, "position": 3}}, {"type": ["null", "boolean"], "label": "No edge", "description": "Skip edge-effect correction.", "id": "#no_edge", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"prefix": "--no-edge", "separate": true, "sbg:cmdInclude": true, "position": 4}}, {"type": ["null", {"type": "array", "items": "float"}], "label": "Hard thresholds for calling each integer copy number", "description": "Hard thresholds for calling each integer copy number, separated by commas.", "id": "#threshold", "sbg:category": "Optional arguments", "sbg:altPrefix": "-t", "sbg:toolDefaultValue": "-1.1,-0.25,0.2,0.7", "inputBinding": {"position": 3, "itemSeparator": ",", "valueFrom": {"engine": "#cwl-js-engine", "script": "{\n \n  if ($job.inputs.threshold){\n    \n    return '--thresholds=' + $job.inputs.threshold.join(',')\n    \n  } else {\n    \n    return ''\n    \n  }\n  \n}", "class": "Expression"}, "sbg:cmdInclude": true, "separate": false}}, {"type": ["null", "float"], "label": "Purity of cellularity", "description": "Estimated tumor cell fraction, a.k.a. purity or cellularity.", "id": "#purity", "sbg:category": "Optional arguments", "sbg:stageInput": null, "inputBinding": {"prefix": "--purity", "separate": true, "sbg:cmdInclude": true, "position": 5}}, {"type": ["null", {"type": "enum", "symbols": ["ampdel", "cn", "ci", "sem"], "name": "filter"}], "label": "Filter", "description": "Merge segments flagged by the specified filter(s) with the adjacent segment(s).", "id": "#filter", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "None", "inputBinding": {"prefix": "--filter", "separate": true, "sbg:cmdInclude": true, "position": 12}}, {"type": ["null", "float"], "label": "Center at:", "description": "Subtract a constant number from all log2 values. For \"manual\" re-centering, in case the --center option gives unsatisfactory results.)", "id": "#center_at", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "Calculated", "inputBinding": {"prefix": "--center-at", "separate": true, "sbg:cmdInclude": true, "position": 10}}, {"type": ["null", {"type": "enum", "symbols": ["mean", "median", "mode", "biweight"], "name": "center"}], "label": "Center", "description": "Re-center the log2 ratio values using this estimate of the center or average value.", "id": "#center", "sbg:category": "Optional arguments", "sbg:stageInput": null, "inputBinding": {"prefix": "--center", "separate": true, "sbg:cmdInclude": true, "position": 1}}, {"type": ["null", "string"], "label": "Title", "description": "Plot title.", "id": "#title", "sbg:category": "Plot aesthetics", "sbg:toolDefaultValue": "sample ID, from filename or -i", "inputBinding": {"prefix": "--title", "separate": true, "sbg:cmdInclude": true, "position": 20}}, {"type": ["null", "float"], "label": "Copy number threshold", "description": "Copy number change threshold to label genes.", "id": "#threshold_1", "sbg:category": "Optional arguments", "sbg:altPrefix": "-t", "sbg:stageInput": null, "sbg:toolDefaultValue": "0.5", "inputBinding": {"prefix": "--threshold", "separate": true, "sbg:cmdInclude": true, "position": 3}}, {"type": ["null", "boolean"], "label": "No shift XY", "description": "Don't adjust the X and Y chromosomes according to sample sex.", "id": "#no_shift_xy", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"prefix": "--no-shift-xy", "separate": true, "sbg:cmdInclude": true, "position": 30}}, {"type": ["null", "int"], "label": "Minimum number of covered probes", "description": "Minimum number of covered probes to label a gene.", "id": "#min_probes", "sbg:category": "Optional arguments", "sbg:altPrefix": "-m", "sbg:stageInput": null, "sbg:toolDefaultValue": "3", "inputBinding": {"prefix": "--min-probes", "separate": true, "sbg:cmdInclude": true, "position": 4}}, {"type": ["null", "string"], "label": "Exclude expression", "description": "Exclude sites for which the expression is true.", "id": "#exclude_expression", "sbg:category": "Configuration", "sbg:suggestedValue": "'ID=\".\"'"}, {"type": ["null", "int"], "label": "Minimum mapping quality score", "description": "Minimum mapping quality score (phred scale 0-60) to count a read for coverage depth.", "id": "#min_mapq", "sbg:category": "Optional arguments", "sbg:altPrefix": "-q", "sbg:stageInput": null, "sbg:toolDefaultValue": "0", "inputBinding": {"prefix": "--min-mapq", "separate": true, "sbg:cmdInclude": true, "position": 3}}, {"type": ["null", "boolean"], "label": "Count read midpoints", "description": "Get read depths by counting read midpoints within each bin. (An alternative algorithm).", "id": "#count", "sbg:category": "Optional arguments", "sbg:altPrefix": "-c", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"prefix": "--count", "separate": true, "sbg:cmdInclude": true, "position": 2}}], "output": [{"name": "CNV VCF"}, {"name": "CNV Calls"}, {"name": "CNV Scatter plot"}, {"name": "CNV Diagram"}], "applicationSuite": "CNVkitversion:0.9.3", "codeRepository": ["https://github.com/etal/cnvkit"], "applicationSubCategory": ["Copy Number Analysis"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126717, "sbg:revisionNotes": "Copy of milos.nikolic/cnvkit-cnv-calling-wxs/cnvkit-pipeline-from-baseline-093-hc-to/11"}, {"sbg:revision": 1, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126717, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 2, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126717, "sbg:revisionNotes": "Final"}, {"sbg:revision": 3, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126717, "sbg:revisionNotes": "Updated Description"}, {"sbg:revision": 4, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126717, "sbg:revisionNotes": "Fixed SBG Rename App"}, {"sbg:revision": 5, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126717, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 6, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126717, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 7, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126717, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 8, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126717, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 9, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126718, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 10, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126718, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 11, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126718, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 12, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126718, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 13, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126718, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 14, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126718, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 15, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126718, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 16, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126718, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 17, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1539684810, "sbg:revisionNotes": "Fixed SBG Rename App and added .bai as secondary to the Tumor BAM input."}, {"sbg:revision": 18, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1545923057, "sbg:revisionNotes": "Update SBG Rename App"}, {"sbg:revision": 19, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563372432, "sbg:revisionNotes": "added google instance hint on cnvkit coverage antitarget tool"}, {"sbg:revision": 20, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1584567062, "sbg:revisionNotes": "Updated description - added warning about # and ~ in filenames"}, {"sbg:revision": 21, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648048904, "sbg:revisionNotes": "updated categories"}, {"sbg:revision": 22, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648048904, "sbg:revisionNotes": "updated azure instance type"}], "creator": "Eric Talevich", "dateModified": 1648048904, "dateCreated": 1535126717, "contributor": ["admin"], "sdPublisher": "sbg", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_admin/sbg-public-data/cnvkit-reference-wf-no-normals/30", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/admin/sbg-public-data/cnvkit-reference-wf-no-normals/30", "applicationCategory": "Workflow", "version": "sbg:draft-2", "name": "CNVkit Tumor-only Reference", "description": "CNVkit analyzes copy number variants in exome, targeted, amplicon, hybrid and whole-genome DNA sequencing. \n\nThis toolkit takes advantage of both on\u2013 and off-target sequencing reads and applies a series of corrections to improve accuracy in copy number calling.[1]\n\n*A list of **all inputs and parameters** with corresponding descriptions can be found at the bottom of the page.*\n\n### Common Use Cases\n\n* Ideally, the control or \u201cnormal\u201d samples used to build the reference should match the type of sample (e.g. FFPE-extracted or fresh DNA) and library preparation protocol or kit used for the test (e.g. tumor) samples[1]. If this is not the case, **CNVkit Tumor-only Reference** creates a \u201cflat\u201d **Reference coverage file** of neutral copy number for each probe from the target and antitarget interval files. \n\n* In order to obtain annotated CNV (name of the genes that are located in the CNV regions), an annotation file for the **Annotation File** input must be provided (eg. hg19 annotation - [refFlat19](http://hgdownload.soe.ucsc.edu/goldenPath/hg19/database/refFlat.txt.gz)).\n\n### Changes Introduced by Seven Bridges\n\n* No modifications to the original tool representation have been made, apart from the automation of file naming.\n\n### Common Issues and Important Notes\n\n* The **Reference FASTA** has to be indexed. We recommend using the **SBG FASTA Indices** app to index the reference file if needed.\n\n### Performance Benchmarking\n\nThe instance set for this workflow is the AWS c4.2xlarge instance with 8vCPUs, 15 GiB of RAM and 50 GB of EBS (disk space). The running time is around 5 minutes with the cost of $0.03.\n\n*Cost can be significantly reduced by using **spot instances**. Visit the [Knowledge Center](https://docs.sevenbridges.com/docs/about-spot-instances) for more details.*   \n\n### API Python Implementation\nThe app's draft task can also be submitted via the **API**. In order to learn how to get your **Authentication token** and **API endpoint** for the corresponding platform visit our [documentation](https://github.com/sbg/sevenbridges-python#authentication-and-configuration).\n\n```python\n# Initialize the SBG Python API\nfrom sevenbridges import Api\napi = Api(token=\"enter_your_token\", url=\"enter_api_endpoint\")\n# Get project_id/app_id from your address bar. Example: https://igor.sbgenomics.com/u/your_username/project/app\nproject_id = \"your_username/project\"\napp_id = \"your_username/project/app\"\n# Replace inputs with appropriate values\ninputs = {\n    \"interval_file\": api.files.query(project=project_id, names=[\"enter_filename\"])[0],\n    \"reference_fasta\": api.files.query(project=project_id, names=[\"enter_filename\"])[0]}\n# Creates draft task\ntask = api.tasks.create(name=\"CNVkit Tumor-only Reference - API Run\", project=project_id, app=app_id, inputs=inputs, run=False)\n```\n\nInstructions for installing and configuring the API Python client are provided on [github](https://github.com/sbg/sevenbridges-python#installation). For more information about using the API Python client, consult [the client documentation](http://sevenbridges-python.readthedocs.io/en/latest/). **More examples** are available [here](https://github.com/sbg/okAPI).\n\nAdditionally, [API R](https://github.com/sbg/sevenbridges-r) and [API Java](https://github.com/sbg/sevenbridges-java) clients are available. To learn more about using these API clients, please refer to the [API R client documentation](https://sbg.github.io/sevenbridges-r/), and [API Java client documentation](https://docs.sevenbridges.com/docs/java-library-quickstart).\n\n###References\n\n[1] [CNVkit: Genome-Wide Copy Number Detection and Visualization from Targeted DNA Sequencing](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4839673/)", "input": [{"name": "Interval File"}, {"name": "Annotation File", "encodingFormat": "text/plain"}, {"name": "Reference Fasta", "encodingFormat": "application/x-fasta"}, {"name": "Minimum gap size"}, {"name": "Split"}, {"name": "Average size of split target bins"}, {"name": "Antitarget minimum size"}, {"name": "Average size of antitarget bins"}, {"name": "Male reference"}, {"name": "No GC"}, {"name": "No edge"}, {"name": "No RMask"}], "original_input": [{"type": ["File"], "label": "Interval File", "description": "A BED file of baited regions.", "sbg:fileTypes": "BED, INTERVALS, INTERVAL, LIST", "id": "#interval_file", "sbg:x": -150.35895405060276, "sbg:y": 1135.903863554959, "sbg:includeInPorts": true}, {"type": ["null", "File"], "label": "Annotation File", "description": "Gene annotation databases, e.g. RefSeq or Ensembl, available in \u201cflat\u201d format from UCSC.", "sbg:fileTypes": "TXT, TEXT", "id": "#annotation_file", "sbg:x": -148.85898480659765, "sbg:y": 1310.6219914482792, "sbg:includeInPorts": true}, {"type": ["File"], "label": "Reference Fasta", "description": "Reference Fasta", "sbg:fileTypes": "FASTA, FA", "id": "#reference_fasta", "secondaryFiles": [".fai"], "sbg:x": -149.10260646923692, "sbg:y": 951.0963183434981, "sbg:includeInPorts": true}, {"type": ["null", "int"], "label": "Minimum gap size", "description": "Minimum gap size between accessible sequence regions. Regions separated by less than this distance will be joined together.", "id": "#min_gap_size", "sbg:altPrefix": "-s", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "5000"}, {"type": ["null", "boolean"], "label": "Split", "description": "Split large tiled intervals into smaller, consecutive targets.", "id": "#split", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "False", "inputBinding": {"separate": true, "prefix": "--split", "position": 3, "sbg:cmdInclude": true}}, {"type": ["null", "float"], "label": "Average size of split target bins", "description": "Average size of split target bins (results are approximate). Split flag must be raised for this input to have effect.", "id": "#avg_size", "sbg:altPrefix": "-a", "sbg:category": "Optional arguments", "sbg:toolDefaultValue": "266.666666667", "inputBinding": {"separate": true, "prefix": "--avg-size", "position": 4, "sbg:cmdInclude": true}}, {"type": ["null", "float"], "label": "Antitarget minimum size", "description": "Minimum size of antitarget bins (smaller regions are dropped).", "id": "#min_size", "sbg:altPrefix": "-m", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "1/16 avg size, calculated", "inputBinding": {"separate": true, "prefix": "--min-size", "position": 3, "sbg:cmdInclude": true}}, {"type": ["null", "float"], "label": "Average size of antitarget bins", "description": "Average size of antitarget bins (results are approximate).", "id": "#avg_size_1", "sbg:altPrefix": "-a", "sbg:category": "Optional arguments", "sbg:stageInput": null, "sbg:toolDefaultValue": "100000"}, {"type": ["null", "boolean"], "label": "Male reference", "description": "Create a male reference: shift female samples' chrX log-coverage by -1, so the reference chrX average is -1. Otherwise, shift male samples' chrX by +1, so the reference chrX average is 0.", "id": "#male_reference", "sbg:stageInput": null, "inputBinding": {"sbg:cmdInclude": true, "prefix": "--male-reference", "separate": true, "position": 4}, "sbg:toolDefaultValue": "False", "sbg:category": "Optional arguments", "sbg:altPrefix": "-y"}, {"type": ["null", "boolean"], "label": "No GC", "description": "Skip GC correction.", "id": "#no_gc", "sbg:stageInput": null, "inputBinding": {"sbg:cmdInclude": true, "prefix": "--no-gc", "separate": true, "position": 5}, "sbg:toolDefaultValue": "False", "sbg:category": "Optional arguments"}, {"type": ["null", "boolean"], "label": "No edge", "description": "Skip edge-effect correction.", "id": "#no_edge", "sbg:stageInput": null, "inputBinding": {"sbg:cmdInclude": true, "prefix": "--no-edge", "separate": true, "position": 6}, "sbg:toolDefaultValue": "False", "sbg:category": "Optional arguments"}, {"type": ["null", "boolean"], "label": "No RMask", "description": "Skip RepeatMasker correction.", "id": "#no_rmask", "sbg:stageInput": null, "inputBinding": {"sbg:cmdInclude": true, "prefix": "--no-rmask", "separate": true, "position": 7}, "sbg:toolDefaultValue": "False", "sbg:category": "Optional arguments"}], "output": [{"name": "Antitarget BED"}, {"name": "Target BED"}, {"name": "Reference coverage file"}], "schema:softwareRequirements": ["sbg:Metadata"], "applicationSuite": "CNVkitversion:0.9.3", "codeRepository": ["https://github.com/etal/cnvkit"], "applicationSubCategory": ["Copy Number Analysis"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Copy of milos.nikolic/cnvkit-reference-wxs-wgs/cnvkit-reference-wf-no-normals/10"}, {"sbg:revision": 1, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 2, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated WF"}, {"sbg:revision": 3, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 4, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 5, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 6, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 7, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 8, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 9, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 10, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 11, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 12, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 13, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 14, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 15, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 16, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 17, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 18, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 19, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 20, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 21, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1535126719, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 22, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1536759650, "sbg:revisionNotes": "Updated description"}, {"sbg:revision": 23, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563372433, "sbg:revisionNotes": "Updated CNVkit-reference description."}, {"sbg:revision": 24, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563372433, "sbg:revisionNotes": "google instance hind added"}, {"sbg:revision": 25, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563372433, "sbg:revisionNotes": ""}, {"sbg:revision": 26, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563372433, "sbg:revisionNotes": ""}, {"sbg:revision": 27, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1563372433, "sbg:revisionNotes": "added google instance hint to the rev 23"}, {"sbg:revision": 28, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648048903, "sbg:revisionNotes": "updated categories"}, {"sbg:revision": 29, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648048903, "sbg:revisionNotes": "updated azure hints"}, {"sbg:revision": 30, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1649765577, "sbg:revisionNotes": "Uploaded using sbpack v2022.03.16. \nSource: Desktop/cnvkit_tumor_only_ref.cwl"}], "creator": "Eric Talevich", "dateModified": 1649765577, "dateCreated": 1535126719, "contributor": ["admin"], "sdPublisher": "sbg", "programmingLanguage": "CWL"}, {"_id": "SB_Public_Apps_admin/sbg-public-data/cnvnator-analysis/35", "includedInDataCatalog": {"name": "PublicApps@SevenBridges"}, "@type": "Dataset", "url": "https://igor.sbgenomics.com/public/apps/admin/sbg-public-data/cnvnator-analysis/35", "applicationCategory": "Workflow", "version": "sbg:draft-2", "name": "CNVnator Analysis", "description": "CNVnator Analysis workflow performs copy number variation (CNVs) calling by doing read-depth (RD) analysis of the input BAM files. \n###Methods\nCNVnator tool has **five** major steps: \n\n1. Reads extraction \n\n2. Histogram generation \n\n3. Statistics calculation\n\n4. RD signal partition \n4'. Calculating average RD signal per bin \n\n5. CNVs identification\n###Inputs\nIn order to execute the workflow properly, a user should set the following input files: \n\n1. Input BAM files (bam_files) - one or more BAM files \n\n2. Reference genome file (ref_genome) - FASTA file matching the provided BAM files\n###Parameter settings\nFor the correct execution of the workflow it is **necessary** for the following settings to be provided: Evaluate RD, Histogram, Identifying CNVs, RD signal partitioning and Calculate statistics. Recommended value for these settings (bin size) is 100.\n\nThe No GC correction (calculate results without GC correction) can be set, but is not mandatory.\n###Outputs\nOn the output **three** files are generated: \n\n1. average_rd_output_file - contains average RD signal per bin. These results are calculated after the RD signal partition step. \n\n2. vcf file - This is the result of the conversion of the cnv_result_file.\n\n3. cnv_result_file - This file contains the result of the CNV calling in **nine** columns, they are: \n\ncolumn 1: CNV_type \ncolumn 2: coordinates\ncolumn 3: CNV_size \ncolumn 4: normalized_RD - normalized to 1  \ncolumn 5: e-val1 - is calculated using t-test statistics.  \ncolumn 6: e-val2 - is from the probability of RD values within the region to be in the tails of a gaussian distribution describing frequencies of RD values in bins. \ncolumn 7: e-val3 - same as e-val1 but for the middle of CNV  \ncolumn 8: e-val4 - same as e-val2 but for the middle of CNV \ncolumn 9: q0 - fraction of reads mapped with q0 quality\n###Common issues\nThere aren't any known common issues.", "input": [{"name": "ref_genome", "encodingFormat": "application/x-fasta"}, {"name": "no_gc_correction"}, {"name": "#bam_files", "encodingFormat": "application/x-bam"}, {"name": "Calculate statistics"}, {"name": "Histogram"}, {"name": "RD signal partitioning"}, {"name": "Evaluate RD"}, {"name": "Identifying CNVs"}], "original_input": [{"type": ["null", "File"], "label": "ref_genome", "sbg:fileTypes": "FASTA", "id": "#ref_genome", "sbg:x": 18.222212261624062, "sbg:y": 558.4443461806708, "sbg:suggestedValue": {"class": "File", "path": "5772b6d8507c1752674486e6", "name": "human_g1k_v37_decoy.fasta"}}, {"type": ["null", "boolean"], "label": "no_gc_correction", "id": "#no_gc_correction", "sbg:includeInPorts": true, "sbg:y": 131.11108205936642, "sbg:x": 962.2221693698278}, {"type": ["null", {"type": "array", "items": "File"}], "label": "#bam_files", "sbg:fileTypes": "BAM", "id": "#bam_files", "sbg:includeInPorts": true, "sbg:x": 21.222215837902674, "sbg:y": 339.33327604811996}, {"type": ["null", "int"], "label": "Calculate statistics", "description": "Calculate statistics step. This step must be completed before proceeding to partitioning and CNV calling. The value sets the bin size.", "id": "#statistics", "sbg:includeInPorts": false, "required": false, "sbg:category": "Statistics calculation", "sbg:suggestedValue": 100}, {"type": ["null", "int"], "label": "Histogram", "description": "Generate a histogram. The value sets the bin size.", "id": "#histogram", "sbg:includeInPorts": false, "required": false, "sbg:category": "Histogram generation", "sbg:suggestedValue": 100}, {"type": ["null", "int"], "label": "RD signal partitioning", "description": "RD signal partitioning. The value sets the bin size.", "id": "#partitioning", "required": false, "sbg:category": "Partitioning", "sbg:suggestedValue": 100}, {"type": ["null", "int"], "label": "Evaluate RD", "description": "Returns average read depth(RD) per bin. The value sets the bin size.", "id": "#evaluation", "sbg:includeInPorts": false, "required": false, "sbg:category": "Evaluation", "sbg:suggestedValue": 100}, {"type": ["null", "int"], "label": "Identifying CNVs", "description": "Identifying CNVs (CNV calling).The value sets the bin size.", "id": "#calling", "sbg:category": "Calling", "sbg:suggestedValue": 100}], "output": [{"name": "cnv_results_file", "encodingFormat": "text/plain"}, {"name": "average_rd_output_file", "encodingFormat": "text/plain"}, {"name": "vcf", "encodingFormat": "text/plain"}], "applicationSuite": "CNVnatorversion:v0.3.2", "codeRepository": ["https://github.com/abyzovlab/CNVnator", "https://github.com/abyzovlab/CNVnator/releases", "https://github.com/abyzovlab/CNVnator/wiki", "https://github.com/abyzovlab/CNVnator/releases/download/v0.3.2/CNVnator_v0.3.2.zip"], "applicationSubCategory": ["Copy Number Analysis"], "softwareVersion": [{"sbg:revision": 0, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1454448265, "sbg:revisionNotes": null}, {"sbg:revision": 1, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1454448267, "sbg:revisionNotes": null}, {"sbg:revision": 2, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1454448269, "sbg:revisionNotes": null}, {"sbg:revision": 3, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1454448271, "sbg:revisionNotes": null}, {"sbg:revision": 4, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1454448275, "sbg:revisionNotes": null}, {"sbg:revision": 5, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1454448278, "sbg:revisionNotes": null}, {"sbg:revision": 6, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1454448280, "sbg:revisionNotes": null}, {"sbg:revision": 7, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1454448282, "sbg:revisionNotes": null}, {"sbg:revision": 8, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1454448284, "sbg:revisionNotes": null}, {"sbg:revision": 9, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1454448286, "sbg:revisionNotes": null}, {"sbg:revision": 10, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1454448288, "sbg:revisionNotes": null}, {"sbg:revision": 11, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1454448289, "sbg:revisionNotes": null}, {"sbg:revision": 12, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1454448291, "sbg:revisionNotes": null}, {"sbg:revision": 13, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1454448292, "sbg:revisionNotes": null}, {"sbg:revision": 14, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1454448294, "sbg:revisionNotes": null}, {"sbg:revision": 15, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1454448295, "sbg:revisionNotes": null}, {"sbg:revision": 16, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1455019457, "sbg:revisionNotes": null}, {"sbg:revision": 17, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1455019458, "sbg:revisionNotes": null}, {"sbg:revision": 18, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1455019460, "sbg:revisionNotes": null}, {"sbg:revision": 19, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1455019461, "sbg:revisionNotes": null}, {"sbg:revision": 20, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1456250921, "sbg:revisionNotes": null}, {"sbg:revision": 21, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1456338152, "sbg:revisionNotes": null}, {"sbg:revision": 22, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1457526725, "sbg:revisionNotes": null}, {"sbg:revision": 23, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1457526725, "sbg:revisionNotes": null}, {"sbg:revision": 24, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1457526725, "sbg:revisionNotes": null}, {"sbg:revision": 25, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1457526725, "sbg:revisionNotes": null}, {"sbg:revision": 26, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1457526725, "sbg:revisionNotes": null}, {"sbg:revision": 27, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1457526725, "sbg:revisionNotes": null}, {"sbg:revision": 28, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1457526725, "sbg:revisionNotes": null}, {"sbg:revision": 29, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1457526725, "sbg:revisionNotes": null}, {"sbg:revision": 30, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1459789092, "sbg:revisionNotes": null}, {"sbg:revision": 31, "sbg:modifiedBy": "sevenbridges", "sbg:modifiedOn": 1465231639, "sbg:revisionNotes": null}, {"sbg:revision": 32, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1473344154, "sbg:revisionNotes": "replaced SBG SplitFasta"}, {"sbg:revision": 33, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1520433333, "sbg:revisionNotes": "Default Values 100"}, {"sbg:revision": 34, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1561485690, "sbg:revisionNotes": "Updated SBG Split Fasta and SBG Decompressor"}, {"sbg:revision": 35, "sbg:modifiedBy": "admin", "sbg:modifiedOn": 1648048903, "sbg:revisionNotes": "updated categories"}], "creator": "Alexej Abyzov, Alexander E. Urban, Michael Snyder, and Mark Gerstein", "dateModified": 1648048903, "dateCreated": 1454448265, "contributor": ["sevenbridges", "admin"], "sdPublisher": "sbg", "programmingLanguage": "CWL"}]