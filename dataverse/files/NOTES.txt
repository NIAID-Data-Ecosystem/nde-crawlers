# Dataverse Datasource

## Notes  
What we know:
 - Based off their metrics, https://dataverse.org/metrics, we should expect **210k datasets**, and **13k dataverses**.  

 - Some data is inactive, will be skipped
    i.e. 
    https://dataverse.harvard.edu/dataverse/ddadenmark?q=&types=datasets&sort=dateSort&order=desc&page=1,
    http://nesstar.dda.dk/webview/?mode=documentation&submode=abstract&studydoc=http%3A%2F%2Fnesstar.dda.dk%2Fobj%2FfStudy%2FDDA1507D&top=yes, 
    https://hdl.handle.net/1902.5/DDA1507D

- Some data urls are outdated....
    i.e.
    https://www.icpsr.umich.edu/web/HMCA/studies/35623/versions/V2
     - https://www.icpsr.umich.edu/web/HMCA/studies/35623/ 
        - check if we get already, skip urls, if not get the canonical url
    - if version is outdated we skip, correct url will be found.

- Some data export into schema.org format is failing, will pass original metadata record and provide a unique parse
    Example of successful export: https://dataverse.harvard.edu/api/datasets/export?exporter=schema.org&persistentId=doi:10.7910/DVN/W7UJMD
    Failed export: 
    nde-logger failed to get https://dataverse.harvard.edu/api/datasets/export?exporter=schema.org&persistentId=doi:10.5064/F6ZP448B, 403, ERROR, Export Failed
    Although we can't export, we still retrieve metadata, therefore we can still pass the metadata and modify it in the parser.
    (it will be different than the modifications being done on the exported schema.org data)
    -- metadata example (fails schema.org export):
        {
            "name": "Using participatory approaches to assess the acceptability of surveillance systems: The case of bovine tuberculosis in Belgium",
            "type": "dataset",
            "url": "https://doi.org/10.5064/F6W66HPK",
            "global_id": "doi:10.5064/F6W66HPK",
            "description": "Project Summary: Bovine tuberculosis (bTB) surveillance in Belgium is essential to maintain the officially free status and to preserve animal and public health. An evaluation of the system is thus needed to ascertain the surveillance provides a precise description of the current situation in the country. The evaluation should assess stakeholders\u2019 perceptions and expectations about the system due to the fact that the acceptability has an influence on the levels of sensitivity and timelines s of the surveillance system. The objective of the study was to assess the acceptability of the bTB surveillance in Belgium, using participatory tools and the OASIS flash tool (\u2018analysis tool for surveillance systems\u2019). For the participatory process, focus group discussions and individual interviews were implemented with representatives involved with the system, both from cattle and wildlife part of the surveillance. Data Abstract: The shared data are anonymized transcripts of participatory interviews implemented in Belgium in the frame of the evaluation of the bovine tuberculosis surveillance system. Participants to the interviews were selected according to their role in the Belgium bovine tuberculosis surveillance system (e.g. private veterinarian, farmer) and to their willingness to take part to such a study.",
            "published_at": "2018-04-22T02:16:47Z",
            "publisher": "QDR Harvested Dataverse",
            "citationHtml": "Calba, Cl&eacute;mentine, 2018, \"Using participatory approaches to assess the acceptability of surveillance systems: The case of bovine tuberculosis in Belgium\", <a href=\"https://doi.org/10.5064/F6W66HPK\" target=\"_blank\">https://doi.org/10.5064/F6W66HPK</a>, QDR Main Collection",
            "identifier_of_dataverse": "qdr",
            "name_of_dataverse": "QDR Harvested Dataverse",
            "citation": "Calba, Cl\u00e9mentine, 2018, \"Using participatory approaches to assess the acceptability of surveillance systems: The case of bovine tuberculosis in Belgium\", https://doi.org/10.5064/F6W66HPK, QDR Main Collection",
            "storageIdentifier": "s3://10.5064/F6W66HPK",
            "keywords": [
                "acceptability",
                "bovine tuberculosis",
                "evaluation",
                "participatory epidemiology",
                "surveillance"
            ],
            "subjects": [
                "Medicine, Health and Life Sciences",
                "Social Sciences"
            ],
            "fileCount": 19,
            "versionId": 136494,
            "versionState": "RELEASED",
            "createdAt": "2018-04-22T02:16:47Z",
            "updatedAt": "2018-04-22T02:16:47Z",
            "contacts": [
                {
                    "name": "",
                    "affiliation": ""
                }
            ],
            "authors": [
                "Calba, Cl\u00e9mentine"
            ]
        }

Final Data Translations:

Case 1: If data was "straight-forward", or easily exported into schema.org (exporter=schema.org),  
    i.e. 
        {
            "@context": "http://schema.org",
            "@type": "Dataset",
            "name": "Replication Data for: LegGov - Global Legitimacy Crises",
            "author": [
                {
                    "name": "Sommerer, Thomas",
                    "affiliation": {
                        "name": "(University of Potsdam)"
                    }
                }
            ],
            "datePublished": "2022-07-15",
            "dateModified": "2022-07-15",
            "license": "http://creativecommons.org/publicdomain/zero/1.0",
            "includedInDataCatalog": [
                {
                    "@type": "DataCatalog",
                    "name": "Harvard Dataverse",
                    "url": "https://dataverse.harvard.edu"
                }
            ],
            "distribution": [
                {
                    "@type": "DataDownload",
                    "name": " A1-A82 regression tables Sommerer et al. 2022.pdf",
                    "description": "Chapter 6: The Consequences of IO Legitimacy Crises: A Multivariate Approach",
                    "contentUrl": "https://dataverse.harvard.edu/api/access/datafile/6378779",
                    "encodingFormat": "application/pdf"
                },
                {
                    "@type": "DataDownload",
                    "name": " CH3_Consequences_of_IOlegitimacy_crises.tab",
                    "description": "Chapter 3: Patterns of Legitimacy Crises in 32 International Organizations",
                    "contentUrl": "https://dataverse.harvard.edu/api/access/datafile/6378776",
                    "encodingFormat": "text/tab-separated-values"
                },
                {
                    "@type": "DataDownload",
                    "name": " CH6_Consequences_of_IOlegitimacy_crises.tab",
                    "description": "Chapter 6: The Consequences of IO Legitimacy Crises: A Multivariate Approach",
                    "contentUrl": "https://dataverse.harvard.edu/api/access/datafile/6378778",
                    "encodingFormat": "text/tab-separated-values"
                },
                {
                    "@type": "DataDownload",
                    "name": "CH3_Code for Figure3_2-3_8.do",
                    "description": "Chapter 3: Patterns of Legitimacy Crises in 32 International Organizations",
                    "contentUrl": "https://dataverse.harvard.edu/api/access/datafile/6378777",
                    "encodingFormat": "application/x-stata-syntax"
                },
                {
                    "@type": "DataDownload",
                    "name": "CH3_Code for Figure3_9-3_13.do",
                    "description": "Chapter 3: Patterns of Legitimacy Crises in 32 International Organizations",
                    "contentUrl": "https://dataverse.harvard.edu/api/access/datafile/6378773",
                    "encodingFormat": "application/x-stata-syntax"
                },
                {
                    "@type": "DataDownload",
                    "name": "CH6_REPLICATION_DECISION.do",
                    "description": "Chapter 6: The Consequences of IO Legitimacy Crises: A Multivariate Approach",
                    "contentUrl": "https://dataverse.harvard.edu/api/access/datafile/6378771",
                    "encodingFormat": "application/x-stata-syntax"
                },
                {
                    "@type": "DataDownload",
                    "name": "CH6_REPLICATION_FIGURES.do",
                    "description": "Chapter 6: The Consequences of IO Legitimacy Crises: A Multivariate Approach",
                    "contentUrl": "https://dataverse.harvard.edu/api/access/datafile/6378774",
                    "encodingFormat": "application/x-stata-syntax"
                },
                {
                    "@type": "DataDownload",
                    "name": "CH6_REPLICATION_INSTITUTIONAL.do",
                    "description": "Chapter 6: The Consequences of IO Legitimacy Crises: A Multivariate Approach",
                    "contentUrl": "https://dataverse.harvard.edu/api/access/datafile/6378772",
                    "encodingFormat": "application/x-stata-syntax"
                },
                {
                    "@type": "DataDownload",
                    "name": "CH6_REPLICATION_RESOURCES.do",
                    "description": "Chapter 6: The Consequences of IO Legitimacy Crises: A Multivariate Approach",
                    "contentUrl": "https://dataverse.harvard.edu/api/access/datafile/6378775",
                    "encodingFormat": "application/x-stata-syntax"
                }
            ],
            "url": "https://doi.org/10.7910/DVN/BZSF72",
            "doi": "https://doi.org/10.7910/DVN/BZSF72",
            "_id": "Dataverse_10.7910_DVN_BZSF72",
            "sdPublisher": [
                {
                    "@type": "Organization",
                    "name": "Harvard Dataverse"
                }
            ],
            "description": "Online supplementary material and replication data for Sommerer et al. (2022), \"Global Legitimacy Crises - Decline and Revival in Multilateral Governance\"",
            "keywords": "Social Sciences",
            "pmids": "global-legitimacy-crises-9780192856326?facet_narrowbypubdate_facet=Next%203%20months&lang=en&cc=ma"
        }

Case 2: Else metadata export unavailable, transate raw metadata  
    i.e 
        {
            "name": "Research on Pathways to Desistance [Maricopa County, AZ and Philadelphia County, PA]: Calendar Data, 2000-2010 [Restricted]",
            "url": "https://doi.org/10.3886/ICPSR32282.v2",
            "description": "The Calendar data files are comprised of 47 total parts spread across 13 distinct topical domains. Academic Achievement Antisocial Activity Community-Based Services Contact With the Justice System Court Monitoring Gainful Activity Head Injury Living Situation Making and Spending Money Medication Out of Community Placement Romance School Each topical domain contains multiple reference periods for looking at the topic across the entire data collection period of the study. Users who request these restricted data should first review the documentation available from NAHDAP (user guide and frequency codeb ooks) and from the Pathways Website (domain content codebooks) http://www.pathwaysstudy.pitt.edu/codebook/calendars.html . This review will help determine which specific datasets will be needed for your project. The \"Research Description\" in ICPSR's Data Access Request System (IDARS) must include a specific explanation of why you need each topic domain selected on the \"Data Selection\" page in IDARS. Most projects should only require one reference period per topic domain being requested. Data requests for all reference periods within a given domain will not be approved without a satisfactory explanation of why all of the reference periods are required for your project. Since the Calendar data collection is very extensive and Restricted Data Use Agreements are only for 2 years, data requests are not expected to need the entire Calendar data collection. The Pathways to Desistance study was a multi-site study that followed 1,354 serious juvenile offenders from adolescence to young adulthood in two locales between the years 2000 and 2010. Enrolled into the study were adjudicated youths from the juvenile and adult court systems in Maricopa County (Phoenix), Arizona (N=654) and Philadelphia County, Pennsylvania (N=700). Respondents were enrolled and baseline interviews conducted from November 2000 to January 2003. Follow-up interviews were then scheduled with the respondents at 6, 12, 18, 24, 30, 36, 48, 60, 72 and 84 months past their baseline interview. The enrolled youth were at least 14 years old and under 18 years old at the time of their committing offense and were found guilty of a serious offense (predominantly felonies, with a few exceptions for some misdemeanor property offenses, sexual assault, or weapons offenses).",
            "publisher": "ICPSR Harvested Dataverse",
            "citation": "Mulvey, Edward P., 2014, \"Research on Pathways to Desistance [Maricopa County, AZ and Philadelphia County, PA]: Calendar Data, 2000-2010 [Restricted]\", https://doi.org/10.3886/ICPSR32282.v2, Inter-university Consortium for Political and Social Research",
            "keywords": [
                "academic achievement",
                "community involvement",
                "crime",
                "demographic characteristics",
                "employment",
                "family life",
                "friendships",
                "household composition",
                "income",
                "injuries",
                "interpersonal relations",
                "juvenile crime",
                "juvenile offenders",
                "medications",
                "personal adjustment",
                "psychological evaluation",
                "psychosocial assessment",
                "religion",
                "service providers",
                "social behavior",
                "substance abuse",
                ""
            ],
            "updatedAt": "2015-04-09T03:21:39Z",
            "contacts": [
                {
                    "name": "",
                    "affiliation": ""
                }
            ],
            "publications": [
                {}
            ],
            "geographicCoverage": [
                {
                    "country": "",
                    "other": "Please see geographic coverage.,"
                },
                {
                    "country": "",
                    "other": "Arizona,"
                },
                {
                    "country": "",
                    "other": "Pennsylvania,"
                },
                {
                    "country": "",
                    "other": "Philadelphia,"
                },
                {
                    "country": "",
                    "other": "Phoenix,"
                },
                {
                    "country": "",
                    "other": "United States,"
                }
            ],
            "@type": "dataset",
            "identifier": "doi:10.3886/ICPSR32282.v2",
            "datePublished": "2015-04-09T03:21:39Z",
            "dateCreated": "2015-04-09T03:21:39Z",
            "author": {
                "name": [
                    "Mulvey, Edward P."
                ]
            }
        }